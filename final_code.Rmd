---
title: "Code for writeup"
author: "Sophie_Berube"
date: "10/10/2017"
output: pdf_document
---

```{r}
####################### Loading necessary Packages##############
############# The following code chunk (stopping before Section 1) is 
########## copied from the Slack Channel courtesy of B.Ackerman#######

packages = c("devtools","knitr","dplyr","ggplot2","rplos")

check.packages = function(package){
  if(!package %in% library()$results[,1]){install.packages(package,dependencies=TRUE)}
  else{("already installed")}
}

# Install packages that are not already installed
sapply(packages,check.packages)

# Load all necessary packages
lapply(packages,library,character.only=TRUE)



##### Section 1############
##### Plots over time of pairwise comparisons between key terms###############

#pairwise comparisons ANOVA

ANOVA_Bayesian<- plot_throughtime(terms=c("ANOVA","bayesian"),limit=10000) + geom_line(size=1,color="black")+geom_smooth(method="loess")

ANOVA_Bayesian

ANOVA_LR<- plot_throughtime(terms=c("ANOVA","linear regression"),limit=10000) + geom_line(size=1,color="black")+geom_smooth(method="loess")

ANOVA_LR

ANOVA_MM<- plot_throughtime(terms=c("ANOVA","mixed effect model"),limit=10000) + geom_line(size=1,color="black")+geom_smooth(method="loess")

ANOVA_MM

ANOVA_GEE<- plot_throughtime(terms=c("ANOVA","generalized estimating equation"),limit=10000) + geom_line(size=1,color="black")+geom_smooth(method="loess")
ANOVA_GEE

ANOVA_ML<-  plot_throughtime(terms=c("ANOVA","machine learning"),limit=10000) + geom_line(size=1,color="black")+geom_smooth(method="loess")

ANOVA_ML

ANOVA_SVM<-  plot_throughtime(terms=c("ANOVA","support vector machine"),limit=10000) + geom_line(size=1,color="black")+geom_smooth(method="loess")

ANOVA_SVM

ANOVA_NN<-  plot_throughtime(terms=c("ANOVA","deep learning"),limit=10000) + geom_line(size=1,color="black")+geom_smooth(method="loess")

ANOVA_NN

ANOVA_Btstp<-  plot_throughtime(terms=c("ANOVA","bootstrap"),limit=10000) + geom_line(size=1,color="black")+geom_smooth(method="loess")

ANOVA_Btstp

ANOVA_NN<-  plot_throughtime(terms=c("ANOVA","artificial neural network"),limit=10000) + geom_line(size=1,color="black")+geom_smooth(method="loess")

ANOVA_NN



#pairwise comparisons bayesian

Bayesian_LR<- plot_throughtime(terms=c("linear regression","bayesian"),limit=10000) + geom_line(size=1,color="black")+geom_smooth(method="loess")

Bayesian_LR

Bayesian_MM<- plot_throughtime(terms=c("bayesian","mixed effect model"),limit=10000) + geom_line(size=1,color="black")+geom_smooth(method="loess")

Bayesian_MM

Bayesian_GEE<- plot_throughtime(terms=c("bayesian","generalized estimating equation"),limit=10000) + geom_line(size=1,color="black")+geom_smooth(method="loess")
Bayesian_GEE

Bayesian_ML<-  plot_throughtime(terms=c("bayesian","machine learning"),limit=10000) + geom_line(size=1,color="black")+geom_smooth(method="loess")+geom_smooth(method="loess")

Bayesian_ML

Bayesian_SVM<-  plot_throughtime(terms=c("bayesian","support vector machine"),limit=10000) + geom_line(size=1,color="black")+geom_smooth(method="loess")

Bayesian_SVM

Bayesian_NN<-  plot_throughtime(terms=c("bayesian","deep learning"),limit=10000) + geom_line(size=1,color="black")+geom_smooth(method="loess")

Bayesian_NN

Bayesian_Btstp<-  plot_throughtime(terms=c("bayesian","bootstrap"),limit=10000) + geom_line(size=1,color="black")+geom_smooth(method="loess")

Bayesian_Btstp

Bayesian_NN<-  plot_throughtime(terms=c("bayesian","artificial neural network"),limit=10000) + geom_line(size=1,color="black")+geom_smooth(method="loess")

Bayesian_NN


#pairwise comparisons linear regression


LR_MM<- plot_throughtime(terms=c("linear regression","mixed effect model"),limit=10000) + geom_line(size=1,color="black")+geom_smooth(method="loess")

LR_MM

LR_GEE<- plot_throughtime(terms=c("linear regression","generalized estimating equation"),limit=10000) + geom_line(size=1,color="black")+geom_smooth(method="loess")
LR_GEE

LR_ML<-  plot_throughtime(terms=c("linear regression","machine learning"),limit=10000) + geom_line(size=1,color="black")+geom_smooth(method="loess")

LR_ML

LR_SVM<-  plot_throughtime(terms=c("linear regression","support vector machine"),limit=10000) + geom_line(size=1,color="black")+geom_smooth(method="loess")

LR_SVM

LR_NN<-  plot_throughtime(terms=c("linear regression","deep learning"),limit=10000) + geom_line(size=1,color="black")+geom_smooth(method="loess")

LR_NN

LR_Btstp<-  plot_throughtime(terms=c("linear regression","bootstrap"),limit=10000) + geom_line(size=1,color="black")+geom_smooth(method="loess")

LR_Btstp

LR_NN<-  plot_throughtime(terms=c("linear regression","artificial neural network"),limit=10000) + geom_line(size=1,color="black")+geom_smooth(method="loess")

LR_NN



#pairwise comparisons mixed models



MM_GEE<- plot_throughtime(terms=c("mixed effect model","generalized estimating equation"),limit=10000) + geom_line(size=1,color="black")+geom_smooth(method="loess")
MM_GEE

MM_ML<-  plot_throughtime(terms=c("mixed effect model","machine learning"),limit=10000) + geom_line(size=1,color="black")+geom_smooth(method="loess")
MM_ML

MM_SVM<-  plot_throughtime(terms=c("mixed effect model","support vector machine"),limit=10000) + geom_line(size=1,color="black")+geom_smooth(method="loess")

MM_SVM

MM_NN<-  plot_throughtime(terms=c("mixed effect model","deep learning"),limit=10000) + geom_line(size=1,color="black")+geom_smooth(method="loess")

MM_NN

MM_Btstp<-  plot_throughtime(terms=c("mixed effect model","bootstrap"),limit=10000) + geom_line(size=1,color="black")+geom_smooth(method="loess")

MM_Btstp

MM_NN<-  plot_throughtime(terms=c("mixed effect model","artificial neural network"),limit=10000) + geom_line(size=1,color="black")+geom_smooth(method="loess")

MM_NN



#pairwise comparisons gee

GEE_ML<-  plot_throughtime(terms=c("generalized estimating equation","machine learning"),limit=10000) + geom_line(size=1,color="black")+geom_smooth(method="loess")
GEE_ML

GEE_SVM<-  plot_throughtime(terms=c("generalized estimating equation","support vector machine"),limit=10000) + geom_line(size=1,color="black")+geom_smooth(method="loess")

GEE_SVM

GEE_NN<-  plot_throughtime(terms=c("generalized estimating equation","deep learning"),limit=10000) + geom_line(size=1,color="black")+geom_smooth(method="loess")

GEE_NN

GEE_Btstp<-  plot_throughtime(terms=c("generalized estimating equation","bootstrap"),limit=10000) + geom_line(size=1,color="black")+geom_smooth(method="loess")

GEE_Btstp

GEE_NN<-  plot_throughtime(terms=c("generalized estimating equation","artificial neural network"),limit=10000) + geom_line(size=1,color="black")+geom_smooth(method="loess")

GEE_NN




#pairwise comparisons machine learning

ML_SVM<-  plot_throughtime(terms=c("machine learning","support vector machine"),limit=10000) + geom_line(size=1,color="black")+geom_smooth(method="loess")

ML_SVM

ML_NN<-  plot_throughtime(terms=c("machine learning","deep learning"),limit=10000) + geom_line(size=1,color="black")+geom_smooth(method="loess")

ML_NN

ML_Btstp<-  plot_throughtime(terms=c("machine learning","bootstrap"),limit=10000) + geom_line(size=1,color="black")+geom_smooth(method="loess")+geom_smooth(method="loess")

ML_Btstp

ML_NN<-  plot_throughtime(terms=c("machine learning","artificial neural network"),limit=10000) + geom_line(size=1,color="black")+geom_smooth(method="loess")

ML_NN



#pairwise comparisons support vector machine


SVM_NN<-  plot_throughtime(terms=c("support vector machine","deep learning"),limit=10000) + geom_line(size=1,color="black")+geom_smooth(method="loess")

SVM_NN

SVM_Btstp<-  plot_throughtime(terms=c("support vector machine","bootstrap"),limit=10000) + geom_line(size=1,color="black")+geom_smooth(method="loess")

SVM_Btstp

SVM_NN<-  plot_throughtime(terms=c("support vector machine","artificial neural network"),limit=10000) + geom_line(size=1,color="black")+geom_smooth(method="loess")

SVM_NN


#pairwise comparisons deep learning



NN_Btstp<-  plot_throughtime(terms=c("deep learning","bootstrap"),limit=10000) + geom_line(size=1,color="black")+geom_smooth(method="loess")

NN_Btstp

NN_NN<-  plot_throughtime(terms=c("deep learning","artificial neural network"),limit=10000) + geom_line(size=1,color="black")+geom_smooth(method="loess")

NN_NN


#pairwise comparisons bootstrap


Btstp_NN<-  plot_throughtime(terms=c("bootstrap","artificial neural network"),limit=10000) + geom_line(size=1,color="black")+geom_smooth(method="loess")

Btstp_NN


```



```{r}
################# Section 2###################

################# Assembly of counts and fitting of poisson models##############

### ANOVA
ANOVA_search<-searchplos(q="ANOVA",fl=c("subject","publication_date"),limit=10000)
ANOVA_search_clean<- matrix(unlist(ANOVA_search[[2]]),ncol=2)


###ANOVA 2004
ANOVA_2004<- ANOVA_search_clean[grep("^2004",ANOVA_search_clean[,2]),]

ANOVA_2004_Bio<- ANOVA_2004[grep("^/Biology and life sciences",ANOVA_2004[,1]),2]

ANOVA_2004_Bio_count<- length(ANOVA_2004_Bio)

ANOVA_2004_Phys<- ANOVA_2004[grep("^/Physical sciences",ANOVA_2004[,1]),2]

ANOVA_2004_Phys_count<- length(ANOVA_2004_Phys) 

ANOVA_2004_Med<- ANOVA_2004[grep("^/Medicine and health sciences",ANOVA_2004[,1]),2]

ANOVA_2004_Med_count<- length(ANOVA_2004_Med) 

ANOVA_2004_Res<- ANOVA_2004[grep("^/Research and analysis methods",ANOVA_2004[,1]),2]

ANOVA_2004_Res_count<- length(ANOVA_2004_Res) 

ANOVA_2004_Earth<- ANOVA_2004[grep("^/Earth sciences",ANOVA_2004[,1]),2]

ANOVA_2004_Earth_count<- length(ANOVA_2004_Earth) 

ANOVA_2004_Comp<- ANOVA_2004[grep("^/Computer and information sciences",ANOVA_2004[,1]),2]

ANOVA_2004_Comp_count<- length(ANOVA_2004_Comp) 

ANOVA_2004_Eng<- ANOVA_2004[grep("^/Engineering and technology",ANOVA_2004[,1]),2]

ANOVA_2004_Eng_count<- length(ANOVA_2004_Eng) 

ANOVA_2004_Soc<- ANOVA_2004[grep("^/Social sciences",ANOVA_2004[,1]),2]

ANOVA_2004_Soc_count<- length(ANOVA_2004_Soc) 


########ANOVA 2005

ANOVA_2005<- ANOVA_search_clean[grep("^2005",ANOVA_search_clean[,2]),]

ANOVA_2005_Bio<- ANOVA_2005[grep("^/Biology and life sciences",ANOVA_2005[,1]),2]

ANOVA_2005_Bio_count<- length(ANOVA_2005_Bio)

ANOVA_2005_Phys<- ANOVA_2005[grep("^/Physical sciences",ANOVA_2005[,1]),2]

ANOVA_2005_Phys_count<- length(ANOVA_2005_Phys) 

ANOVA_2005_Med<- ANOVA_2005[grep("^/Medicine and health sciences",ANOVA_2005[,1]),2]

ANOVA_2005_Med_count<- length(ANOVA_2005_Med) 

ANOVA_2005_Res<- ANOVA_2005[grep("^/Research and analysis methods",ANOVA_2005[,1]),2]

ANOVA_2005_Res_count<- length(ANOVA_2005_Res) 

ANOVA_2005_Earth<- ANOVA_2005[grep("^/Earth sciences",ANOVA_2005[,1]),2]

ANOVA_2005_Earth_count<- length(ANOVA_2005_Earth) 

ANOVA_2005_Comp<- ANOVA_2005[grep("^/Computer and information sciences",ANOVA_2005[,1]),2]

ANOVA_2005_Comp_count<- length(ANOVA_2005_Comp) 

ANOVA_2005_Eng<- ANOVA_2005[grep("^/Engineering and technology",ANOVA_2005[,1]),2]

ANOVA_2005_Eng_count<- length(ANOVA_2005_Eng) 

ANOVA_2005_Soc<- ANOVA_2005[grep("^/Social sciences",ANOVA_2005[,1]),2]

ANOVA_2005_Soc_count<- length(ANOVA_2005_Soc) 


###### ANOVA 2006


ANOVA_2006<- ANOVA_search_clean[grep("^2006",ANOVA_search_clean[,2]),]

ANOVA_2006_Bio<- ANOVA_2006[grep("^/Biology and life sciences",ANOVA_2006[,1]),2]

ANOVA_2006_Bio_count<- length(ANOVA_2006_Bio)

ANOVA_2006_Phys<- ANOVA_2006[grep("^/Physical sciences",ANOVA_2006[,1]),2]

ANOVA_2006_Phys_count<- length(ANOVA_2006_Phys) 

ANOVA_2006_Med<- ANOVA_2006[grep("^/Medicine and health sciences",ANOVA_2006[,1]),2]

ANOVA_2006_Med_count<- length(ANOVA_2006_Med) 

ANOVA_2006_Res<- ANOVA_2006[grep("^/Research and analysis methods",ANOVA_2006[,1]),2]

ANOVA_2006_Res_count<- length(ANOVA_2006_Res) 

ANOVA_2006_Earth<- ANOVA_2006[grep("^/Earth sciences",ANOVA_2006[,1]),2]

ANOVA_2006_Earth_count<- length(ANOVA_2006_Earth) 

ANOVA_2006_Comp<- ANOVA_2006[grep("^/Computer and information sciences",ANOVA_2006[,1]),2]

ANOVA_2006_Comp_count<- length(ANOVA_2006_Comp) 

ANOVA_2006_Eng<- ANOVA_2006[grep("^/Engineering and technology",ANOVA_2006[,1]),2]

ANOVA_2006_Eng_count<- length(ANOVA_2006_Eng) 

ANOVA_2006_Soc<- ANOVA_2006[grep("^/Social sciences",ANOVA_2006[,1]),2]

ANOVA_2006_Soc_count<- length(ANOVA_2006_Soc) 

## ANOVA 2007


ANOVA_2007<- ANOVA_search_clean[grep("^2007",ANOVA_search_clean[,2]),]



ANOVA_2007_Bio<- ANOVA_2007[grep("^/Biology and life sciences",ANOVA_2007[,1]),2]

ANOVA_2007_Bio_count<- length(ANOVA_2007_Bio)

ANOVA_2007_Phys<- ANOVA_2007[grep("^/Physical sciences",ANOVA_2007[,1]),2]

ANOVA_2007_Phys_count<- length(ANOVA_2007_Phys) 

ANOVA_2007_Med<- ANOVA_2007[grep("^/Medicine and health sciences",ANOVA_2007[,1]),2]

ANOVA_2007_Med_count<- length(ANOVA_2007_Med) 

ANOVA_2007_Res<- ANOVA_2007[grep("^/Research and analysis methods",ANOVA_2007[,1]),2]

ANOVA_2007_Res_count<- length(ANOVA_2007_Res) 

ANOVA_2007_Earth<- ANOVA_2007[grep("^/Earth sciences",ANOVA_2007[,1]),2]

ANOVA_2007_Earth_count<- length(ANOVA_2007_Earth) 

ANOVA_2007_Comp<- ANOVA_2007[grep("^/Computer and information sciences",ANOVA_2007[,1]),2]

ANOVA_2007_Comp_count<- length(ANOVA_2007_Comp) 

ANOVA_2007_Eng<- ANOVA_2007[grep("^/Engineering and technology",ANOVA_2007[,1]),2]

ANOVA_2007_Eng_count<- length(ANOVA_2007_Eng) 

ANOVA_2007_Soc<- ANOVA_2007[grep("^/Social sciences",ANOVA_2007[,1]),2]

ANOVA_2007_Soc_count<- length(ANOVA_2007_Soc) 

#### ANOVA 2008
ANOVA_2008<- ANOVA_search_clean[grep("^2008",ANOVA_search_clean[,2]),]



ANOVA_2008_Bio<- ANOVA_2008[grep("^/Biology and life sciences",ANOVA_2008[,1]),2]

ANOVA_2008_Bio_count<- length(ANOVA_2008_Bio)

ANOVA_2008_Phys<- ANOVA_2008[grep("^/Physical sciences",ANOVA_2008[,1]),2]

ANOVA_2008_Phys_count<- length(ANOVA_2008_Phys) 

ANOVA_2008_Med<- ANOVA_2008[grep("^/Medicine and health sciences",ANOVA_2008[,1]),2]

ANOVA_2008_Med_count<- length(ANOVA_2008_Med) 

ANOVA_2008_Res<- ANOVA_2008[grep("^/Research and analysis methods",ANOVA_2008[,1]),2]

ANOVA_2008_Res_count<- length(ANOVA_2008_Res) 

ANOVA_2008_Earth<- ANOVA_2008[grep("^/Earth sciences",ANOVA_2008[,1]),2]

ANOVA_2008_Earth_count<- length(ANOVA_2008_Earth) 

ANOVA_2008_Comp<- ANOVA_2008[grep("^/Computer and information sciences",ANOVA_2008[,1]),2]

ANOVA_2008_Comp_count<- length(ANOVA_2008_Comp) 

ANOVA_2008_Eng<- ANOVA_2008[grep("^/Engineering and technology",ANOVA_2008[,1]),2]

ANOVA_2008_Eng_count<- length(ANOVA_2008_Eng) 

ANOVA_2008_Soc<- ANOVA_2008[grep("^/Social sciences",ANOVA_2008[,1]),2]

ANOVA_2008_Soc_count<- length(ANOVA_2008_Soc) 

##2009

ANOVA_2009<- ANOVA_search_clean[grep("^2009",ANOVA_search_clean[,2]),]




ANOVA_2009_Bio<- ANOVA_2009[grep("^/Biology and life sciences",ANOVA_2009[,1]),2]

ANOVA_2009_Bio_count<- length(ANOVA_2009_Bio)

ANOVA_2009_Phys<- ANOVA_2009[grep("^/Physical sciences",ANOVA_2009[,1]),2]

ANOVA_2009_Phys_count<- length(ANOVA_2009_Phys) 

ANOVA_2009_Med<- ANOVA_2009[grep("^/Medicine and health sciences",ANOVA_2009[,1]),2]

ANOVA_2009_Med_count<- length(ANOVA_2009_Med) 

ANOVA_2009_Res<- ANOVA_2009[grep("^/Research and analysis methods",ANOVA_2009[,1]),2]

ANOVA_2009_Res_count<- length(ANOVA_2009_Res) 

ANOVA_2009_Earth<- ANOVA_2009[grep("^/Earth sciences",ANOVA_2009[,1]),2]

ANOVA_2009_Earth_count<- length(ANOVA_2009_Earth) 

ANOVA_2009_Comp<- ANOVA_2009[grep("^/Computer and information sciences",ANOVA_2009[,1]),2]

ANOVA_2009_Comp_count<- length(ANOVA_2009_Comp) 

ANOVA_2009_Eng<- ANOVA_2009[grep("^/Engineering and technology",ANOVA_2009[,1]),2]

ANOVA_2009_Eng_count<- length(ANOVA_2009_Eng) 

ANOVA_2009_Soc<- ANOVA_2009[grep("^/Social sciences",ANOVA_2009[,1]),2]

ANOVA_2009_Soc_count<- length(ANOVA_2009_Soc)

### ANOVA 2010

ANOVA_2010<- ANOVA_search_clean[grep("^2010",ANOVA_search_clean[,2]),]

ANOVA_2010_Bio<- ANOVA_2010[grep("^/Biology and life sciences",ANOVA_2010[,1]),2]

ANOVA_2010_Bio_count<- length(ANOVA_2010_Bio)

ANOVA_2010_Phys<- ANOVA_2010[grep("^/Physical sciences",ANOVA_2010[,1]),2]

ANOVA_2010_Phys_count<- length(ANOVA_2010_Phys) 

ANOVA_2010_Med<- ANOVA_2010[grep("^/Medicine and health sciences",ANOVA_2010[,1]),2]

ANOVA_2010_Med_count<- length(ANOVA_2010_Med) 

ANOVA_2010_Res<- ANOVA_2010[grep("^/Research and analysis methods",ANOVA_2010[,1]),2]

ANOVA_2010_Res_count<- length(ANOVA_2010_Res) 

ANOVA_2010_Earth<- ANOVA_2010[grep("^/Earth sciences",ANOVA_2010[,1]),2]

ANOVA_2010_Earth_count<- length(ANOVA_2010_Earth) 

ANOVA_2010_Comp<- ANOVA_2010[grep("^/Computer and information sciences",ANOVA_2010[,1]),2]

ANOVA_2010_Comp_count<- length(ANOVA_2010_Comp) 

ANOVA_2010_Eng<- ANOVA_2010[grep("^/Engineering and technology",ANOVA_2010[,1]),2]

ANOVA_2010_Eng_count<- length(ANOVA_2010_Eng) 

ANOVA_2010_Soc<- ANOVA_2010[grep("^/Social sciences",ANOVA_2010[,1]),2]

ANOVA_2010_Soc_count<- length(ANOVA_2010_Soc)

###2011 ANOVA

ANOVA_2011<- ANOVA_search_clean[grep("^2011",ANOVA_search_clean[,2]),]


ANOVA_2011_Bio<- ANOVA_2011[grep("^/Biology and life sciences",ANOVA_2011[,1]),2]

ANOVA_2011_Bio_count<- length(ANOVA_2011_Bio)

ANOVA_2011_Phys<- ANOVA_2011[grep("^/Physical sciences",ANOVA_2011[,1]),2]

ANOVA_2011_Phys_count<- length(ANOVA_2011_Phys) 

ANOVA_2011_Med<- ANOVA_2011[grep("^/Medicine and health sciences",ANOVA_2011[,1]),2]

ANOVA_2011_Med_count<- length(ANOVA_2011_Med) 

ANOVA_2011_Res<- ANOVA_2011[grep("^/Research and analysis methods",ANOVA_2011[,1]),2]

ANOVA_2011_Res_count<- length(ANOVA_2011_Res) 

ANOVA_2011_Earth<- ANOVA_2011[grep("^/Earth sciences",ANOVA_2011[,1]),2]

ANOVA_2011_Earth_count<- length(ANOVA_2011_Earth) 

ANOVA_2011_Comp<- ANOVA_2011[grep("^/Computer and information sciences",ANOVA_2011[,1]),2]

ANOVA_2011_Comp_count<- length(ANOVA_2011_Comp) 

ANOVA_2011_Eng<- ANOVA_2011[grep("^/Engineering and technology",ANOVA_2011[,1]),2]

ANOVA_2011_Eng_count<- length(ANOVA_2011_Eng) 

ANOVA_2011_Soc<- ANOVA_2011[grep("^/Social sciences",ANOVA_2011[,1]),2]

ANOVA_2011_Soc_count<- length(ANOVA_2011_Soc)

###ANOVA 2012
ANOVA_2012<- ANOVA_search_clean[grep("^2012",ANOVA_search_clean[,2]),]

ANOVA_2012_Bio<- ANOVA_2012[grep("^/Biology and life sciences",ANOVA_2012[,1]),2]

ANOVA_2012_Bio_count<- length(ANOVA_2012_Bio)

ANOVA_2012_Phys<- ANOVA_2012[grep("^/Physical sciences",ANOVA_2012[,1]),2]

ANOVA_2012_Phys_count<- length(ANOVA_2012_Phys) 

ANOVA_2012_Med<- ANOVA_2012[grep("^/Medicine and health sciences",ANOVA_2012[,1]),2]

ANOVA_2012_Med_count<- length(ANOVA_2012_Med) 

ANOVA_2012_Res<- ANOVA_2012[grep("^/Research and analysis methods",ANOVA_2012[,1]),2]

ANOVA_2012_Res_count<- length(ANOVA_2012_Res) 

ANOVA_2012_Earth<- ANOVA_2012[grep("^/Earth sciences",ANOVA_2012[,1]),2]

ANOVA_2012_Earth_count<- length(ANOVA_2012_Earth) 

ANOVA_2012_Comp<- ANOVA_2012[grep("^/Computer and information sciences",ANOVA_2012[,1]),2]

ANOVA_2012_Comp_count<- length(ANOVA_2012_Comp) 

ANOVA_2012_Eng<- ANOVA_2012[grep("^/Engineering and technology",ANOVA_2012[,1]),2]

ANOVA_2012_Eng_count<- length(ANOVA_2012_Eng) 

ANOVA_2012_Soc<- ANOVA_2012[grep("^/Social sciences",ANOVA_2012[,1]),2]

ANOVA_2012_Soc_count<- length(ANOVA_2012_Soc)

##ANOVA 2013

ANOVA_2013<- ANOVA_search_clean[grep("^2013",ANOVA_search_clean[,2]),]

ANOVA_2013_Bio<- ANOVA_2013[grep("^/Biology and life sciences",ANOVA_2013[,1]),2]

ANOVA_2013_Bio_count<- length(ANOVA_2013_Bio)

ANOVA_2013_Phys<- ANOVA_2013[grep("^/Physical sciences",ANOVA_2013[,1]),2]

ANOVA_2013_Phys_count<- length(ANOVA_2013_Phys) 

ANOVA_2013_Med<- ANOVA_2013[grep("^/Medicine and health sciences",ANOVA_2013[,1]),2]

ANOVA_2013_Med_count<- length(ANOVA_2013_Med) 

ANOVA_2013_Res<- ANOVA_2013[grep("^/Research and analysis methods",ANOVA_2013[,1]),2]

ANOVA_2013_Res_count<- length(ANOVA_2013_Res) 

ANOVA_2013_Earth<- ANOVA_2013[grep("^/Earth sciences",ANOVA_2013[,1]),2]

ANOVA_2013_Earth_count<- length(ANOVA_2013_Earth) 

ANOVA_2013_Comp<- ANOVA_2013[grep("^/Computer and information sciences",ANOVA_2013[,1]),2]

ANOVA_2013_Comp_count<- length(ANOVA_2013_Comp) 

ANOVA_2013_Eng<- ANOVA_2013[grep("^/Engineering and technology",ANOVA_2013[,1]),2]

ANOVA_2013_Eng_count<- length(ANOVA_2013_Eng) 

ANOVA_2013_Soc<- ANOVA_2013[grep("^/Social sciences",ANOVA_2013[,1]),2]

ANOVA_2013_Soc_count<- length(ANOVA_2013_Soc)

###ANOVA 2014

ANOVA_2014<- ANOVA_search_clean[grep("^2014",ANOVA_search_clean[,2]),]

ANOVA_2014_Bio<- ANOVA_2014[grep("^/Biology and life sciences",ANOVA_2014[,1]),2]

ANOVA_2014_Bio_count<- length(ANOVA_2014_Bio)

ANOVA_2014_Phys<- ANOVA_2014[grep("^/Physical sciences",ANOVA_2014[,1]),2]

ANOVA_2014_Phys_count<- length(ANOVA_2014_Phys) 

ANOVA_2014_Med<- ANOVA_2014[grep("^/Medicine and health sciences",ANOVA_2014[,1]),2]

ANOVA_2014_Med_count<- length(ANOVA_2014_Med) 

ANOVA_2014_Res<- ANOVA_2014[grep("^/Research and analysis methods",ANOVA_2014[,1]),2]

ANOVA_2014_Res_count<- length(ANOVA_2014_Res) 

ANOVA_2014_Earth<- ANOVA_2014[grep("^/Earth sciences",ANOVA_2014[,1]),2]

ANOVA_2014_Earth_count<- length(ANOVA_2014_Earth) 

ANOVA_2014_Comp<- ANOVA_2014[grep("^/Computer and information sciences",ANOVA_2014[,1]),2]

ANOVA_2014_Comp_count<- length(ANOVA_2014_Comp) 

ANOVA_2014_Eng<- ANOVA_2014[grep("^/Engineering and technology",ANOVA_2014[,1]),2]

ANOVA_2014_Eng_count<- length(ANOVA_2014_Eng) 

ANOVA_2014_Soc<- ANOVA_2014[grep("^/Social sciences",ANOVA_2014[,1]),2]

ANOVA_2014_Soc_count<- length(ANOVA_2014_Soc)

### ANOVA 2015

ANOVA_2015<- ANOVA_search_clean[grep("^2015",ANOVA_search_clean[,2]),]

ANOVA_2015_Bio<- ANOVA_2015[grep("^/Biology and life sciences",ANOVA_2015[,1]),2]

ANOVA_2015_Bio_count<- length(ANOVA_2015_Bio)

ANOVA_2015_Phys<- ANOVA_2015[grep("^/Physical sciences",ANOVA_2015[,1]),2]

ANOVA_2015_Phys_count<- length(ANOVA_2015_Phys) 

ANOVA_2015_Med<- ANOVA_2015[grep("^/Medicine and health sciences",ANOVA_2015[,1]),2]

ANOVA_2015_Med_count<- length(ANOVA_2015_Med) 

ANOVA_2015_Res<- ANOVA_2015[grep("^/Research and analysis methods",ANOVA_2015[,1]),2]

ANOVA_2015_Res_count<- length(ANOVA_2015_Res) 

ANOVA_2015_Earth<- ANOVA_2015[grep("^/Earth sciences",ANOVA_2015[,1]),2]

ANOVA_2015_Earth_count<- length(ANOVA_2015_Earth) 

ANOVA_2015_Comp<- ANOVA_2015[grep("^/Computer and information sciences",ANOVA_2015[,1]),2]

ANOVA_2015_Comp_count<- length(ANOVA_2015_Comp) 

ANOVA_2015_Eng<- ANOVA_2015[grep("^/Engineering and technology",ANOVA_2015[,1]),2]

ANOVA_2015_Eng_count<- length(ANOVA_2015_Eng) 

ANOVA_2015_Soc<- ANOVA_2015[grep("^/Social sciences",ANOVA_2015[,1]),2]

ANOVA_2015_Soc_count<- length(ANOVA_2015_Soc)

##ANOVA 2016

ANOVA_2016<- ANOVA_search_clean[grep("^2016",ANOVA_search_clean[,2]),]


ANOVA_2016_Bio<- ANOVA_2016[grep("^/Biology and life sciences",ANOVA_2016[,1]),2]

ANOVA_2016_Bio_count<- length(ANOVA_2016_Bio)

ANOVA_2016_Phys<- ANOVA_2016[grep("^/Physical sciences",ANOVA_2016[,1]),2]

ANOVA_2016_Phys_count<- length(ANOVA_2016_Phys) 

ANOVA_2016_Med<- ANOVA_2016[grep("^/Medicine and health sciences",ANOVA_2016[,1]),2]

ANOVA_2016_Med_count<- length(ANOVA_2016_Med) 

ANOVA_2016_Res<- ANOVA_2016[grep("^/Research and analysis methods",ANOVA_2016[,1]),2]

ANOVA_2016_Res_count<- length(ANOVA_2016_Res) 

ANOVA_2016_Earth<- ANOVA_2016[grep("^/Earth sciences",ANOVA_2016[,1]),2]

ANOVA_2016_Earth_count<- length(ANOVA_2016_Earth) 

ANOVA_2016_Comp<- ANOVA_2016[grep("^/Computer and information sciences",ANOVA_2016[,1]),2]

ANOVA_2016_Comp_count<- length(ANOVA_2016_Comp) 

ANOVA_2016_Eng<- ANOVA_2016[grep("^/Engineering and technology",ANOVA_2016[,1]),2]

ANOVA_2016_Eng_count<- length(ANOVA_2016_Eng) 

ANOVA_2016_Soc<- ANOVA_2016[grep("^/Social sciences",ANOVA_2016[,1]),2]

ANOVA_2016_Soc_count<- length(ANOVA_2016_Soc)

## ANOVA 2017

ANOVA_2017<- ANOVA_search_clean[grep("^2017",ANOVA_search_clean[,2]),]


ANOVA_2017_Bio<- ANOVA_2017[grep("^/Biology and life sciences",ANOVA_2017[,1]),2]

ANOVA_2017_Bio_count<- length(ANOVA_2017_Bio)

ANOVA_2017_Phys<- ANOVA_2017[grep("^/Physical sciences",ANOVA_2017[,1]),2]

ANOVA_2017_Phys_count<- length(ANOVA_2017_Phys) 

ANOVA_2017_Med<- ANOVA_2017[grep("^/Medicine and health sciences",ANOVA_2017[,1]),2]

ANOVA_2017_Med_count<- length(ANOVA_2017_Med) 

ANOVA_2017_Res<- ANOVA_2017[grep("^/Research and analysis methods",ANOVA_2017[,1]),2]

ANOVA_2017_Res_count<- length(ANOVA_2017_Res) 

ANOVA_2017_Earth<- ANOVA_2017[grep("^/Earth sciences",ANOVA_2017[,1]),2]

ANOVA_2017_Earth_count<- length(ANOVA_2017_Earth) 

ANOVA_2017_Comp<- ANOVA_2017[grep("^/Computer and information sciences",ANOVA_2017[,1]),2]

ANOVA_2017_Comp_count<- length(ANOVA_2017_Comp) 

ANOVA_2017_Eng<- ANOVA_2017[grep("^/Engineering and technology",ANOVA_2017[,1]),2]

ANOVA_2017_Eng_count<- length(ANOVA_2017_Eng) 

ANOVA_2017_Soc<- ANOVA_2017[grep("^/Social sciences",ANOVA_2017[,1]),2]

ANOVA_2017_Soc_count<- length(ANOVA_2017_Soc)

#### ANOVA counts table

subjects<- c("Biology and life sciences","Physical sciences","Medicine and health sciences", "Research and analysis", "Earth Sciences","Computer and information sciences", "Engineering and technology", "Social sciences")


ANOVA_counts_2004_bio<- c(ANOVA_2004_Bio_count,1,rep(0,13),1,rep(0,7))
ANOVA_counts_2004_Comp<- c(ANOVA_2004_Comp_count,1,rep(0,13),0,1,rep(0,6))
ANOVA_counts_2004_Earth<-c(ANOVA_2004_Earth_count,1,rep(0,13),0,0,1,rep(0,5))
ANOVA_counts_2004_Eng<- c(ANOVA_2004_Eng_count,1,rep(0,13),0,0,0,1,rep(0,4))
ANOVA_counts_2004_Med<- c(ANOVA_2004_Med_count,1,rep(0,13),rep(0,4),1,0,0,0)
ANOVA_counts_2004_Phys<- c(ANOVA_2004_Phys_count,1,rep(0,13),rep(0,5),1,0,0)
ANOVA_count_2004_Res<-c(ANOVA_2004_Res_count,1,rep(0,13),rep(0,6),1,0)
ANOVA_count_2004_Soc<-c(ANOVA_2004_Soc_count,1,rep(0,13),rep(0,7),1)

ANOVA_counts_2005_bio<- c(ANOVA_2005_Bio_count,0,1,rep(0,12),1,rep(0,7))
ANOVA_counts_2005_Comp<- c(ANOVA_2005_Comp_count,0,1,rep(0,12),0,1,rep(0,6))
ANOVA_counts_2005_Earth<-c(ANOVA_2005_Earth_count,0,1,rep(0,12),0,0,1,rep(0,5))
ANOVA_counts_2005_Eng<- c(ANOVA_2005_Eng_count,0,1,rep(0,12),0,0,0,1,rep(0,4))
ANOVA_counts_2005_Med<- c(ANOVA_2005_Med_count,0,1,rep(0,12),rep(0,4),1,0,0,0)
ANOVA_counts_2005_Phys<- c(ANOVA_2005_Phys_count,0,1,rep(0,12),rep(0,5),1,0,0)
ANOVA_count_2005_Res<-c(ANOVA_2005_Res_count,0,1,rep(0,12),rep(0,6),1,0)
ANOVA_count_2005_Soc<-c(ANOVA_2005_Soc_count,0,1,rep(0,12),rep(0,7),1)

ANOVA_counts_2006_bio<- c(ANOVA_2006_Bio_count,0,0,1,rep(0,11),1,rep(0,7))
ANOVA_counts_2006_Comp<- c(ANOVA_2006_Comp_count,0,0,1,rep(0,11),0,1,rep(0,6))
ANOVA_counts_2006_Earth<-c(ANOVA_2006_Earth_count,0,0,1,rep(0,11),0,0,1,rep(0,5))
ANOVA_counts_2006_Eng<- c(ANOVA_2006_Eng_count,0,0,1,rep(0,11),0,0,0,1,rep(0,4))
ANOVA_counts_2006_Med<- c(ANOVA_2006_Med_count,0,0,1,rep(0,11),rep(0,4),1,0,0,0)
ANOVA_counts_2006_Phys<- c(ANOVA_2006_Phys_count,0,0,1,rep(0,11),rep(0,5),1,0,0)
ANOVA_count_2006_Res<-c(ANOVA_2006_Res_count,0,0,1,rep(0,11),rep(0,6),1,0)
ANOVA_count_2006_Soc<-c(ANOVA_2006_Soc_count,0,0,1,rep(0,11),rep(0,7),1)

ANOVA_counts_2007_bio<- c(ANOVA_2007_Bio_count,0,0,0,1,rep(0,10),1,rep(0,7))
ANOVA_counts_2007_Comp<- c(ANOVA_2007_Comp_count,0,0,0,1,rep(0,10),0,1,rep(0,6))
ANOVA_counts_2007_Earth<-c(ANOVA_2007_Earth_count,0,0,0,1,rep(0,10),0,0,1,rep(0,5))
ANOVA_counts_2007_Eng<- c(ANOVA_2007_Eng_count,0,0,0,1,rep(0,10),0,0,0,1,rep(0,4))
ANOVA_counts_2007_Med<- c(ANOVA_2007_Med_count,0,0,0,1,rep(0,10),rep(0,4),1,0,0,0)
ANOVA_counts_2007_Phys<- c(ANOVA_2007_Phys_count,0,0,0,1,rep(0,10),rep(0,5),1,0,0)
ANOVA_count_2007_Res<-c(ANOVA_2007_Res_count,0,0,0,1,rep(0,10),rep(0,6),1,0)
ANOVA_count_2007_Soc<-c(ANOVA_2007_Soc_count,0,0,0,1,rep(0,10),rep(0,7),1)

ANOVA_counts_2008_bio<- c(ANOVA_2008_Bio_count,rep(0,4),1,rep(0,9),1,rep(0,7))
ANOVA_counts_2008_Comp<- c(ANOVA_2008_Comp_count,rep(0,4),1,rep(0,9),0,1,rep(0,6))
ANOVA_counts_2008_Earth<-c(ANOVA_2008_Earth_count,rep(0,4),1,rep(0,9),0,0,1,rep(0,5))
ANOVA_counts_2008_Eng<- c(ANOVA_2008_Eng_count,rep(0,4),1,rep(0,9),0,0,0,1,rep(0,4))
ANOVA_counts_2008_Med<- c(ANOVA_2008_Med_count,rep(0,4),1,rep(0,9),rep(0,4),1,0,0,0)
ANOVA_counts_2008_Phys<- c(ANOVA_2008_Phys_count,rep(0,4),1,rep(0,9),rep(0,5),1,0,0)
ANOVA_count_2008_Res<-c(ANOVA_2008_Res_count,rep(0,4),1,rep(0,9),rep(0,6),1,0)
ANOVA_count_2008_Soc<-c(ANOVA_2008_Soc_count,rep(0,4),1,rep(0,9),rep(0,7),1)


ANOVA_counts_2009_bio<- c(ANOVA_2009_Bio_count,rep(0,5),1,rep(0,8),1,rep(0,7))
ANOVA_counts_2009_Comp<- c(ANOVA_2009_Comp_count,rep(0,5),1,rep(0,8),0,1,rep(0,6))
ANOVA_counts_2009_Earth<-c(ANOVA_2009_Earth_count,rep(0,5),1,rep(0,8),0,0,1,rep(0,5))
ANOVA_counts_2009_Eng<- c(ANOVA_2009_Eng_count,rep(0,5),1,rep(0,8),0,0,0,1,rep(0,4))
ANOVA_counts_2009_Med<- c(ANOVA_2009_Med_count,rep(0,5),1,rep(0,8),rep(0,4),1,0,0,0)
ANOVA_counts_2009_Phys<- c(ANOVA_2009_Phys_count,rep(0,5),1,rep(0,8),rep(0,5),1,0,0)
ANOVA_count_2009_Res<-c(ANOVA_2009_Res_count,rep(0,5),1,rep(0,8),rep(0,6),1,0)
ANOVA_count_2009_Soc<-c(ANOVA_2009_Soc_count,rep(0,5),1,rep(0,8),rep(0,7),1)

ANOVA_counts_2010_bio<- c(ANOVA_2010_Bio_count,rep(0,6),1,rep(0,7),1,rep(0,7))
ANOVA_counts_2010_Comp<- c(ANOVA_2010_Comp_count,rep(0,6),1,rep(0,7),0,1,rep(0,6))
ANOVA_counts_2010_Earth<-c(ANOVA_2010_Earth_count,rep(0,6),1,rep(0,7),0,0,1,rep(0,5))
ANOVA_counts_2010_Eng<- c(ANOVA_2010_Eng_count,rep(0,6),1,rep(0,7),0,0,0,1,rep(0,4))
ANOVA_counts_2010_Med<- c(ANOVA_2010_Med_count,rep(0,6),1,rep(0,7),rep(0,4),1,0,0,0)
ANOVA_counts_2010_Phys<- c(ANOVA_2010_Phys_count,rep(0,6),1,rep(0,7),rep(0,5),1,0,0)
ANOVA_count_2010_Res<-c(ANOVA_2010_Res_count,rep(0,6),1,rep(0,7),rep(0,6),1,0)
ANOVA_count_2010_Soc<-c(ANOVA_2010_Soc_count,rep(0,6),1,rep(0,7),rep(0,7),1)


ANOVA_counts_2011_bio<- c(ANOVA_2011_Bio_count,rep(0,7),1,rep(0,6),1,rep(0,7))
ANOVA_counts_2011_Comp<- c(ANOVA_2011_Comp_count,rep(0,7),1,rep(0,6),0,1,rep(0,6))
ANOVA_counts_2011_Earth<-c(ANOVA_2011_Earth_count,rep(0,7),1,rep(0,6),0,0,1,rep(0,5))
ANOVA_counts_2011_Eng<- c(ANOVA_2011_Eng_count,rep(0,7),1,rep(0,6),0,0,0,1,rep(0,4))
ANOVA_counts_2011_Med<- c(ANOVA_2011_Med_count,rep(0,7),1,rep(0,6),rep(0,4),1,0,0,0)
ANOVA_counts_2011_Phys<- c(ANOVA_2011_Phys_count,rep(0,7),1,rep(0,6),rep(0,5),1,0,0)
ANOVA_count_2011_Res<-c(ANOVA_2011_Res_count,rep(0,7),1,rep(0,6),rep(0,6),1,0)
ANOVA_count_2011_Soc<-c(ANOVA_2011_Soc_count,rep(0,7),1,rep(0,6),rep(0,7),1)

ANOVA_counts_2012_bio<- c(ANOVA_2012_Bio_count,rep(0,8),1,rep(0,5),1,rep(0,7))
ANOVA_counts_2012_Comp<- c(ANOVA_2012_Comp_count,rep(0,8),1,rep(0,5),0,1,rep(0,6))
ANOVA_counts_2012_Earth<-c(ANOVA_2012_Earth_count,rep(0,8),1,rep(0,5),0,0,1,rep(0,5))
ANOVA_counts_2012_Eng<- c(ANOVA_2012_Eng_count,rep(0,8),1,rep(0,5),0,0,0,1,rep(0,4))
ANOVA_counts_2012_Med<- c(ANOVA_2012_Med_count,rep(0,8),1,rep(0,5),rep(0,4),1,0,0,0)
ANOVA_counts_2012_Phys<- c(ANOVA_2012_Phys_count,rep(0,8),1,rep(0,5),rep(0,5),1,0,0)
ANOVA_count_2012_Res<-c(ANOVA_2012_Res_count,rep(0,8),1,rep(0,5),rep(0,6),1,0)
ANOVA_count_2012_Soc<-c(ANOVA_2012_Soc_count,rep(0,8),1,rep(0,5),rep(0,7),1)

ANOVA_counts_2013_bio<- c(ANOVA_2013_Bio_count,rep(0,9),1,rep(0,4),1,rep(0,7))
ANOVA_counts_2013_Comp<- c(ANOVA_2013_Comp_count,rep(0,9),1,rep(0,4),0,1,rep(0,6))
ANOVA_counts_2013_Earth<-c(ANOVA_2013_Earth_count,rep(0,9),1,rep(0,4),0,0,1,rep(0,5))
ANOVA_counts_2013_Eng<- c(ANOVA_2013_Eng_count,rep(0,9),1,rep(0,4),0,0,0,1,rep(0,4))
ANOVA_counts_2013_Med<- c(ANOVA_2013_Med_count,rep(0,9),1,rep(0,4),rep(0,4),1,0,0,0)
ANOVA_counts_2013_Phys<- c(ANOVA_2013_Phys_count,rep(0,9),1,rep(0,4),rep(0,5),1,0,0)
ANOVA_count_2013_Res<-c(ANOVA_2013_Res_count,rep(0,9),1,rep(0,4),rep(0,6),1,0)
ANOVA_count_2013_Soc<-c(ANOVA_2013_Soc_count,rep(0,9),1,rep(0,4),rep(0,7),1)

ANOVA_counts_2014_bio<- c(ANOVA_2014_Bio_count,rep(0,10),1,rep(0,3),1,rep(0,7))
ANOVA_counts_2014_Comp<- c(ANOVA_2014_Comp_count,rep(0,10),1,rep(0,3),0,1,rep(0,6))
ANOVA_counts_2014_Earth<-c(ANOVA_2014_Earth_count,rep(0,10),1,rep(0,3),0,0,1,rep(0,5))
ANOVA_counts_2014_Eng<- c(ANOVA_2014_Eng_count,rep(0,10),1,rep(0,3),0,0,0,1,rep(0,4))
ANOVA_counts_2014_Med<- c(ANOVA_2014_Med_count,rep(0,10),1,rep(0,3),rep(0,4),1,0,0,0)
ANOVA_counts_2014_Phys<- c(ANOVA_2014_Phys_count,rep(0,10),1,rep(0,3),rep(0,5),1,0,0)
ANOVA_count_2014_Res<-c(ANOVA_2014_Res_count,rep(0,10),1,rep(0,3),rep(0,6),1,0)
ANOVA_count_2014_Soc<-c(ANOVA_2014_Soc_count,rep(0,10),1,rep(0,3),rep(0,7),1)

ANOVA_counts_2015_bio<- c(ANOVA_2015_Bio_count,rep(0,11),1,rep(0,2),1,rep(0,7))
ANOVA_counts_2015_Comp<- c(ANOVA_2015_Comp_count,rep(0,11),1,rep(0,2),0,1,rep(0,6))
ANOVA_counts_2015_Earth<-c(ANOVA_2015_Earth_count,rep(0,11),1,rep(0,2),0,0,1,rep(0,5))
ANOVA_counts_2015_Eng<- c(ANOVA_2015_Eng_count,rep(0,11),1,rep(0,2),0,0,0,1,rep(0,4))
ANOVA_counts_2015_Med<- c(ANOVA_2015_Med_count,rep(0,11),1,rep(0,2),rep(0,4),1,0,0,0)
ANOVA_counts_2015_Phys<- c(ANOVA_2015_Phys_count,rep(0,11),1,rep(0,2),rep(0,5),1,0,0)
ANOVA_count_2015_Res<-c(ANOVA_2015_Res_count,rep(0,11),1,rep(0,2),rep(0,6),1,0)
ANOVA_count_2015_Soc<-c(ANOVA_2015_Soc_count,rep(0,11),1,rep(0,2),rep(0,7),1)

ANOVA_counts_2016_bio<- c(ANOVA_2016_Bio_count,rep(0,12),1,rep(0,1),1,rep(0,7))
ANOVA_counts_2016_Comp<- c(ANOVA_2016_Comp_count,rep(0,12),1,rep(0,1),0,1,rep(0,6))
ANOVA_counts_2016_Earth<-c(ANOVA_2016_Earth_count,rep(0,12),1,rep(0,1),0,0,1,rep(0,5))
ANOVA_counts_2016_Eng<- c(ANOVA_2016_Eng_count,rep(0,12),1,rep(0,1),0,0,0,1,rep(0,4))
ANOVA_counts_2016_Med<- c(ANOVA_2016_Med_count,rep(0,12),1,rep(0,1),rep(0,4),1,0,0,0)
ANOVA_counts_2016_Phys<- c(ANOVA_2016_Phys_count,rep(0,12),1,rep(0,1),rep(0,5),1,0,0)
ANOVA_count_2016_Res<-c(ANOVA_2016_Res_count,rep(0,12),1,rep(0,1),rep(0,6),1,0)
ANOVA_count_2016_Soc<-c(ANOVA_2016_Soc_count,rep(0,12),1,rep(0,1),rep(0,7),1)

ANOVA_counts_2017_bio<- c(ANOVA_2017_Bio_count,rep(0,13),1,1,rep(0,7))
ANOVA_counts_2017_Comp<- c(ANOVA_2017_Comp_count,rep(0,13),1,0,1,rep(0,6))
ANOVA_counts_2017_Earth<-c(ANOVA_2017_Earth_count,rep(0,13),1,0,0,1,rep(0,5))
ANOVA_counts_2017_Eng<- c(ANOVA_2017_Eng_count,rep(0,13),1,0,0,0,1,rep(0,4))
ANOVA_counts_2017_Med<- c(ANOVA_2017_Med_count,rep(0,13),1,rep(0,4),1,0,0,0)
ANOVA_counts_2017_Phys<- c(ANOVA_2017_Phys_count,rep(0,13),1,rep(0,5),1,0,0)
ANOVA_count_2017_Res<-c(ANOVA_2017_Res_count,rep(0,13),1,rep(0,6),1,0)
ANOVA_count_2017_Soc<-c(ANOVA_2017_Soc_count,rep(0,13),1,rep(0,7),1)

ANOVA_table<- rbind(ANOVA_counts_2004_bio,ANOVA_counts_2004_Comp,ANOVA_counts_2004_Earth,
                    ANOVA_counts_2004_Eng,ANOVA_counts_2004_Med,ANOVA_counts_2004_Phys,
                    ANOVA_count_2004_Res,ANOVA_count_2004_Soc,ANOVA_counts_2005_bio,
                    ANOVA_counts_2005_Comp,ANOVA_counts_2005_Earth,ANOVA_counts_2005_Eng,
                    ANOVA_counts_2005_Med,ANOVA_counts_2005_Phys,ANOVA_count_2005_Res,
                    ANOVA_count_2005_Soc,ANOVA_counts_2006_bio,
                    ANOVA_counts_2006_Comp,ANOVA_counts_2006_Earth,ANOVA_counts_2006_Eng,
                    ANOVA_counts_2006_Med,ANOVA_counts_2006_Phys,ANOVA_count_2006_Res,
                    ANOVA_count_2006_Soc,ANOVA_counts_2007_bio,
                    ANOVA_counts_2007_Comp,ANOVA_counts_2007_Earth,ANOVA_counts_2007_Eng,
                    ANOVA_counts_2007_Med,ANOVA_counts_2007_Phys,ANOVA_count_2007_Res,
                    ANOVA_count_2007_Soc, ANOVA_counts_2008_bio,
                    ANOVA_counts_2008_Comp,ANOVA_counts_2008_Earth,ANOVA_counts_2008_Eng,
                    ANOVA_counts_2008_Med,ANOVA_counts_2008_Phys,ANOVA_count_2008_Res,
                    ANOVA_count_2008_Soc, ANOVA_counts_2009_bio,
                    ANOVA_counts_2009_Comp,ANOVA_counts_2009_Earth,ANOVA_counts_2009_Eng,
                    ANOVA_counts_2009_Med,ANOVA_counts_2009_Phys,ANOVA_count_2009_Res,
                    ANOVA_count_2009_Soc,ANOVA_counts_2010_bio,
                    ANOVA_counts_2010_Comp,ANOVA_counts_2010_Earth,ANOVA_counts_2010_Eng,
                    ANOVA_counts_2010_Med,ANOVA_counts_2010_Phys,ANOVA_count_2010_Res,
                    ANOVA_count_2010_Soc,ANOVA_counts_2011_bio,
                    ANOVA_counts_2011_Comp,ANOVA_counts_2011_Earth,ANOVA_counts_2011_Eng,
                    ANOVA_counts_2011_Med,ANOVA_counts_2011_Phys,ANOVA_count_2011_Res,
                    ANOVA_count_2011_Soc,ANOVA_counts_2012_bio,
                    ANOVA_counts_2012_Comp,ANOVA_counts_2012_Earth,ANOVA_counts_2012_Eng,
                    ANOVA_counts_2012_Med,ANOVA_counts_2012_Phys,ANOVA_count_2012_Res,
                    ANOVA_count_2012_Soc, ANOVA_counts_2013_bio,
                    ANOVA_counts_2013_Comp,ANOVA_counts_2013_Earth,ANOVA_counts_2013_Eng,
                    ANOVA_counts_2013_Med,ANOVA_counts_2013_Phys,ANOVA_count_2013_Res,
                    ANOVA_count_2013_Soc, ANOVA_counts_2014_bio,
                    ANOVA_counts_2014_Comp,ANOVA_counts_2014_Earth,ANOVA_counts_2014_Eng,
                    ANOVA_counts_2014_Med,ANOVA_counts_2014_Phys,ANOVA_count_2014_Res,
                    ANOVA_count_2014_Soc,ANOVA_counts_2015_bio,
                    ANOVA_counts_2015_Comp,ANOVA_counts_2015_Earth,ANOVA_counts_2015_Eng,
                    ANOVA_counts_2015_Med,ANOVA_counts_2015_Phys,ANOVA_count_2015_Res,
                    ANOVA_count_2015_Soc,ANOVA_counts_2016_bio,
                    ANOVA_counts_2016_Comp,ANOVA_counts_2016_Earth,ANOVA_counts_2016_Eng,
                    ANOVA_counts_2016_Med,ANOVA_counts_2016_Phys,ANOVA_count_2016_Res,
                    ANOVA_count_2016_Soc, ANOVA_counts_2017_bio,
                    ANOVA_counts_2017_Comp,ANOVA_counts_2017_Earth,ANOVA_counts_2017_Eng,
                    ANOVA_counts_2017_Med,ANOVA_counts_2017_Phys,ANOVA_count_2017_Res,
                    ANOVA_count_2017_Soc)

ANOVA_table[97:112,]
as.data.frame(ANOVA_table)

colnames(ANOVA_table)<- c("ANOVA_counts","2004","2005","2006","2007","2008","2009",
                          "2010","2011","2012","2013","2014","2015","2016","2017",
                          "Biology and life sciences","Computer and information sciences",
                          "Earth sciences","Engineering and tecnhology",
                          "Medicine and health sciences","Physical sciences",
                          "Research and analysis","Social Sciences")

as.numeric(ANOVA_table[,1])

year_covs<- ANOVA_table[,2:15]

terms_covs<- ANOVA_table[,16:23]

######## ANOVA model fitting############

model_ANOVA<- glm(ANOVA_table[,1]~year_covs*terms_covs, family="poisson")

summary(model_ANOVA)

##########Bayes counts assembly #################


Bayes_search<- searchplos(q="bayesian",fl=c("subject","publication_date"),limit=10000)

Bayes_search_clean<- matrix(unlist(Bayes_search[[2]]),ncol=2)


###Bayes 2004
Bayes_2004<- Bayes_search_clean[grep("^2004",Bayes_search_clean[,2]),]

Bayes_2004_Bio<- Bayes_2004[grep("^/Biology and life sciences",Bayes_2004[,1]),2]

Bayes_2004_Bio_count<- length(Bayes_2004_Bio)

Bayes_2004_Phys<- Bayes_2004[grep("^/Physical sciences",Bayes_2004[,1]),2]

Bayes_2004_Phys_count<- length(Bayes_2004_Phys) 

Bayes_2004_Med<- Bayes_2004[grep("^/Medicine and health sciences",Bayes_2004[,1]),2]

Bayes_2004_Med_count<- length(Bayes_2004_Med) 

Bayes_2004_Res<- Bayes_2004[grep("^/Research and analysis methods",Bayes_2004[,1]),2]

Bayes_2004_Res_count<- length(Bayes_2004_Res) 

Bayes_2004_Earth<- Bayes_2004[grep("^/Earth sciences",Bayes_2004[,1]),2]

Bayes_2004_Earth_count<- length(Bayes_2004_Earth) 

Bayes_2004_Comp<- Bayes_2004[grep("^/Computer and information sciences",Bayes_2004[,1]),2]

Bayes_2004_Comp_count<- length(Bayes_2004_Comp) 

Bayes_2004_Eng<- Bayes_2004[grep("^/Engineering and technology",Bayes_2004[,1]),2]

Bayes_2004_Eng_count<- length(Bayes_2004_Eng) 

Bayes_2004_Soc<- Bayes_2004[grep("^/Social sciences",Bayes_2004[,1]),2]

Bayes_2004_Soc_count<- length(Bayes_2004_Soc) 


########Bayes 2005

Bayes_2005<- Bayes_search_clean[grep("^2005",Bayes_search_clean[,2]),]

Bayes_2005_Bio<- Bayes_2005[grep("^/Biology and life sciences",Bayes_2005[,1]),2]

Bayes_2005_Bio_count<- length(Bayes_2005_Bio)

Bayes_2005_Phys<- Bayes_2005[grep("^/Physical sciences",Bayes_2005[,1]),2]

Bayes_2005_Phys_count<- length(Bayes_2005_Phys) 

Bayes_2005_Med<- Bayes_2005[grep("^/Medicine and health sciences",Bayes_2005[,1]),2]

Bayes_2005_Med_count<- length(Bayes_2005_Med) 

Bayes_2005_Res<- Bayes_2005[grep("^/Research and analysis methods",Bayes_2005[,1]),2]

Bayes_2005_Res_count<- length(Bayes_2005_Res) 

Bayes_2005_Earth<- Bayes_2005[grep("^/Earth sciences",Bayes_2005[,1]),2]

Bayes_2005_Earth_count<- length(Bayes_2005_Earth) 

Bayes_2005_Comp<- Bayes_2005[grep("^/Computer and information sciences",Bayes_2005[,1]),2]

Bayes_2005_Comp_count<- length(Bayes_2005_Comp) 

Bayes_2005_Eng<- Bayes_2005[grep("^/Engineering and technology",Bayes_2005[,1]),2]

Bayes_2005_Eng_count<- length(Bayes_2005_Eng) 

Bayes_2005_Soc<- Bayes_2005[grep("^/Social sciences",Bayes_2005[,1]),2]

Bayes_2005_Soc_count<- length(Bayes_2005_Soc) 


###### Bayes 2006


Bayes_2006<- Bayes_search_clean[grep("^2006",Bayes_search_clean[,2]),]


Bayes_2006_Bio<- Bayes_2006[grep("^/Biology and life sciences",Bayes_2006[,1]),2]

Bayes_2006_Bio_count<- length(Bayes_2006_Bio)

Bayes_2006_Phys<- Bayes_2006[grep("^/Physical sciences",Bayes_2006[,1]),2]

Bayes_2006_Phys_count<- length(Bayes_2006_Phys) 

Bayes_2006_Med<- Bayes_2006[grep("^/Medicine and health sciences",Bayes_2006[,1]),2]

Bayes_2006_Med_count<- length(Bayes_2006_Med) 

Bayes_2006_Res<- Bayes_2006[grep("^/Research and analysis methods",Bayes_2006[,1]),2]

Bayes_2006_Res_count<- length(Bayes_2006_Res) 

Bayes_2006_Earth<- Bayes_2006[grep("^/Earth sciences",Bayes_2006[,1]),2]

Bayes_2006_Earth_count<- length(Bayes_2006_Earth) 

Bayes_2006_Comp<- Bayes_2006[grep("^/Computer and information sciences",Bayes_2006[,1]),2]

Bayes_2006_Comp_count<- length(Bayes_2006_Comp) 

Bayes_2006_Eng<- Bayes_2006[grep("^/Engineering and technology",Bayes_2006[,1]),2]

Bayes_2006_Eng_count<- length(Bayes_2006_Eng) 

Bayes_2006_Soc<- Bayes_2006[grep("^/Social sciences",Bayes_2006[,1]),2]

Bayes_2006_Soc_count<- length(Bayes_2006_Soc) 

## Bayes 2007


Bayes_2007<- Bayes_search_clean[grep("^2007",Bayes_search_clean[,2]),]



Bayes_2007_Bio<- Bayes_2007[grep("^/Biology and life sciences",Bayes_2007[,1]),2]

Bayes_2007_Bio_count<- length(Bayes_2007_Bio)

Bayes_2007_Phys<- Bayes_2007[grep("^/Physical sciences",Bayes_2007[,1]),2]

Bayes_2007_Phys_count<- length(Bayes_2007_Phys) 

Bayes_2007_Med<- Bayes_2007[grep("^/Medicine and health sciences",Bayes_2007[,1]),2]

Bayes_2007_Med_count<- length(Bayes_2007_Med) 

Bayes_2007_Res<- Bayes_2007[grep("^/Research and analysis methods",Bayes_2007[,1]),2]

Bayes_2007_Res_count<- length(Bayes_2007_Res) 

Bayes_2007_Earth<- Bayes_2007[grep("^/Earth sciences",Bayes_2007[,1]),2]

Bayes_2007_Earth_count<- length(Bayes_2007_Earth) 

Bayes_2007_Comp<- Bayes_2007[grep("^/Computer and information sciences",Bayes_2007[,1]),2]

Bayes_2007_Comp_count<- length(Bayes_2007_Comp) 

Bayes_2007_Eng<- Bayes_2007[grep("^/Engineering and technology",Bayes_2007[,1]),2]

Bayes_2007_Eng_count<- length(Bayes_2007_Eng) 

Bayes_2007_Soc<- Bayes_2007[grep("^/Social sciences",Bayes_2007[,1]),2]

Bayes_2007_Soc_count<- length(Bayes_2007_Soc) 

#### Bayes 2008
Bayes_2008<- Bayes_search_clean[grep("^2008",Bayes_search_clean[,2]),]


Bayes_2008_Bio<- Bayes_2008[grep("^/Biology and life sciences",Bayes_2008[,1]),2]

Bayes_2008_Bio_count<- length(Bayes_2008_Bio)

Bayes_2008_Phys<- Bayes_2008[grep("^/Physical sciences",Bayes_2008[,1]),2]

Bayes_2008_Phys_count<- length(Bayes_2008_Phys) 

Bayes_2008_Med<- Bayes_2008[grep("^/Medicine and health sciences",Bayes_2008[,1]),2]

Bayes_2008_Med_count<- length(Bayes_2008_Med) 

Bayes_2008_Res<- Bayes_2008[grep("^/Research and analysis methods",Bayes_2008[,1]),2]

Bayes_2008_Res_count<- length(Bayes_2008_Res) 

Bayes_2008_Earth<- Bayes_2008[grep("^/Earth sciences",Bayes_2008[,1]),2]

Bayes_2008_Earth_count<- length(Bayes_2008_Earth) 

Bayes_2008_Comp<- Bayes_2008[grep("^/Computer and information sciences",Bayes_2008[,1]),2]

Bayes_2008_Comp_count<- length(Bayes_2008_Comp) 

Bayes_2008_Eng<- Bayes_2008[grep("^/Engineering and technology",Bayes_2008[,1]),2]

Bayes_2008_Eng_count<- length(Bayes_2008_Eng) 

Bayes_2008_Soc<- Bayes_2008[grep("^/Social sciences",Bayes_2008[,1]),2]

Bayes_2008_Soc_count<- length(Bayes_2008_Soc) 

##2009

Bayes_2009<- Bayes_search_clean[grep("^2009",Bayes_search_clean[,2]),]


Bayes_2009_Bio<- Bayes_2009[grep("^/Biology and life sciences",Bayes_2009[,1]),2]

Bayes_2009_Bio_count<- length(Bayes_2009_Bio)

Bayes_2009_Phys<- Bayes_2009[grep("^/Physical sciences",Bayes_2009[,1]),2]

Bayes_2009_Phys_count<- length(Bayes_2009_Phys) 

Bayes_2009_Med<- Bayes_2009[grep("^/Medicine and health sciences",Bayes_2009[,1]),2]

Bayes_2009_Med_count<- length(Bayes_2009_Med) 

Bayes_2009_Res<- Bayes_2009[grep("^/Research and analysis methods",Bayes_2009[,1]),2]

Bayes_2009_Res_count<- length(Bayes_2009_Res) 

Bayes_2009_Earth<- Bayes_2009[grep("^/Earth sciences",Bayes_2009[,1]),2]

Bayes_2009_Earth_count<- length(Bayes_2009_Earth) 

Bayes_2009_Comp<- Bayes_2009[grep("^/Computer and information sciences",Bayes_2009[,1]),2]

Bayes_2009_Comp_count<- length(Bayes_2009_Comp) 

Bayes_2009_Eng<- Bayes_2009[grep("^/Engineering and technology",Bayes_2009[,1]),2]

Bayes_2009_Eng_count<- length(Bayes_2009_Eng) 

Bayes_2009_Soc<- Bayes_2009[grep("^/Social sciences",Bayes_2009[,1]),2]

Bayes_2009_Soc_count<- length(Bayes_2009_Soc)

### Bayes 2010

Bayes_2010<- Bayes_search_clean[grep("^2010",Bayes_search_clean[,2]),]

Bayes_2010_Bio<- Bayes_2010[grep("^/Biology and life sciences",Bayes_2010[,1]),2]

Bayes_2010_Bio_count<- length(Bayes_2010_Bio)

Bayes_2010_Phys<- Bayes_2010[grep("^/Physical sciences",Bayes_2010[,1]),2]

Bayes_2010_Phys_count<- length(Bayes_2010_Phys) 

Bayes_2010_Med<- Bayes_2010[grep("^/Medicine and health sciences",Bayes_2010[,1]),2]

Bayes_2010_Med_count<- length(Bayes_2010_Med) 

Bayes_2010_Res<- Bayes_2010[grep("^/Research and analysis methods",Bayes_2010[,1]),2]

Bayes_2010_Res_count<- length(Bayes_2010_Res) 

Bayes_2010_Earth<- Bayes_2010[grep("^/Earth sciences",Bayes_2010[,1]),2]

Bayes_2010_Earth_count<- length(Bayes_2010_Earth) 

Bayes_2010_Comp<- Bayes_2010[grep("^/Computer and information sciences",Bayes_2010[,1]),2]

Bayes_2010_Comp_count<- length(Bayes_2010_Comp) 

Bayes_2010_Eng<- Bayes_2010[grep("^/Engineering and technology",Bayes_2010[,1]),2]

Bayes_2010_Eng_count<- length(Bayes_2010_Eng) 

Bayes_2010_Soc<- Bayes_2010[grep("^/Social sciences",Bayes_2010[,1]),2]

Bayes_2010_Soc_count<- length(Bayes_2010_Soc)

###2011 Bayes

Bayes_2011<- Bayes_search_clean[grep("^2011",Bayes_search_clean[,2]),]


Bayes_2011_Bio<- Bayes_2011[grep("^/Biology and life sciences",Bayes_2011[,1]),2]

Bayes_2011_Bio_count<- length(Bayes_2011_Bio)

Bayes_2011_Phys<- Bayes_2011[grep("^/Physical sciences",Bayes_2011[,1]),2]

Bayes_2011_Phys_count<- length(Bayes_2011_Phys) 

Bayes_2011_Med<- Bayes_2011[grep("^/Medicine and health sciences",Bayes_2011[,1]),2]

Bayes_2011_Med_count<- length(Bayes_2011_Med) 

Bayes_2011_Res<- Bayes_2011[grep("^/Research and analysis methods",Bayes_2011[,1]),2]

Bayes_2011_Res_count<- length(Bayes_2011_Res) 

Bayes_2011_Earth<- Bayes_2011[grep("^/Earth sciences",Bayes_2011[,1]),2]

Bayes_2011_Earth_count<- length(Bayes_2011_Earth) 

Bayes_2011_Comp<- Bayes_2011[grep("^/Computer and information sciences",Bayes_2011[,1]),2]

Bayes_2011_Comp_count<- length(Bayes_2011_Comp) 

Bayes_2011_Eng<- Bayes_2011[grep("^/Engineering and technology",Bayes_2011[,1]),2]

Bayes_2011_Eng_count<- length(Bayes_2011_Eng) 

Bayes_2011_Soc<- Bayes_2011[grep("^/Social sciences",Bayes_2011[,1]),2]

Bayes_2011_Soc_count<- length(Bayes_2011_Soc)

###Bayes 2012
Bayes_2012<- Bayes_search_clean[grep("^2012",Bayes_search_clean[,2]),]


Bayes_2012_Bio<- Bayes_2012[grep("^/Biology and life sciences",Bayes_2012[,1]),2]

Bayes_2012_Bio_count<- length(Bayes_2012_Bio)

Bayes_2012_Phys<- Bayes_2012[grep("^/Physical sciences",Bayes_2012[,1]),2]

Bayes_2012_Phys_count<- length(Bayes_2012_Phys) 

Bayes_2012_Med<- Bayes_2012[grep("^/Medicine and health sciences",Bayes_2012[,1]),2]

Bayes_2012_Med_count<- length(Bayes_2012_Med) 

Bayes_2012_Res<- Bayes_2012[grep("^/Research and analysis methods",Bayes_2012[,1]),2]

Bayes_2012_Res_count<- length(Bayes_2012_Res) 

Bayes_2012_Earth<- Bayes_2012[grep("^/Earth sciences",Bayes_2012[,1]),2]

Bayes_2012_Earth_count<- length(Bayes_2012_Earth) 

Bayes_2012_Comp<- Bayes_2012[grep("^/Computer and information sciences",Bayes_2012[,1]),2]

Bayes_2012_Comp_count<- length(Bayes_2012_Comp) 

Bayes_2012_Eng<- Bayes_2012[grep("^/Engineering and technology",Bayes_2012[,1]),2]

Bayes_2012_Eng_count<- length(Bayes_2012_Eng) 

Bayes_2012_Soc<- Bayes_2012[grep("^/Social sciences",Bayes_2012[,1]),2]

Bayes_2012_Soc_count<- length(Bayes_2012_Soc)

##Bayes 2013

Bayes_2013<- Bayes_search_clean[grep("^2013",Bayes_search_clean[,2]),]

Bayes_2013_Bio<- Bayes_2013[grep("^/Biology and life sciences",Bayes_2013[,1]),2]

Bayes_2013_Bio_count<- length(Bayes_2013_Bio)

Bayes_2013_Phys<- Bayes_2013[grep("^/Physical sciences",Bayes_2013[,1]),2]

Bayes_2013_Phys_count<- length(Bayes_2013_Phys) 

Bayes_2013_Med<- Bayes_2013[grep("^/Medicine and health sciences",Bayes_2013[,1]),2]

Bayes_2013_Med_count<- length(Bayes_2013_Med) 

Bayes_2013_Res<- Bayes_2013[grep("^/Research and analysis methods",Bayes_2013[,1]),2]

Bayes_2013_Res_count<- length(Bayes_2013_Res) 

Bayes_2013_Earth<- Bayes_2013[grep("^/Earth sciences",Bayes_2013[,1]),2]

Bayes_2013_Earth_count<- length(Bayes_2013_Earth) 

Bayes_2013_Comp<- Bayes_2013[grep("^/Computer and information sciences",Bayes_2013[,1]),2]

Bayes_2013_Comp_count<- length(Bayes_2013_Comp) 

Bayes_2013_Eng<- Bayes_2013[grep("^/Engineering and technology",Bayes_2013[,1]),2]

Bayes_2013_Eng_count<- length(Bayes_2013_Eng) 

Bayes_2013_Soc<- Bayes_2013[grep("^/Social sciences",Bayes_2013[,1]),2]

Bayes_2013_Soc_count<- length(Bayes_2013_Soc)

###Bayes 2014

Bayes_2014<- Bayes_search_clean[grep("^2014",Bayes_search_clean[,2]),]


Bayes_2014_Bio<- Bayes_2014[grep("^/Biology and life sciences",Bayes_2014[,1]),2]

Bayes_2014_Bio_count<- length(Bayes_2014_Bio)

Bayes_2014_Phys<- Bayes_2014[grep("^/Physical sciences",Bayes_2014[,1]),2]

Bayes_2014_Phys_count<- length(Bayes_2014_Phys) 

Bayes_2014_Med<- Bayes_2014[grep("^/Medicine and health sciences",Bayes_2014[,1]),2]

Bayes_2014_Med_count<- length(Bayes_2014_Med) 

Bayes_2014_Res<- Bayes_2014[grep("^/Research and analysis methods",Bayes_2014[,1]),2]

Bayes_2014_Res_count<- length(Bayes_2014_Res) 

Bayes_2014_Earth<- Bayes_2014[grep("^/Earth sciences",Bayes_2014[,1]),2]

Bayes_2014_Earth_count<- length(Bayes_2014_Earth) 

Bayes_2014_Comp<- Bayes_2014[grep("^/Computer and information sciences",Bayes_2014[,1]),2]

Bayes_2014_Comp_count<- length(Bayes_2014_Comp) 

Bayes_2014_Eng<- Bayes_2014[grep("^/Engineering and technology",Bayes_2014[,1]),2]

Bayes_2014_Eng_count<- length(Bayes_2014_Eng) 

Bayes_2014_Soc<- Bayes_2014[grep("^/Social sciences",Bayes_2014[,1]),2]

Bayes_2014_Soc_count<- length(Bayes_2014_Soc)

### Bayes 2015

Bayes_2015<- Bayes_search_clean[grep("^2015",Bayes_search_clean[,2]),]


Bayes_2015_Bio<- Bayes_2015[grep("^/Biology and life sciences",Bayes_2015[,1]),2]

Bayes_2015_Bio_count<- length(Bayes_2015_Bio)

Bayes_2015_Phys<- Bayes_2015[grep("^/Physical sciences",Bayes_2015[,1]),2]

Bayes_2015_Phys_count<- length(Bayes_2015_Phys) 

Bayes_2015_Med<- Bayes_2015[grep("^/Medicine and health sciences",Bayes_2015[,1]),2]

Bayes_2015_Med_count<- length(Bayes_2015_Med) 

Bayes_2015_Res<- Bayes_2015[grep("^/Research and analysis methods",Bayes_2015[,1]),2]

Bayes_2015_Res_count<- length(Bayes_2015_Res) 

Bayes_2015_Earth<- Bayes_2015[grep("^/Earth sciences",Bayes_2015[,1]),2]

Bayes_2015_Earth_count<- length(Bayes_2015_Earth) 

Bayes_2015_Comp<- Bayes_2015[grep("^/Computer and information sciences",Bayes_2015[,1]),2]

Bayes_2015_Comp_count<- length(Bayes_2015_Comp) 

Bayes_2015_Eng<- Bayes_2015[grep("^/Engineering and technology",Bayes_2015[,1]),2]

Bayes_2015_Eng_count<- length(Bayes_2015_Eng) 

Bayes_2015_Soc<- Bayes_2015[grep("^/Social sciences",Bayes_2015[,1]),2]

Bayes_2015_Soc_count<- length(Bayes_2015_Soc)

##Bayes 2016

Bayes_2016<- Bayes_search_clean[grep("^2016",Bayes_search_clean[,2]),]

Bayes_2016_Bio<- Bayes_2016[grep("^/Biology and life sciences",Bayes_2016[,1]),2]

Bayes_2016_Bio_count<- length(Bayes_2016_Bio)

Bayes_2016_Phys<- Bayes_2016[grep("^/Physical sciences",Bayes_2016[,1]),2]

Bayes_2016_Phys_count<- length(Bayes_2016_Phys) 

Bayes_2016_Med<- Bayes_2016[grep("^/Medicine and health sciences",Bayes_2016[,1]),2]

Bayes_2016_Med_count<- length(Bayes_2016_Med) 

Bayes_2016_Res<- Bayes_2016[grep("^/Research and analysis methods",Bayes_2016[,1]),2]

Bayes_2016_Res_count<- length(Bayes_2016_Res) 

Bayes_2016_Earth<- Bayes_2016[grep("^/Earth sciences",Bayes_2016[,1]),2]

Bayes_2016_Earth_count<- length(Bayes_2016_Earth) 

Bayes_2016_Comp<- Bayes_2016[grep("^/Computer and information sciences",Bayes_2016[,1]),2]

Bayes_2016_Comp_count<- length(Bayes_2016_Comp) 

Bayes_2016_Eng<- Bayes_2016[grep("^/Engineering and technology",Bayes_2016[,1]),2]

Bayes_2016_Eng_count<- length(Bayes_2016_Eng) 

Bayes_2016_Soc<- Bayes_2016[grep("^/Social sciences",Bayes_2016[,1]),2]

Bayes_2016_Soc_count<- length(Bayes_2016_Soc)

## Bayes 2017

Bayes_2017<- Bayes_search_clean[grep("^2017",Bayes_search_clean[,2]),]


Bayes_2017_Bio<- Bayes_2017[grep("^/Biology and life sciences",Bayes_2017[,1]),2]

Bayes_2017_Bio_count<- length(Bayes_2017_Bio)

Bayes_2017_Phys<- Bayes_2017[grep("^/Physical sciences",Bayes_2017[,1]),2]

Bayes_2017_Phys_count<- length(Bayes_2017_Phys) 

Bayes_2017_Med<- Bayes_2017[grep("^/Medicine and health sciences",Bayes_2017[,1]),2]

Bayes_2017_Med_count<- length(Bayes_2017_Med) 

Bayes_2017_Res<- Bayes_2017[grep("^/Research and analysis methods",Bayes_2017[,1]),2]

Bayes_2017_Res_count<- length(Bayes_2017_Res) 

Bayes_2017_Earth<- Bayes_2017[grep("^/Earth sciences",Bayes_2017[,1]),2]

Bayes_2017_Earth_count<- length(Bayes_2017_Earth) 

Bayes_2017_Comp<- Bayes_2017[grep("^/Computer and information sciences",Bayes_2017[,1]),2]

Bayes_2017_Comp_count<- length(Bayes_2017_Comp) 

Bayes_2017_Eng<- Bayes_2017[grep("^/Engineering and technology",Bayes_2017[,1]),2]

Bayes_2017_Eng_count<- length(Bayes_2017_Eng) 

Bayes_2017_Soc<- Bayes_2017[grep("^/Social sciences",Bayes_2017[,1]),2]

Bayes_2017_Soc_count<- length(Bayes_2017_Soc)


#### Bayes counts table

subjects<- c("Biology and life sciences","Physical sciences","Medicine and health sciences", "Research and analysis", "Earth Sciences","Computer and information sciences", "Engineering and technology", "Social sciences")


Bayes_counts_2004_bio<- c(Bayes_2004_Bio_count,1,rep(0,13),1,rep(0,7))
Bayes_counts_2004_Comp<- c(Bayes_2004_Comp_count,1,rep(0,13),0,1,rep(0,6))
Bayes_counts_2004_Earth<-c(Bayes_2004_Earth_count,1,rep(0,13),0,0,1,rep(0,5))
Bayes_counts_2004_Eng<- c(Bayes_2004_Eng_count,1,rep(0,13),0,0,0,1,rep(0,4))
Bayes_counts_2004_Med<- c(Bayes_2004_Med_count,1,rep(0,13),rep(0,4),1,0,0,0)
Bayes_counts_2004_Phys<- c(Bayes_2004_Phys_count,1,rep(0,13),rep(0,5),1,0,0)
Bayes_count_2004_Res<-c(Bayes_2004_Res_count,1,rep(0,13),rep(0,6),1,0)
Bayes_count_2004_Soc<-c(Bayes_2004_Soc_count,1,rep(0,13),rep(0,7),1)

Bayes_counts_2005_bio<- c(Bayes_2005_Bio_count,0,1,rep(0,12),1,rep(0,7))
Bayes_counts_2005_Comp<- c(Bayes_2005_Comp_count,0,1,rep(0,12),0,1,rep(0,6))
Bayes_counts_2005_Earth<-c(Bayes_2005_Earth_count,0,1,rep(0,12),0,0,1,rep(0,5))
Bayes_counts_2005_Eng<- c(Bayes_2005_Eng_count,0,1,rep(0,12),0,0,0,1,rep(0,4))
Bayes_counts_2005_Med<- c(Bayes_2005_Med_count,0,1,rep(0,12),rep(0,4),1,0,0,0)
Bayes_counts_2005_Phys<- c(Bayes_2005_Phys_count,0,1,rep(0,12),rep(0,5),1,0,0)
Bayes_count_2005_Res<-c(Bayes_2005_Res_count,0,1,rep(0,12),rep(0,6),1,0)
Bayes_count_2005_Soc<-c(Bayes_2005_Soc_count,0,1,rep(0,12),rep(0,7),1)

Bayes_counts_2006_bio<- c(Bayes_2006_Bio_count,0,0,1,rep(0,11),1,rep(0,7))
Bayes_counts_2006_Comp<- c(Bayes_2006_Comp_count,0,0,1,rep(0,11),0,1,rep(0,6))
Bayes_counts_2006_Earth<-c(Bayes_2006_Earth_count,0,0,1,rep(0,11),0,0,1,rep(0,5))
Bayes_counts_2006_Eng<- c(Bayes_2006_Eng_count,0,0,1,rep(0,11),0,0,0,1,rep(0,4))
Bayes_counts_2006_Med<- c(Bayes_2006_Med_count,0,0,1,rep(0,11),rep(0,4),1,0,0,0)
Bayes_counts_2006_Phys<- c(Bayes_2006_Phys_count,0,0,1,rep(0,11),rep(0,5),1,0,0)
Bayes_count_2006_Res<-c(Bayes_2006_Res_count,0,0,1,rep(0,11),rep(0,6),1,0)
Bayes_count_2006_Soc<-c(Bayes_2006_Soc_count,0,0,1,rep(0,11),rep(0,7),1)

Bayes_counts_2007_bio<- c(Bayes_2007_Bio_count,0,0,0,1,rep(0,10),1,rep(0,7))
Bayes_counts_2007_Comp<- c(Bayes_2007_Comp_count,0,0,0,1,rep(0,10),0,1,rep(0,6))
Bayes_counts_2007_Earth<-c(Bayes_2007_Earth_count,0,0,0,1,rep(0,10),0,0,1,rep(0,5))
Bayes_counts_2007_Eng<- c(Bayes_2007_Eng_count,0,0,0,1,rep(0,10),0,0,0,1,rep(0,4))
Bayes_counts_2007_Med<- c(Bayes_2007_Med_count,0,0,0,1,rep(0,10),rep(0,4),1,0,0,0)
Bayes_counts_2007_Phys<- c(Bayes_2007_Phys_count,0,0,0,1,rep(0,10),rep(0,5),1,0,0)
Bayes_count_2007_Res<-c(Bayes_2007_Res_count,0,0,0,1,rep(0,10),rep(0,6),1,0)
Bayes_count_2007_Soc<-c(Bayes_2007_Soc_count,0,0,0,1,rep(0,10),rep(0,7),1)

Bayes_counts_2008_bio<- c(Bayes_2008_Bio_count,rep(0,4),1,rep(0,9),1,rep(0,7))
Bayes_counts_2008_Comp<- c(Bayes_2008_Comp_count,rep(0,4),1,rep(0,9),0,1,rep(0,6))
Bayes_counts_2008_Earth<-c(Bayes_2008_Earth_count,rep(0,4),1,rep(0,9),0,0,1,rep(0,5))
Bayes_counts_2008_Eng<- c(Bayes_2008_Eng_count,rep(0,4),1,rep(0,9),0,0,0,1,rep(0,4))
Bayes_counts_2008_Med<- c(Bayes_2008_Med_count,rep(0,4),1,rep(0,9),rep(0,4),1,0,0,0)
Bayes_counts_2008_Phys<- c(Bayes_2008_Phys_count,rep(0,4),1,rep(0,9),rep(0,5),1,0,0)
Bayes_count_2008_Res<-c(Bayes_2008_Res_count,rep(0,4),1,rep(0,9),rep(0,6),1,0)
Bayes_count_2008_Soc<-c(Bayes_2008_Soc_count,rep(0,4),1,rep(0,9),rep(0,7),1)


Bayes_counts_2009_bio<- c(Bayes_2009_Bio_count,rep(0,5),1,rep(0,8),1,rep(0,7))
Bayes_counts_2009_Comp<- c(Bayes_2009_Comp_count,rep(0,5),1,rep(0,8),0,1,rep(0,6))
Bayes_counts_2009_Earth<-c(Bayes_2009_Earth_count,rep(0,5),1,rep(0,8),0,0,1,rep(0,5))
Bayes_counts_2009_Eng<- c(Bayes_2009_Eng_count,rep(0,5),1,rep(0,8),0,0,0,1,rep(0,4))
Bayes_counts_2009_Med<- c(Bayes_2009_Med_count,rep(0,5),1,rep(0,8),rep(0,4),1,0,0,0)
Bayes_counts_2009_Phys<- c(Bayes_2009_Phys_count,rep(0,5),1,rep(0,8),rep(0,5),1,0,0)
Bayes_count_2009_Res<-c(Bayes_2009_Res_count,rep(0,5),1,rep(0,8),rep(0,6),1,0)
Bayes_count_2009_Soc<-c(Bayes_2009_Soc_count,rep(0,5),1,rep(0,8),rep(0,7),1)

Bayes_counts_2010_bio<- c(Bayes_2010_Bio_count,rep(0,6),1,rep(0,7),1,rep(0,7))
Bayes_counts_2010_Comp<- c(Bayes_2010_Comp_count,rep(0,6),1,rep(0,7),0,1,rep(0,6))
Bayes_counts_2010_Earth<-c(Bayes_2010_Earth_count,rep(0,6),1,rep(0,7),0,0,1,rep(0,5))
Bayes_counts_2010_Eng<- c(Bayes_2010_Eng_count,rep(0,6),1,rep(0,7),0,0,0,1,rep(0,4))
Bayes_counts_2010_Med<- c(Bayes_2010_Med_count,rep(0,6),1,rep(0,7),rep(0,4),1,0,0,0)
Bayes_counts_2010_Phys<- c(Bayes_2010_Phys_count,rep(0,6),1,rep(0,7),rep(0,5),1,0,0)
Bayes_count_2010_Res<-c(Bayes_2010_Res_count,rep(0,6),1,rep(0,7),rep(0,6),1,0)
Bayes_count_2010_Soc<-c(Bayes_2010_Soc_count,rep(0,6),1,rep(0,7),rep(0,7),1)


Bayes_counts_2011_bio<- c(Bayes_2011_Bio_count,rep(0,7),1,rep(0,6),1,rep(0,7))
Bayes_counts_2011_Comp<- c(Bayes_2011_Comp_count,rep(0,7),1,rep(0,6),0,1,rep(0,6))
Bayes_counts_2011_Earth<-c(Bayes_2011_Earth_count,rep(0,7),1,rep(0,6),0,0,1,rep(0,5))
Bayes_counts_2011_Eng<- c(Bayes_2011_Eng_count,rep(0,7),1,rep(0,6),0,0,0,1,rep(0,4))
Bayes_counts_2011_Med<- c(Bayes_2011_Med_count,rep(0,7),1,rep(0,6),rep(0,4),1,0,0,0)
Bayes_counts_2011_Phys<- c(Bayes_2011_Phys_count,rep(0,7),1,rep(0,6),rep(0,5),1,0,0)
Bayes_count_2011_Res<-c(Bayes_2011_Res_count,rep(0,7),1,rep(0,6),rep(0,6),1,0)
Bayes_count_2011_Soc<-c(Bayes_2011_Soc_count,rep(0,7),1,rep(0,6),rep(0,7),1)

Bayes_counts_2012_bio<- c(Bayes_2012_Bio_count,rep(0,8),1,rep(0,5),1,rep(0,7))
Bayes_counts_2012_Comp<- c(Bayes_2012_Comp_count,rep(0,8),1,rep(0,5),0,1,rep(0,6))
Bayes_counts_2012_Earth<-c(Bayes_2012_Earth_count,rep(0,8),1,rep(0,5),0,0,1,rep(0,5))
Bayes_counts_2012_Eng<- c(Bayes_2012_Eng_count,rep(0,8),1,rep(0,5),0,0,0,1,rep(0,4))
Bayes_counts_2012_Med<- c(Bayes_2012_Med_count,rep(0,8),1,rep(0,5),rep(0,4),1,0,0,0)
Bayes_counts_2012_Phys<- c(Bayes_2012_Phys_count,rep(0,8),1,rep(0,5),rep(0,5),1,0,0)
Bayes_count_2012_Res<-c(Bayes_2012_Res_count,rep(0,8),1,rep(0,5),rep(0,6),1,0)
Bayes_count_2012_Soc<-c(Bayes_2012_Soc_count,rep(0,8),1,rep(0,5),rep(0,7),1)

Bayes_counts_2013_bio<- c(Bayes_2013_Bio_count,rep(0,9),1,rep(0,4),1,rep(0,7))
Bayes_counts_2013_Comp<- c(Bayes_2013_Comp_count,rep(0,9),1,rep(0,4),0,1,rep(0,6))
Bayes_counts_2013_Earth<-c(Bayes_2013_Earth_count,rep(0,9),1,rep(0,4),0,0,1,rep(0,5))
Bayes_counts_2013_Eng<- c(Bayes_2013_Eng_count,rep(0,9),1,rep(0,4),0,0,0,1,rep(0,4))
Bayes_counts_2013_Med<- c(Bayes_2013_Med_count,rep(0,9),1,rep(0,4),rep(0,4),1,0,0,0)
Bayes_counts_2013_Phys<- c(Bayes_2013_Phys_count,rep(0,9),1,rep(0,4),rep(0,5),1,0,0)
Bayes_count_2013_Res<-c(Bayes_2013_Res_count,rep(0,9),1,rep(0,4),rep(0,6),1,0)
Bayes_count_2013_Soc<-c(Bayes_2013_Soc_count,rep(0,9),1,rep(0,4),rep(0,7),1)

Bayes_counts_2014_bio<- c(Bayes_2014_Bio_count,rep(0,10),1,rep(0,3),1,rep(0,7))
Bayes_counts_2014_Comp<- c(Bayes_2014_Comp_count,rep(0,10),1,rep(0,3),0,1,rep(0,6))
Bayes_counts_2014_Earth<-c(Bayes_2014_Earth_count,rep(0,10),1,rep(0,3),0,0,1,rep(0,5))
Bayes_counts_2014_Eng<- c(Bayes_2014_Eng_count,rep(0,10),1,rep(0,3),0,0,0,1,rep(0,4))
Bayes_counts_2014_Med<- c(Bayes_2014_Med_count,rep(0,10),1,rep(0,3),rep(0,4),1,0,0,0)
Bayes_counts_2014_Phys<- c(Bayes_2014_Phys_count,rep(0,10),1,rep(0,3),rep(0,5),1,0,0)
Bayes_count_2014_Res<-c(Bayes_2014_Res_count,rep(0,10),1,rep(0,3),rep(0,6),1,0)
Bayes_count_2014_Soc<-c(Bayes_2014_Soc_count,rep(0,10),1,rep(0,3),rep(0,7),1)

Bayes_counts_2015_bio<- c(Bayes_2015_Bio_count,rep(0,11),1,rep(0,2),1,rep(0,7))
Bayes_counts_2015_Comp<- c(Bayes_2015_Comp_count,rep(0,11),1,rep(0,2),0,1,rep(0,6))
Bayes_counts_2015_Earth<-c(Bayes_2015_Earth_count,rep(0,11),1,rep(0,2),0,0,1,rep(0,5))
Bayes_counts_2015_Eng<- c(Bayes_2015_Eng_count,rep(0,11),1,rep(0,2),0,0,0,1,rep(0,4))
Bayes_counts_2015_Med<- c(Bayes_2015_Med_count,rep(0,11),1,rep(0,2),rep(0,4),1,0,0,0)
Bayes_counts_2015_Phys<- c(Bayes_2015_Phys_count,rep(0,11),1,rep(0,2),rep(0,5),1,0,0)
Bayes_count_2015_Res<-c(Bayes_2015_Res_count,rep(0,11),1,rep(0,2),rep(0,6),1,0)
Bayes_count_2015_Soc<-c(Bayes_2015_Soc_count,rep(0,11),1,rep(0,2),rep(0,7),1)

Bayes_counts_2016_bio<- c(Bayes_2016_Bio_count,rep(0,12),1,rep(0,1),1,rep(0,7))
Bayes_counts_2016_Comp<- c(Bayes_2016_Comp_count,rep(0,12),1,rep(0,1),0,1,rep(0,6))
Bayes_counts_2016_Earth<-c(Bayes_2016_Earth_count,rep(0,12),1,rep(0,1),0,0,1,rep(0,5))
Bayes_counts_2016_Eng<- c(Bayes_2016_Eng_count,rep(0,12),1,rep(0,1),0,0,0,1,rep(0,4))
Bayes_counts_2016_Med<- c(Bayes_2016_Med_count,rep(0,12),1,rep(0,1),rep(0,4),1,0,0,0)
Bayes_counts_2016_Phys<- c(Bayes_2016_Phys_count,rep(0,12),1,rep(0,1),rep(0,5),1,0,0)
Bayes_count_2016_Res<-c(Bayes_2016_Res_count,rep(0,12),1,rep(0,1),rep(0,6),1,0)
Bayes_count_2016_Soc<-c(Bayes_2016_Soc_count,rep(0,12),1,rep(0,1),rep(0,7),1)

Bayes_counts_2017_bio<- c(Bayes_2017_Bio_count,rep(0,13),1,1,rep(0,7))
Bayes_counts_2017_Comp<- c(Bayes_2017_Comp_count,rep(0,13),1,0,1,rep(0,6))
Bayes_counts_2017_Earth<-c(Bayes_2017_Earth_count,rep(0,13),1,0,0,1,rep(0,5))
Bayes_counts_2017_Eng<- c(Bayes_2017_Eng_count,rep(0,13),1,0,0,0,1,rep(0,4))
Bayes_counts_2017_Med<- c(Bayes_2017_Med_count,rep(0,13),1,rep(0,4),1,0,0,0)
Bayes_counts_2017_Phys<- c(Bayes_2017_Phys_count,rep(0,13),1,rep(0,5),1,0,0)
Bayes_count_2017_Res<-c(Bayes_2017_Res_count,rep(0,13),1,rep(0,6),1,0)
Bayes_count_2017_Soc<-c(Bayes_2017_Soc_count,rep(0,13),1,rep(0,7),1)

Bayes_table<- rbind(Bayes_counts_2004_bio,Bayes_counts_2004_Comp,Bayes_counts_2004_Earth,
                    Bayes_counts_2004_Eng,Bayes_counts_2004_Med,Bayes_counts_2004_Phys,
                    Bayes_count_2004_Res,Bayes_count_2004_Soc,Bayes_counts_2005_bio,
                    Bayes_counts_2005_Comp,Bayes_counts_2005_Earth,Bayes_counts_2005_Eng,
                    Bayes_counts_2005_Med,Bayes_counts_2005_Phys,Bayes_count_2005_Res,
                    Bayes_count_2005_Soc,Bayes_counts_2006_bio,
                    Bayes_counts_2006_Comp,Bayes_counts_2006_Earth,Bayes_counts_2006_Eng,
                    Bayes_counts_2006_Med,Bayes_counts_2006_Phys,Bayes_count_2006_Res,
                    Bayes_count_2006_Soc,Bayes_counts_2007_bio,
                    Bayes_counts_2007_Comp,Bayes_counts_2007_Earth,Bayes_counts_2007_Eng,
                    Bayes_counts_2007_Med,Bayes_counts_2007_Phys,Bayes_count_2007_Res,
                    Bayes_count_2007_Soc, Bayes_counts_2008_bio,
                    Bayes_counts_2008_Comp,Bayes_counts_2008_Earth,Bayes_counts_2008_Eng,
                    Bayes_counts_2008_Med,Bayes_counts_2008_Phys,Bayes_count_2008_Res,
                    Bayes_count_2008_Soc, Bayes_counts_2009_bio,
                    Bayes_counts_2009_Comp,Bayes_counts_2009_Earth,Bayes_counts_2009_Eng,
                    Bayes_counts_2009_Med,Bayes_counts_2009_Phys,Bayes_count_2009_Res,
                    Bayes_count_2009_Soc,Bayes_counts_2010_bio,
                    Bayes_counts_2010_Comp,Bayes_counts_2010_Earth,Bayes_counts_2010_Eng,
                    Bayes_counts_2010_Med,Bayes_counts_2010_Phys,Bayes_count_2010_Res,
                    Bayes_count_2010_Soc,Bayes_counts_2011_bio,
                    Bayes_counts_2011_Comp,Bayes_counts_2011_Earth,Bayes_counts_2011_Eng,
                    Bayes_counts_2011_Med,Bayes_counts_2011_Phys,Bayes_count_2011_Res,
                    Bayes_count_2011_Soc,Bayes_counts_2012_bio,
                    Bayes_counts_2012_Comp,Bayes_counts_2012_Earth,Bayes_counts_2012_Eng,
                    Bayes_counts_2012_Med,Bayes_counts_2012_Phys,Bayes_count_2012_Res,
                    Bayes_count_2012_Soc, Bayes_counts_2013_bio,
                    Bayes_counts_2013_Comp,Bayes_counts_2013_Earth,Bayes_counts_2013_Eng,
                    Bayes_counts_2013_Med,Bayes_counts_2013_Phys,Bayes_count_2013_Res,
                    Bayes_count_2013_Soc, Bayes_counts_2014_bio,
                    Bayes_counts_2014_Comp,Bayes_counts_2014_Earth,Bayes_counts_2014_Eng,
                    Bayes_counts_2014_Med,Bayes_counts_2014_Phys,Bayes_count_2014_Res,
                    Bayes_count_2014_Soc,Bayes_counts_2015_bio,
                    Bayes_counts_2015_Comp,Bayes_counts_2015_Earth,Bayes_counts_2015_Eng,
                    Bayes_counts_2015_Med,Bayes_counts_2015_Phys,Bayes_count_2015_Res,
                    Bayes_count_2015_Soc,Bayes_counts_2016_bio,
                    Bayes_counts_2016_Comp,Bayes_counts_2016_Earth,Bayes_counts_2016_Eng,
                    Bayes_counts_2016_Med,Bayes_counts_2016_Phys,Bayes_count_2016_Res,
                    Bayes_count_2016_Soc, Bayes_counts_2017_bio,
                    Bayes_counts_2017_Comp,Bayes_counts_2017_Earth,Bayes_counts_2017_Eng,
                    Bayes_counts_2017_Med,Bayes_counts_2017_Phys,Bayes_count_2017_Res,
                    Bayes_count_2017_Soc)

Bayes_table[97:112,]
as.data.frame(Bayes_table)

colnames(Bayes_table)<- c("Bayes_counts","2004","2005","2006","2007","2008","2009",
                          "2010","2011","2012","2013","2014","2015","2016","2017",
                          "Biology and life sciences","Computer and information sciences",
                          "Earth sciences","Engineering and tecnhology",
                          "Medicine and health sciences","Physical sciences",
                          "Research and analysis","Social Sciences")

as.numeric(Bayes_table[,1])

year_covs<- Bayes_table[,2:15]

terms_covs<- Bayes_table[,16:23]

########### Bayes model fit #################

model_Bayes<- glm(Bayes_table[,1]~year_covs*terms_covs, family="poisson")

summary(model_Bayes)

############################Linear Regression Counts Assembly ###################

LR_search<- searchplos(q="linear regression", fl=c("subject","publication_date"),limit=10000)


LR_search_clean<- matrix(unlist(LR_search[[2]]),ncol=2)




###LR 2004
LR_2004<- LR_search_clean[grep("^2004",LR_search_clean[,2]),]


LR_2004_Bio<- LR_2004[grep("^/Biology and life sciences",LR_2004[,1]),2]

LR_2004_Bio_count<- length(LR_2004_Bio)

LR_2004_Phys<- LR_2004[grep("^/Physical sciences",LR_2004[,1]),2]

LR_2004_Phys_count<- length(LR_2004_Phys) 

LR_2004_Med<- LR_2004[grep("^/Medicine and health sciences",LR_2004[,1]),2]

LR_2004_Med_count<- length(LR_2004_Med) 

LR_2004_Res<- LR_2004[grep("^/Research and analysis methods",LR_2004[,1]),2]

LR_2004_Res_count<- length(LR_2004_Res) 

LR_2004_Earth<- LR_2004[grep("^/Earth sciences",LR_2004[,1]),2]

LR_2004_Earth_count<- length(LR_2004_Earth) 

LR_2004_Comp<- LR_2004[grep("^/Computer and information sciences",LR_2004[,1]),2]

LR_2004_Comp_count<- length(LR_2004_Comp) 

LR_2004_Eng<- LR_2004[grep("^/Engineering and technology",LR_2004[,1]),2]

LR_2004_Eng_count<- length(LR_2004_Eng) 

LR_2004_Soc<- LR_2004[grep("^/Social sciences",LR_2004[,1]),2]

LR_2004_Soc_count<- length(LR_2004_Soc) 


########LR 2005

LR_2005<- LR_search_clean[grep("^2005",LR_search_clean[,2]),]

LR_2005_Bio<- LR_2005[grep("^/Biology and life sciences",LR_2005[,1]),2]

LR_2005_Bio_count<- length(LR_2005_Bio)

LR_2005_Phys<- LR_2005[grep("^/Physical sciences",LR_2005[,1]),2]

LR_2005_Phys_count<- length(LR_2005_Phys) 

LR_2005_Med<- LR_2005[grep("^/Medicine and health sciences",LR_2005[,1]),2]

LR_2005_Med_count<- length(LR_2005_Med) 

LR_2005_Res<- LR_2005[grep("^/Research and analysis methods",LR_2005[,1]),2]

LR_2005_Res_count<- length(LR_2005_Res) 

LR_2005_Earth<- LR_2005[grep("^/Earth sciences",LR_2005[,1]),2]

LR_2005_Earth_count<- length(LR_2005_Earth) 

LR_2005_Comp<- LR_2005[grep("^/Computer and information sciences",LR_2005[,1]),2]

LR_2005_Comp_count<- length(LR_2005_Comp) 

LR_2005_Eng<- LR_2005[grep("^/Engineering and technology",LR_2005[,1]),2]

LR_2005_Eng_count<- length(LR_2005_Eng) 

LR_2005_Soc<- LR_2005[grep("^/Social sciences",LR_2005[,1]),2]

LR_2005_Soc_count<- length(LR_2005_Soc) 


###### LR 2006


LR_2006<- LR_search_clean[grep("^2006",LR_search_clean[,2]),]


LR_2006_Bio<- LR_2006[grep("^/Biology and life sciences",LR_2006[,1]),2]

LR_2006_Bio_count<- length(LR_2006_Bio)

LR_2006_Phys<- LR_2006[grep("^/Physical sciences",LR_2006[,1]),2]

LR_2006_Phys_count<- length(LR_2006_Phys) 

LR_2006_Med<- LR_2006[grep("^/Medicine and health sciences",LR_2006[,1]),2]

LR_2006_Med_count<- length(LR_2006_Med) 

LR_2006_Res<- LR_2006[grep("^/Research and analysis methods",LR_2006[,1]),2]

LR_2006_Res_count<- length(LR_2006_Res) 

LR_2006_Earth<- LR_2006[grep("^/Earth sciences",LR_2006[,1]),2]

LR_2006_Earth_count<- length(LR_2006_Earth) 

LR_2006_Comp<- LR_2006[grep("^/Computer and information sciences",LR_2006[,1]),2]

LR_2006_Comp_count<- length(LR_2006_Comp) 

LR_2006_Eng<- LR_2006[grep("^/Engineering and technology",LR_2006[,1]),2]

LR_2006_Eng_count<- length(LR_2006_Eng) 

LR_2006_Soc<- LR_2006[grep("^/Social sciences",LR_2006[,1]),2]

LR_2006_Soc_count<- length(LR_2006_Soc) 

## LR 2007


LR_2007<- LR_search_clean[grep("^2007",LR_search_clean[,2]),]



LR_2007_Bio<- LR_2007[grep("^/Biology and life sciences",LR_2007[,1]),2]

LR_2007_Bio_count<- length(LR_2007_Bio)

LR_2007_Phys<- LR_2007[grep("^/Physical sciences",LR_2007[,1]),2]

LR_2007_Phys_count<- length(LR_2007_Phys) 

LR_2007_Med<- LR_2007[grep("^/Medicine and health sciences",LR_2007[,1]),2]

LR_2007_Med_count<- length(LR_2007_Med) 

LR_2007_Res<- LR_2007[grep("^/Research and analysis methods",LR_2007[,1]),2]

LR_2007_Res_count<- length(LR_2007_Res) 

LR_2007_Earth<- LR_2007[grep("^/Earth sciences",LR_2007[,1]),2]

LR_2007_Earth_count<- length(LR_2007_Earth) 

LR_2007_Comp<- LR_2007[grep("^/Computer and information sciences",LR_2007[,1]),2]

LR_2007_Comp_count<- length(LR_2007_Comp) 

LR_2007_Eng<- LR_2007[grep("^/Engineering and technology",LR_2007[,1]),2]

LR_2007_Eng_count<- length(LR_2007_Eng) 

LR_2007_Soc<- LR_2007[grep("^/Social sciences",LR_2007[,1]),2]

LR_2007_Soc_count<- length(LR_2007_Soc) 

#### LR 2008
LR_2008<- LR_search_clean[grep("^2008",LR_search_clean[,2]),]


LR_2008_Bio<- LR_2008[grep("^/Biology and life sciences",LR_2008[,1]),2]

LR_2008_Bio_count<- length(LR_2008_Bio)

LR_2008_Phys<- LR_2008[grep("^/Physical sciences",LR_2008[,1]),2]

LR_2008_Phys_count<- length(LR_2008_Phys) 

LR_2008_Med<- LR_2008[grep("^/Medicine and health sciences",LR_2008[,1]),2]

LR_2008_Med_count<- length(LR_2008_Med) 

LR_2008_Res<- LR_2008[grep("^/Research and analysis methods",LR_2008[,1]),2]

LR_2008_Res_count<- length(LR_2008_Res) 

LR_2008_Earth<- LR_2008[grep("^/Earth sciences",LR_2008[,1]),2]

LR_2008_Earth_count<- length(LR_2008_Earth) 

LR_2008_Comp<- LR_2008[grep("^/Computer and information sciences",LR_2008[,1]),2]

LR_2008_Comp_count<- length(LR_2008_Comp) 

LR_2008_Eng<- LR_2008[grep("^/Engineering and technology",LR_2008[,1]),2]

LR_2008_Eng_count<- length(LR_2008_Eng) 

LR_2008_Soc<- LR_2008[grep("^/Social sciences",LR_2008[,1]),2]

LR_2008_Soc_count<- length(LR_2008_Soc) 

##2009

LR_2009<- LR_search_clean[grep("^2009",LR_search_clean[,2]),]


LR_2009_Bio<- LR_2009[grep("^/Biology and life sciences",LR_2009[,1]),2]

LR_2009_Bio_count<- length(LR_2009_Bio)

LR_2009_Phys<- LR_2009[grep("^/Physical sciences",LR_2009[,1]),2]

LR_2009_Phys_count<- length(LR_2009_Phys) 

LR_2009_Med<- LR_2009[grep("^/Medicine and health sciences",LR_2009[,1]),2]

LR_2009_Med_count<- length(LR_2009_Med) 

LR_2009_Res<- LR_2009[grep("^/Research and analysis methods",LR_2009[,1]),2]

LR_2009_Res_count<- length(LR_2009_Res) 

LR_2009_Earth<- LR_2009[grep("^/Earth sciences",LR_2009[,1]),2]

LR_2009_Earth_count<- length(LR_2009_Earth) 

LR_2009_Comp<- LR_2009[grep("^/Computer and information sciences",LR_2009[,1]),2]

LR_2009_Comp_count<- length(LR_2009_Comp) 

LR_2009_Eng<- LR_2009[grep("^/Engineering and technology",LR_2009[,1]),2]

LR_2009_Eng_count<- length(LR_2009_Eng) 

LR_2009_Soc<- LR_2009[grep("^/Social sciences",LR_2009[,1]),2]

LR_2009_Soc_count<- length(LR_2009_Soc)

### LR 2010

LR_2010<- LR_search_clean[grep("^2010",LR_search_clean[,2]),]


LR_2010_Bio<- LR_2010[grep("^/Biology and life sciences",LR_2010[,1]),2]

LR_2010_Bio_count<- length(LR_2010_Bio)

LR_2010_Phys<- LR_2010[grep("^/Physical sciences",LR_2010[,1]),2]

LR_2010_Phys_count<- length(LR_2010_Phys) 

LR_2010_Med<- LR_2010[grep("^/Medicine and health sciences",LR_2010[,1]),2]

LR_2010_Med_count<- length(LR_2010_Med) 

LR_2010_Res<- LR_2010[grep("^/Research and analysis methods",LR_2010[,1]),2]

LR_2010_Res_count<- length(LR_2010_Res) 

LR_2010_Earth<- LR_2010[grep("^/Earth sciences",LR_2010[,1]),2]

LR_2010_Earth_count<- length(LR_2010_Earth) 

LR_2010_Comp<- LR_2010[grep("^/Computer and information sciences",LR_2010[,1]),2]

LR_2010_Comp_count<- length(LR_2010_Comp) 

LR_2010_Eng<- LR_2010[grep("^/Engineering and technology",LR_2010[,1]),2]

LR_2010_Eng_count<- length(LR_2010_Eng) 

LR_2010_Soc<- LR_2010[grep("^/Social sciences",LR_2010[,1]),2]

LR_2010_Soc_count<- length(LR_2010_Soc)

###2011 LR

LR_2011<- LR_search_clean[grep("^2011",LR_search_clean[,2]),]


LR_2011_Bio<- LR_2011[grep("^/Biology and life sciences",LR_2011[,1]),2]

LR_2011_Bio_count<- length(LR_2011_Bio)

LR_2011_Phys<- LR_2011[grep("^/Physical sciences",LR_2011[,1]),2]

LR_2011_Phys_count<- length(LR_2011_Phys) 

LR_2011_Med<- LR_2011[grep("^/Medicine and health sciences",LR_2011[,1]),2]

LR_2011_Med_count<- length(LR_2011_Med) 

LR_2011_Res<- LR_2011[grep("^/Research and analysis methods",LR_2011[,1]),2]

LR_2011_Res_count<- length(LR_2011_Res) 

LR_2011_Earth<- LR_2011[grep("^/Earth sciences",LR_2011[,1]),2]

LR_2011_Earth_count<- length(LR_2011_Earth) 

LR_2011_Comp<- LR_2011[grep("^/Computer and information sciences",LR_2011[,1]),2]

LR_2011_Comp_count<- length(LR_2011_Comp) 

LR_2011_Eng<- LR_2011[grep("^/Engineering and technology",LR_2011[,1]),2]

LR_2011_Eng_count<- length(LR_2011_Eng) 

LR_2011_Soc<- LR_2011[grep("^/Social sciences",LR_2011[,1]),2]

LR_2011_Soc_count<- length(LR_2011_Soc)

###LR 2012
LR_2012<- LR_search_clean[grep("^2012",LR_search_clean[,2]),]

LR_2012_Bio<- LR_2012[grep("^/Biology and life sciences",LR_2012[,1]),2]

LR_2012_Bio_count<- length(LR_2012_Bio)

LR_2012_Phys<- LR_2012[grep("^/Physical sciences",LR_2012[,1]),2]

LR_2012_Phys_count<- length(LR_2012_Phys) 

LR_2012_Med<- LR_2012[grep("^/Medicine and health sciences",LR_2012[,1]),2]

LR_2012_Med_count<- length(LR_2012_Med) 

LR_2012_Res<- LR_2012[grep("^/Research and analysis methods",LR_2012[,1]),2]

LR_2012_Res_count<- length(LR_2012_Res) 

LR_2012_Earth<- LR_2012[grep("^/Earth sciences",LR_2012[,1]),2]

LR_2012_Earth_count<- length(LR_2012_Earth) 

LR_2012_Comp<- LR_2012[grep("^/Computer and information sciences",LR_2012[,1]),2]

LR_2012_Comp_count<- length(LR_2012_Comp) 

LR_2012_Eng<- LR_2012[grep("^/Engineering and technology",LR_2012[,1]),2]

LR_2012_Eng_count<- length(LR_2012_Eng) 

LR_2012_Soc<- LR_2012[grep("^/Social sciences",LR_2012[,1]),2]

LR_2012_Soc_count<- length(LR_2012_Soc)

##LR 2013

LR_2013<- LR_search_clean[grep("^2013",LR_search_clean[,2]),]


LR_2013_Bio<- LR_2013[grep("^/Biology and life sciences",LR_2013[,1]),2]

LR_2013_Bio_count<- length(LR_2013_Bio)

LR_2013_Phys<- LR_2013[grep("^/Physical sciences",LR_2013[,1]),2]

LR_2013_Phys_count<- length(LR_2013_Phys) 

LR_2013_Med<- LR_2013[grep("^/Medicine and health sciences",LR_2013[,1]),2]

LR_2013_Med_count<- length(LR_2013_Med) 

LR_2013_Res<- LR_2013[grep("^/Research and analysis methods",LR_2013[,1]),2]

LR_2013_Res_count<- length(LR_2013_Res) 

LR_2013_Earth<- LR_2013[grep("^/Earth sciences",LR_2013[,1]),2]

LR_2013_Earth_count<- length(LR_2013_Earth) 

LR_2013_Comp<- LR_2013[grep("^/Computer and information sciences",LR_2013[,1]),2]

LR_2013_Comp_count<- length(LR_2013_Comp) 

LR_2013_Eng<- LR_2013[grep("^/Engineering and technology",LR_2013[,1]),2]

LR_2013_Eng_count<- length(LR_2013_Eng) 

LR_2013_Soc<- LR_2013[grep("^/Social sciences",LR_2013[,1]),2]

LR_2013_Soc_count<- length(LR_2013_Soc)

###LR 2014

LR_2014<- LR_search_clean[grep("^2014",LR_search_clean[,2]),]


LR_2014_Bio<- LR_2014[grep("^/Biology and life sciences",LR_2014[,1]),2]

LR_2014_Bio_count<- length(LR_2014_Bio)

LR_2014_Phys<- LR_2014[grep("^/Physical sciences",LR_2014[,1]),2]

LR_2014_Phys_count<- length(LR_2014_Phys) 

LR_2014_Med<- LR_2014[grep("^/Medicine and health sciences",LR_2014[,1]),2]

LR_2014_Med_count<- length(LR_2014_Med) 

LR_2014_Res<- LR_2014[grep("^/Research and analysis methods",LR_2014[,1]),2]

LR_2014_Res_count<- length(LR_2014_Res) 

LR_2014_Earth<- LR_2014[grep("^/Earth sciences",LR_2014[,1]),2]

LR_2014_Earth_count<- length(LR_2014_Earth) 

LR_2014_Comp<- LR_2014[grep("^/Computer and information sciences",LR_2014[,1]),2]

LR_2014_Comp_count<- length(LR_2014_Comp) 

LR_2014_Eng<- LR_2014[grep("^/Engineering and technology",LR_2014[,1]),2]

LR_2014_Eng_count<- length(LR_2014_Eng) 

LR_2014_Soc<- LR_2014[grep("^/Social sciences",LR_2014[,1]),2]

LR_2014_Soc_count<- length(LR_2014_Soc)

### LR 2015

LR_2015<- LR_search_clean[grep("^2015",LR_search_clean[,2]),]


LR_2015_Bio<- LR_2015[grep("^/Biology and life sciences",LR_2015[,1]),2]

LR_2015_Bio_count<- length(LR_2015_Bio)

LR_2015_Phys<- LR_2015[grep("^/Physical sciences",LR_2015[,1]),2]

LR_2015_Phys_count<- length(LR_2015_Phys) 

LR_2015_Med<- LR_2015[grep("^/Medicine and health sciences",LR_2015[,1]),2]

LR_2015_Med_count<- length(LR_2015_Med) 

LR_2015_Res<- LR_2015[grep("^/Research and analysis methods",LR_2015[,1]),2]

LR_2015_Res_count<- length(LR_2015_Res) 

LR_2015_Earth<- LR_2015[grep("^/Earth sciences",LR_2015[,1]),2]

LR_2015_Earth_count<- length(LR_2015_Earth) 

LR_2015_Comp<- LR_2015[grep("^/Computer and information sciences",LR_2015[,1]),2]

LR_2015_Comp_count<- length(LR_2015_Comp) 

LR_2015_Eng<- LR_2015[grep("^/Engineering and technology",LR_2015[,1]),2]

LR_2015_Eng_count<- length(LR_2015_Eng) 

LR_2015_Soc<- LR_2015[grep("^/Social sciences",LR_2015[,1]),2]

LR_2015_Soc_count<- length(LR_2015_Soc)

##LR 2016

LR_2016<- LR_search_clean[grep("^2016",LR_search_clean[,2]),]


LR_2016_Bio<- LR_2016[grep("^/Biology and life sciences",LR_2016[,1]),2]

LR_2016_Bio_count<- length(LR_2016_Bio)

LR_2016_Phys<- LR_2016[grep("^/Physical sciences",LR_2016[,1]),2]

LR_2016_Phys_count<- length(LR_2016_Phys) 

LR_2016_Med<- LR_2016[grep("^/Medicine and health sciences",LR_2016[,1]),2]

LR_2016_Med_count<- length(LR_2016_Med) 

LR_2016_Res<- LR_2016[grep("^/Research and analysis methods",LR_2016[,1]),2]

LR_2016_Res_count<- length(LR_2016_Res) 

LR_2016_Earth<- LR_2016[grep("^/Earth sciences",LR_2016[,1]),2]

LR_2016_Earth_count<- length(LR_2016_Earth) 

LR_2016_Comp<- LR_2016[grep("^/Computer and information sciences",LR_2016[,1]),2]

LR_2016_Comp_count<- length(LR_2016_Comp) 

LR_2016_Eng<- LR_2016[grep("^/Engineering and technology",LR_2016[,1]),2]

LR_2016_Eng_count<- length(LR_2016_Eng) 

LR_2016_Soc<- LR_2016[grep("^/Social sciences",LR_2016[,1]),2]

LR_2016_Soc_count<- length(LR_2016_Soc)

## LR 2017

LR_2017<- LR_search_clean[grep("^2017",LR_search_clean[,2]),]


LR_2017_Bio<- LR_2017[grep("^/Biology and life sciences",LR_2017[,1]),2]

LR_2017_Bio_count<- length(LR_2017_Bio)

LR_2017_Phys<- LR_2017[grep("^/Physical sciences",LR_2017[,1]),2]

LR_2017_Phys_count<- length(LR_2017_Phys) 

LR_2017_Med<- LR_2017[grep("^/Medicine and health sciences",LR_2017[,1]),2]

LR_2017_Med_count<- length(LR_2017_Med) 

LR_2017_Res<- LR_2017[grep("^/Research and analysis methods",LR_2017[,1]),2]

LR_2017_Res_count<- length(LR_2017_Res) 

LR_2017_Earth<- LR_2017[grep("^/Earth sciences",LR_2017[,1]),2]

LR_2017_Earth_count<- length(LR_2017_Earth) 

LR_2017_Comp<- LR_2017[grep("^/Computer and information sciences",LR_2017[,1]),2]

LR_2017_Comp_count<- length(LR_2017_Comp) 

LR_2017_Eng<- LR_2017[grep("^/Engineering and technology",LR_2017[,1]),2]

LR_2017_Eng_count<- length(LR_2017_Eng) 

LR_2017_Soc<- LR_2017[grep("^/Social sciences",LR_2017[,1]),2]

LR_2017_Soc_count<- length(LR_2017_Soc)

############ LR counts table


LR_counts_2004_bio<- c(LR_2004_Bio_count,1,rep(0,13),1,rep(0,7))
LR_counts_2004_Comp<- c(LR_2004_Comp_count,1,rep(0,13),0,1,rep(0,6))
LR_counts_2004_Earth<-c(LR_2004_Earth_count,1,rep(0,13),0,0,1,rep(0,5))
LR_counts_2004_Eng<- c(LR_2004_Eng_count,1,rep(0,13),0,0,0,1,rep(0,4))
LR_counts_2004_Med<- c(LR_2004_Med_count,1,rep(0,13),rep(0,4),1,0,0,0)
LR_counts_2004_Phys<- c(LR_2004_Phys_count,1,rep(0,13),rep(0,5),1,0,0)
LR_count_2004_Res<-c(LR_2004_Res_count,1,rep(0,13),rep(0,6),1,0)
LR_count_2004_Soc<-c(LR_2004_Soc_count,1,rep(0,13),rep(0,7),1)

LR_counts_2005_bio<- c(LR_2005_Bio_count,0,1,rep(0,12),1,rep(0,7))
LR_counts_2005_Comp<- c(LR_2005_Comp_count,0,1,rep(0,12),0,1,rep(0,6))
LR_counts_2005_Earth<-c(LR_2005_Earth_count,0,1,rep(0,12),0,0,1,rep(0,5))
LR_counts_2005_Eng<- c(LR_2005_Eng_count,0,1,rep(0,12),0,0,0,1,rep(0,4))
LR_counts_2005_Med<- c(LR_2005_Med_count,0,1,rep(0,12),rep(0,4),1,0,0,0)
LR_counts_2005_Phys<- c(LR_2005_Phys_count,0,1,rep(0,12),rep(0,5),1,0,0)
LR_count_2005_Res<-c(LR_2005_Res_count,0,1,rep(0,12),rep(0,6),1,0)
LR_count_2005_Soc<-c(LR_2005_Soc_count,0,1,rep(0,12),rep(0,7),1)

LR_counts_2006_bio<- c(LR_2006_Bio_count,0,0,1,rep(0,11),1,rep(0,7))
LR_counts_2006_Comp<- c(LR_2006_Comp_count,0,0,1,rep(0,11),0,1,rep(0,6))
LR_counts_2006_Earth<-c(LR_2006_Earth_count,0,0,1,rep(0,11),0,0,1,rep(0,5))
LR_counts_2006_Eng<- c(LR_2006_Eng_count,0,0,1,rep(0,11),0,0,0,1,rep(0,4))
LR_counts_2006_Med<- c(LR_2006_Med_count,0,0,1,rep(0,11),rep(0,4),1,0,0,0)
LR_counts_2006_Phys<- c(LR_2006_Phys_count,0,0,1,rep(0,11),rep(0,5),1,0,0)
LR_count_2006_Res<-c(LR_2006_Res_count,0,0,1,rep(0,11),rep(0,6),1,0)
LR_count_2006_Soc<-c(LR_2006_Soc_count,0,0,1,rep(0,11),rep(0,7),1)

LR_counts_2007_bio<- c(LR_2007_Bio_count,0,0,0,1,rep(0,10),1,rep(0,7))
LR_counts_2007_Comp<- c(LR_2007_Comp_count,0,0,0,1,rep(0,10),0,1,rep(0,6))
LR_counts_2007_Earth<-c(LR_2007_Earth_count,0,0,0,1,rep(0,10),0,0,1,rep(0,5))
LR_counts_2007_Eng<- c(LR_2007_Eng_count,0,0,0,1,rep(0,10),0,0,0,1,rep(0,4))
LR_counts_2007_Med<- c(LR_2007_Med_count,0,0,0,1,rep(0,10),rep(0,4),1,0,0,0)
LR_counts_2007_Phys<- c(LR_2007_Phys_count,0,0,0,1,rep(0,10),rep(0,5),1,0,0)
LR_count_2007_Res<-c(LR_2007_Res_count,0,0,0,1,rep(0,10),rep(0,6),1,0)
LR_count_2007_Soc<-c(LR_2007_Soc_count,0,0,0,1,rep(0,10),rep(0,7),1)

LR_counts_2008_bio<- c(LR_2008_Bio_count,rep(0,4),1,rep(0,9),1,rep(0,7))
LR_counts_2008_Comp<- c(LR_2008_Comp_count,rep(0,4),1,rep(0,9),0,1,rep(0,6))
LR_counts_2008_Earth<-c(LR_2008_Earth_count,rep(0,4),1,rep(0,9),0,0,1,rep(0,5))
LR_counts_2008_Eng<- c(LR_2008_Eng_count,rep(0,4),1,rep(0,9),0,0,0,1,rep(0,4))
LR_counts_2008_Med<- c(LR_2008_Med_count,rep(0,4),1,rep(0,9),rep(0,4),1,0,0,0)
LR_counts_2008_Phys<- c(LR_2008_Phys_count,rep(0,4),1,rep(0,9),rep(0,5),1,0,0)
LR_count_2008_Res<-c(LR_2008_Res_count,rep(0,4),1,rep(0,9),rep(0,6),1,0)
LR_count_2008_Soc<-c(LR_2008_Soc_count,rep(0,4),1,rep(0,9),rep(0,7),1)


LR_counts_2009_bio<- c(LR_2009_Bio_count,rep(0,5),1,rep(0,8),1,rep(0,7))
LR_counts_2009_Comp<- c(LR_2009_Comp_count,rep(0,5),1,rep(0,8),0,1,rep(0,6))
LR_counts_2009_Earth<-c(LR_2009_Earth_count,rep(0,5),1,rep(0,8),0,0,1,rep(0,5))
LR_counts_2009_Eng<- c(LR_2009_Eng_count,rep(0,5),1,rep(0,8),0,0,0,1,rep(0,4))
LR_counts_2009_Med<- c(LR_2009_Med_count,rep(0,5),1,rep(0,8),rep(0,4),1,0,0,0)
LR_counts_2009_Phys<- c(LR_2009_Phys_count,rep(0,5),1,rep(0,8),rep(0,5),1,0,0)
LR_count_2009_Res<-c(LR_2009_Res_count,rep(0,5),1,rep(0,8),rep(0,6),1,0)
LR_count_2009_Soc<-c(LR_2009_Soc_count,rep(0,5),1,rep(0,8),rep(0,7),1)

LR_counts_2010_bio<- c(LR_2010_Bio_count,rep(0,6),1,rep(0,7),1,rep(0,7))
LR_counts_2010_Comp<- c(LR_2010_Comp_count,rep(0,6),1,rep(0,7),0,1,rep(0,6))
LR_counts_2010_Earth<-c(LR_2010_Earth_count,rep(0,6),1,rep(0,7),0,0,1,rep(0,5))
LR_counts_2010_Eng<- c(LR_2010_Eng_count,rep(0,6),1,rep(0,7),0,0,0,1,rep(0,4))
LR_counts_2010_Med<- c(LR_2010_Med_count,rep(0,6),1,rep(0,7),rep(0,4),1,0,0,0)
LR_counts_2010_Phys<- c(LR_2010_Phys_count,rep(0,6),1,rep(0,7),rep(0,5),1,0,0)
LR_count_2010_Res<-c(LR_2010_Res_count,rep(0,6),1,rep(0,7),rep(0,6),1,0)
LR_count_2010_Soc<-c(LR_2010_Soc_count,rep(0,6),1,rep(0,7),rep(0,7),1)


LR_counts_2011_bio<- c(LR_2011_Bio_count,rep(0,7),1,rep(0,6),1,rep(0,7))
LR_counts_2011_Comp<- c(LR_2011_Comp_count,rep(0,7),1,rep(0,6),0,1,rep(0,6))
LR_counts_2011_Earth<-c(LR_2011_Earth_count,rep(0,7),1,rep(0,6),0,0,1,rep(0,5))
LR_counts_2011_Eng<- c(LR_2011_Eng_count,rep(0,7),1,rep(0,6),0,0,0,1,rep(0,4))
LR_counts_2011_Med<- c(LR_2011_Med_count,rep(0,7),1,rep(0,6),rep(0,4),1,0,0,0)
LR_counts_2011_Phys<- c(LR_2011_Phys_count,rep(0,7),1,rep(0,6),rep(0,5),1,0,0)
LR_count_2011_Res<-c(LR_2011_Res_count,rep(0,7),1,rep(0,6),rep(0,6),1,0)
LR_count_2011_Soc<-c(LR_2011_Soc_count,rep(0,7),1,rep(0,6),rep(0,7),1)

LR_counts_2012_bio<- c(LR_2012_Bio_count,rep(0,8),1,rep(0,5),1,rep(0,7))
LR_counts_2012_Comp<- c(LR_2012_Comp_count,rep(0,8),1,rep(0,5),0,1,rep(0,6))
LR_counts_2012_Earth<-c(LR_2012_Earth_count,rep(0,8),1,rep(0,5),0,0,1,rep(0,5))
LR_counts_2012_Eng<- c(LR_2012_Eng_count,rep(0,8),1,rep(0,5),0,0,0,1,rep(0,4))
LR_counts_2012_Med<- c(LR_2012_Med_count,rep(0,8),1,rep(0,5),rep(0,4),1,0,0,0)
LR_counts_2012_Phys<- c(LR_2012_Phys_count,rep(0,8),1,rep(0,5),rep(0,5),1,0,0)
LR_count_2012_Res<-c(LR_2012_Res_count,rep(0,8),1,rep(0,5),rep(0,6),1,0)
LR_count_2012_Soc<-c(LR_2012_Soc_count,rep(0,8),1,rep(0,5),rep(0,7),1)

LR_counts_2013_bio<- c(LR_2013_Bio_count,rep(0,9),1,rep(0,4),1,rep(0,7))
LR_counts_2013_Comp<- c(LR_2013_Comp_count,rep(0,9),1,rep(0,4),0,1,rep(0,6))
LR_counts_2013_Earth<-c(LR_2013_Earth_count,rep(0,9),1,rep(0,4),0,0,1,rep(0,5))
LR_counts_2013_Eng<- c(LR_2013_Eng_count,rep(0,9),1,rep(0,4),0,0,0,1,rep(0,4))
LR_counts_2013_Med<- c(LR_2013_Med_count,rep(0,9),1,rep(0,4),rep(0,4),1,0,0,0)
LR_counts_2013_Phys<- c(LR_2013_Phys_count,rep(0,9),1,rep(0,4),rep(0,5),1,0,0)
LR_count_2013_Res<-c(LR_2013_Res_count,rep(0,9),1,rep(0,4),rep(0,6),1,0)
LR_count_2013_Soc<-c(LR_2013_Soc_count,rep(0,9),1,rep(0,4),rep(0,7),1)

LR_counts_2014_bio<- c(LR_2014_Bio_count,rep(0,10),1,rep(0,3),1,rep(0,7))
LR_counts_2014_Comp<- c(LR_2014_Comp_count,rep(0,10),1,rep(0,3),0,1,rep(0,6))
LR_counts_2014_Earth<-c(LR_2014_Earth_count,rep(0,10),1,rep(0,3),0,0,1,rep(0,5))
LR_counts_2014_Eng<- c(LR_2014_Eng_count,rep(0,10),1,rep(0,3),0,0,0,1,rep(0,4))
LR_counts_2014_Med<- c(LR_2014_Med_count,rep(0,10),1,rep(0,3),rep(0,4),1,0,0,0)
LR_counts_2014_Phys<- c(LR_2014_Phys_count,rep(0,10),1,rep(0,3),rep(0,5),1,0,0)
LR_count_2014_Res<-c(LR_2014_Res_count,rep(0,10),1,rep(0,3),rep(0,6),1,0)
LR_count_2014_Soc<-c(LR_2014_Soc_count,rep(0,10),1,rep(0,3),rep(0,7),1)

LR_counts_2015_bio<- c(LR_2015_Bio_count,rep(0,11),1,rep(0,2),1,rep(0,7))
LR_counts_2015_Comp<- c(LR_2015_Comp_count,rep(0,11),1,rep(0,2),0,1,rep(0,6))
LR_counts_2015_Earth<-c(LR_2015_Earth_count,rep(0,11),1,rep(0,2),0,0,1,rep(0,5))
LR_counts_2015_Eng<- c(LR_2015_Eng_count,rep(0,11),1,rep(0,2),0,0,0,1,rep(0,4))
LR_counts_2015_Med<- c(LR_2015_Med_count,rep(0,11),1,rep(0,2),rep(0,4),1,0,0,0)
LR_counts_2015_Phys<- c(LR_2015_Phys_count,rep(0,11),1,rep(0,2),rep(0,5),1,0,0)
LR_count_2015_Res<-c(LR_2015_Res_count,rep(0,11),1,rep(0,2),rep(0,6),1,0)
LR_count_2015_Soc<-c(LR_2015_Soc_count,rep(0,11),1,rep(0,2),rep(0,7),1)

LR_counts_2016_bio<- c(LR_2016_Bio_count,rep(0,12),1,rep(0,1),1,rep(0,7))
LR_counts_2016_Comp<- c(LR_2016_Comp_count,rep(0,12),1,rep(0,1),0,1,rep(0,6))
LR_counts_2016_Earth<-c(LR_2016_Earth_count,rep(0,12),1,rep(0,1),0,0,1,rep(0,5))
LR_counts_2016_Eng<- c(LR_2016_Eng_count,rep(0,12),1,rep(0,1),0,0,0,1,rep(0,4))
LR_counts_2016_Med<- c(LR_2016_Med_count,rep(0,12),1,rep(0,1),rep(0,4),1,0,0,0)
LR_counts_2016_Phys<- c(LR_2016_Phys_count,rep(0,12),1,rep(0,1),rep(0,5),1,0,0)
LR_count_2016_Res<-c(LR_2016_Res_count,rep(0,12),1,rep(0,1),rep(0,6),1,0)
LR_count_2016_Soc<-c(LR_2016_Soc_count,rep(0,12),1,rep(0,1),rep(0,7),1)

LR_counts_2017_bio<- c(LR_2017_Bio_count,rep(0,13),1,1,rep(0,7))
LR_counts_2017_Comp<- c(LR_2017_Comp_count,rep(0,13),1,0,1,rep(0,6))
LR_counts_2017_Earth<-c(LR_2017_Earth_count,rep(0,13),1,0,0,1,rep(0,5))
LR_counts_2017_Eng<- c(LR_2017_Eng_count,rep(0,13),1,0,0,0,1,rep(0,4))
LR_counts_2017_Med<- c(LR_2017_Med_count,rep(0,13),1,rep(0,4),1,0,0,0)
LR_counts_2017_Phys<- c(LR_2017_Phys_count,rep(0,13),1,rep(0,5),1,0,0)
LR_count_2017_Res<-c(LR_2017_Res_count,rep(0,13),1,rep(0,6),1,0)
LR_count_2017_Soc<-c(LR_2017_Soc_count,rep(0,13),1,rep(0,7),1)

LR_table<- rbind(LR_counts_2004_bio,LR_counts_2004_Comp,LR_counts_2004_Earth,
                    LR_counts_2004_Eng,LR_counts_2004_Med,LR_counts_2004_Phys,
                    LR_count_2004_Res,LR_count_2004_Soc,LR_counts_2005_bio,
                    LR_counts_2005_Comp,LR_counts_2005_Earth,LR_counts_2005_Eng,
                    LR_counts_2005_Med,LR_counts_2005_Phys,LR_count_2005_Res,
                    LR_count_2005_Soc,LR_counts_2006_bio,
                    LR_counts_2006_Comp,LR_counts_2006_Earth,LR_counts_2006_Eng,
                    LR_counts_2006_Med,LR_counts_2006_Phys,LR_count_2006_Res,
                    LR_count_2006_Soc,LR_counts_2007_bio,
                    LR_counts_2007_Comp,LR_counts_2007_Earth,LR_counts_2007_Eng,
                    LR_counts_2007_Med,LR_counts_2007_Phys,LR_count_2007_Res,
                    LR_count_2007_Soc, LR_counts_2008_bio,
                    LR_counts_2008_Comp,LR_counts_2008_Earth,LR_counts_2008_Eng,
                    LR_counts_2008_Med,LR_counts_2008_Phys,LR_count_2008_Res,
                    LR_count_2008_Soc, LR_counts_2009_bio,
                    LR_counts_2009_Comp,LR_counts_2009_Earth,LR_counts_2009_Eng,
                    LR_counts_2009_Med,LR_counts_2009_Phys,LR_count_2009_Res,
                    LR_count_2009_Soc,LR_counts_2010_bio,
                    LR_counts_2010_Comp,LR_counts_2010_Earth,LR_counts_2010_Eng,
                    LR_counts_2010_Med,LR_counts_2010_Phys,LR_count_2010_Res,
                    LR_count_2010_Soc,LR_counts_2011_bio,
                    LR_counts_2011_Comp,LR_counts_2011_Earth,LR_counts_2011_Eng,
                    LR_counts_2011_Med,LR_counts_2011_Phys,LR_count_2011_Res,
                    LR_count_2011_Soc,LR_counts_2012_bio,
                    LR_counts_2012_Comp,LR_counts_2012_Earth,LR_counts_2012_Eng,
                    LR_counts_2012_Med,LR_counts_2012_Phys,LR_count_2012_Res,
                    LR_count_2012_Soc, LR_counts_2013_bio,
                    LR_counts_2013_Comp,LR_counts_2013_Earth,LR_counts_2013_Eng,
                    LR_counts_2013_Med,LR_counts_2013_Phys,LR_count_2013_Res,
                    LR_count_2013_Soc, LR_counts_2014_bio,
                    LR_counts_2014_Comp,LR_counts_2014_Earth,LR_counts_2014_Eng,
                    LR_counts_2014_Med,LR_counts_2014_Phys,LR_count_2014_Res,
                    LR_count_2014_Soc,LR_counts_2015_bio,
                    LR_counts_2015_Comp,LR_counts_2015_Earth,LR_counts_2015_Eng,
                    LR_counts_2015_Med,LR_counts_2015_Phys,LR_count_2015_Res,
                    LR_count_2015_Soc,LR_counts_2016_bio,
                    LR_counts_2016_Comp,LR_counts_2016_Earth,LR_counts_2016_Eng,
                    LR_counts_2016_Med,LR_counts_2016_Phys,LR_count_2016_Res,
                    LR_count_2016_Soc, LR_counts_2017_bio,
                    LR_counts_2017_Comp,LR_counts_2017_Earth,LR_counts_2017_Eng,
                    LR_counts_2017_Med,LR_counts_2017_Phys,LR_count_2017_Res,
                    LR_count_2017_Soc)

LR_table[97:112,]
as.data.frame(LR_table)

colnames(LR_table)<- c("LR_counts","2004","2005","2006","2007","2008","2009",
                          "2010","2011","2012","2013","2014","2015","2016","2017",
                          "Biology and life sciences","Computer and information sciences",
                          "Earth sciences","Engineering and tecnhology",
                          "Medicine and health sciences","Physical sciences",
                          "Research and analysis","Social Sciences")

as.numeric(LR_table[,1])

year_covs<- LR_table[,2:15]

terms_covs<- LR_table[,16:23]

################### Linear Regression Model Fit ###################

model_LR<- glm(LR_table[,1]~year_covs*terms_covs, family="poisson")

summary(model_LR)

######################## Mixed Effect Counts Assembly ##############
MM_search<-searchplos(q="mixed effect model",fl=c("subject","publication_date"),limit=10000)

MM_search_clean<- matrix(unlist(MM_search[[2]]),ncol=2)



###MM 2004
MM_2004<- MM_search_clean[grep("^2004",MM_search_clean[,2]),]


MM_2004_Bio<- MM_2004[grep("^/Biology and life sciences",MM_2004[,1]),2]

MM_2004_Bio_count<- length(MM_2004_Bio)

MM_2004_Phys<- MM_2004[grep("^/Physical sciences",MM_2004[,1]),2]

MM_2004_Phys_count<- length(MM_2004_Phys) 

MM_2004_Med<- MM_2004[grep("^/Medicine and health sciences",MM_2004[,1]),2]

MM_2004_Med_count<- length(MM_2004_Med) 

MM_2004_Res<- MM_2004[grep("^/Research and analysis methods",MM_2004[,1]),2]

MM_2004_Res_count<- length(MM_2004_Res) 

MM_2004_Earth<- MM_2004[grep("^/Earth sciences",MM_2004[,1]),2]

MM_2004_Earth_count<- length(MM_2004_Earth) 

MM_2004_Comp<- MM_2004[grep("^/Computer and information sciences",MM_2004[,1]),2]

MM_2004_Comp_count<- length(MM_2004_Comp) 

MM_2004_Eng<- MM_2004[grep("^/Engineering and technology",MM_2004[,1]),2]

MM_2004_Eng_count<- length(MM_2004_Eng) 

MM_2004_Soc<- MM_2004[grep("^/Social sciences",MM_2004[,1]),2]

MM_2004_Soc_count<- length(MM_2004_Soc) 


########MM 2005

MM_2005<- MM_search_clean[grep("^2005",MM_search_clean[,2]),]


MM_2005_Bio<- MM_2005[grep("^/Biology and life sciences",MM_2005[,1]),2]

MM_2005_Bio_count<- length(MM_2005_Bio)

MM_2005_Phys<- MM_2005[grep("^/Physical sciences",MM_2005[,1]),2]

MM_2005_Phys_count<- length(MM_2005_Phys) 

MM_2005_Med<- MM_2005[grep("^/Medicine and health sciences",MM_2005[,1]),2]

MM_2005_Med_count<- length(MM_2005_Med) 

MM_2005_Res<- MM_2005[grep("^/Research and analysis methods",MM_2005[,1]),2]

MM_2005_Res_count<- length(MM_2005_Res) 

MM_2005_Earth<- MM_2005[grep("^/Earth sciences",MM_2005[,1]),2]

MM_2005_Earth_count<- length(MM_2005_Earth) 

MM_2005_Comp<- MM_2005[grep("^/Computer and information sciences",MM_2005[,1]),2]

MM_2005_Comp_count<- length(MM_2005_Comp) 

MM_2005_Eng<- MM_2005[grep("^/Engineering and technology",MM_2005[,1]),2]

MM_2005_Eng_count<- length(MM_2005_Eng) 

MM_2005_Soc<- MM_2005[grep("^/Social sciences",MM_2005[,1]),2]

MM_2005_Soc_count<- length(MM_2005_Soc) 


###### MM 2006


MM_2006<- MM_search_clean[grep("^2006",MM_search_clean[,2]),]


MM_2006_Bio<- MM_2006[grep("^/Biology and life sciences",MM_2006[,1]),2]

MM_2006_Bio_count<- length(MM_2006_Bio)

MM_2006_Phys<- MM_2006[grep("^/Physical sciences",MM_2006[,1]),2]

MM_2006_Phys_count<- length(MM_2006_Phys) 

MM_2006_Med<- MM_2006[grep("^/Medicine and health sciences",MM_2006[,1]),2]

MM_2006_Med_count<- length(MM_2006_Med) 

MM_2006_Res<- MM_2006[grep("^/Research and analysis methods",MM_2006[,1]),2]

MM_2006_Res_count<- length(MM_2006_Res) 

MM_2006_Earth<- MM_2006[grep("^/Earth sciences",MM_2006[,1]),2]

MM_2006_Earth_count<- length(MM_2006_Earth) 

MM_2006_Comp<- MM_2006[grep("^/Computer and information sciences",MM_2006[,1]),2]

MM_2006_Comp_count<- length(MM_2006_Comp) 

MM_2006_Eng<- MM_2006[grep("^/Engineering and technology",MM_2006[,1]),2]

MM_2006_Eng_count<- length(MM_2006_Eng) 

MM_2006_Soc<- MM_2006[grep("^/Social sciences",MM_2006[,1]),2]

MM_2006_Soc_count<- length(MM_2006_Soc) 

## MM 2007


MM_2007<- MM_search_clean[grep("^2007",MM_search_clean[,2]),]



MM_2007_Bio<- MM_2007[grep("^/Biology and life sciences",MM_2007[,1]),2]

MM_2007_Bio_count<- length(MM_2007_Bio)

MM_2007_Phys<- MM_2007[grep("^/Physical sciences",MM_2007[,1]),2]

MM_2007_Phys_count<- length(MM_2007_Phys) 

MM_2007_Med<- MM_2007[grep("^/Medicine and health sciences",MM_2007[,1]),2]

MM_2007_Med_count<- length(MM_2007_Med) 

MM_2007_Res<- MM_2007[grep("^/Research and analysis methods",MM_2007[,1]),2]

MM_2007_Res_count<- length(MM_2007_Res) 

MM_2007_Earth<- MM_2007[grep("^/Earth sciences",MM_2007[,1]),2]

MM_2007_Earth_count<- length(MM_2007_Earth) 

MM_2007_Comp<- MM_2007[grep("^/Computer and information sciences",MM_2007[,1]),2]

MM_2007_Comp_count<- length(MM_2007_Comp) 

MM_2007_Eng<- MM_2007[grep("^/Engineering and technology",MM_2007[,1]),2]

MM_2007_Eng_count<- length(MM_2007_Eng) 

MM_2007_Soc<- MM_2007[grep("^/Social sciences",MM_2007[,1]),2]

MM_2007_Soc_count<- length(MM_2007_Soc) 

#### MM 2008
MM_2008<- MM_search_clean[grep("^2008",MM_search_clean[,2]),]

MM_2008_Bio<- MM_2008[grep("^/Biology and life sciences",MM_2008[,1]),2]

MM_2008_Bio_count<- length(MM_2008_Bio)

MM_2008_Phys<- MM_2008[grep("^/Physical sciences",MM_2008[,1]),2]

MM_2008_Phys_count<- length(MM_2008_Phys) 

MM_2008_Med<- MM_2008[grep("^/Medicine and health sciences",MM_2008[,1]),2]

MM_2008_Med_count<- length(MM_2008_Med) 

MM_2008_Res<- MM_2008[grep("^/Research and analysis methods",MM_2008[,1]),2]

MM_2008_Res_count<- length(MM_2008_Res) 

MM_2008_Earth<- MM_2008[grep("^/Earth sciences",MM_2008[,1]),2]

MM_2008_Earth_count<- length(MM_2008_Earth) 

MM_2008_Comp<- MM_2008[grep("^/Computer and information sciences",MM_2008[,1]),2]

MM_2008_Comp_count<- length(MM_2008_Comp) 

MM_2008_Eng<- MM_2008[grep("^/Engineering and technology",MM_2008[,1]),2]

MM_2008_Eng_count<- length(MM_2008_Eng) 

MM_2008_Soc<- MM_2008[grep("^/Social sciences",MM_2008[,1]),2]

MM_2008_Soc_count<- length(MM_2008_Soc) 

##2009

MM_2009<- MM_search_clean[grep("^2009",MM_search_clean[,2]),]


MM_2009_Bio<- MM_2009[grep("^/Biology and life sciences",MM_2009[,1]),2]

MM_2009_Bio_count<- length(MM_2009_Bio)

MM_2009_Phys<- MM_2009[grep("^/Physical sciences",MM_2009[,1]),2]

MM_2009_Phys_count<- length(MM_2009_Phys) 

MM_2009_Med<- MM_2009[grep("^/Medicine and health sciences",MM_2009[,1]),2]

MM_2009_Med_count<- length(MM_2009_Med) 

MM_2009_Res<- MM_2009[grep("^/Research and analysis methods",MM_2009[,1]),2]

MM_2009_Res_count<- length(MM_2009_Res) 

MM_2009_Earth<- MM_2009[grep("^/Earth sciences",MM_2009[,1]),2]

MM_2009_Earth_count<- length(MM_2009_Earth) 

MM_2009_Comp<- MM_2009[grep("^/Computer and information sciences",MM_2009[,1]),2]

MM_2009_Comp_count<- length(MM_2009_Comp) 

MM_2009_Eng<- MM_2009[grep("^/Engineering and technology",MM_2009[,1]),2]

MM_2009_Eng_count<- length(MM_2009_Eng) 

MM_2009_Soc<- MM_2009[grep("^/Social sciences",MM_2009[,1]),2]

MM_2009_Soc_count<- length(MM_2009_Soc)

### MM 2010

MM_2010<- MM_search_clean[grep("^2010",MM_search_clean[,2]),]


MM_2010_Bio<- MM_2010[grep("^/Biology and life sciences",MM_2010[,1]),2]

MM_2010_Bio_count<- length(MM_2010_Bio)

MM_2010_Phys<- MM_2010[grep("^/Physical sciences",MM_2010[,1]),2]

MM_2010_Phys_count<- length(MM_2010_Phys) 

MM_2010_Med<- MM_2010[grep("^/Medicine and health sciences",MM_2010[,1]),2]

MM_2010_Med_count<- length(MM_2010_Med) 

MM_2010_Res<- MM_2010[grep("^/Research and analysis methods",MM_2010[,1]),2]

MM_2010_Res_count<- length(MM_2010_Res) 

MM_2010_Earth<- MM_2010[grep("^/Earth sciences",MM_2010[,1]),2]

MM_2010_Earth_count<- length(MM_2010_Earth) 

MM_2010_Comp<- MM_2010[grep("^/Computer and information sciences",MM_2010[,1]),2]

MM_2010_Comp_count<- length(MM_2010_Comp) 

MM_2010_Eng<- MM_2010[grep("^/Engineering and technology",MM_2010[,1]),2]

MM_2010_Eng_count<- length(MM_2010_Eng) 

MM_2010_Soc<- MM_2010[grep("^/Social sciences",MM_2010[,1]),2]

MM_2010_Soc_count<- length(MM_2010_Soc)

###2011 MM

MM_2011<- MM_search_clean[grep("^2011",MM_search_clean[,2]),]


MM_2011_Bio<- MM_2011[grep("^/Biology and life sciences",MM_2011[,1]),2]

MM_2011_Bio_count<- length(MM_2011_Bio)

MM_2011_Phys<- MM_2011[grep("^/Physical sciences",MM_2011[,1]),2]

MM_2011_Phys_count<- length(MM_2011_Phys) 

MM_2011_Med<- MM_2011[grep("^/Medicine and health sciences",MM_2011[,1]),2]

MM_2011_Med_count<- length(MM_2011_Med) 

MM_2011_Res<- MM_2011[grep("^/Research and analysis methods",MM_2011[,1]),2]

MM_2011_Res_count<- length(MM_2011_Res) 

MM_2011_Earth<- MM_2011[grep("^/Earth sciences",MM_2011[,1]),2]

MM_2011_Earth_count<- length(MM_2011_Earth) 

MM_2011_Comp<- MM_2011[grep("^/Computer and information sciences",MM_2011[,1]),2]

MM_2011_Comp_count<- length(MM_2011_Comp) 

MM_2011_Eng<- MM_2011[grep("^/Engineering and technology",MM_2011[,1]),2]

MM_2011_Eng_count<- length(MM_2011_Eng) 

MM_2011_Soc<- MM_2011[grep("^/Social sciences",MM_2011[,1]),2]

MM_2011_Soc_count<- length(MM_2011_Soc)

###MM 2012
MM_2012<- MM_search_clean[grep("^2012",MM_search_clean[,2]),]


MM_2012_Bio<- MM_2012[grep("^/Biology and life sciences",MM_2012[,1]),2]

MM_2012_Bio_count<- length(MM_2012_Bio)

MM_2012_Phys<- MM_2012[grep("^/Physical sciences",MM_2012[,1]),2]

MM_2012_Phys_count<- length(MM_2012_Phys) 

MM_2012_Med<- MM_2012[grep("^/Medicine and health sciences",MM_2012[,1]),2]

MM_2012_Med_count<- length(MM_2012_Med) 

MM_2012_Res<- MM_2012[grep("^/Research and analysis methods",MM_2012[,1]),2]

MM_2012_Res_count<- length(MM_2012_Res) 

MM_2012_Earth<- MM_2012[grep("^/Earth sciences",MM_2012[,1]),2]

MM_2012_Earth_count<- length(MM_2012_Earth) 

MM_2012_Comp<- MM_2012[grep("^/Computer and information sciences",MM_2012[,1]),2]

MM_2012_Comp_count<- length(MM_2012_Comp) 

MM_2012_Eng<- MM_2012[grep("^/Engineering and technology",MM_2012[,1]),2]

MM_2012_Eng_count<- length(MM_2012_Eng) 

MM_2012_Soc<- MM_2012[grep("^/Social sciences",MM_2012[,1]),2]

MM_2012_Soc_count<- length(MM_2012_Soc)

##MM 2013

MM_2013<- MM_search_clean[grep("^2013",MM_search_clean[,2]),]


MM_2013_Bio<- MM_2013[grep("^/Biology and life sciences",MM_2013[,1]),2]

MM_2013_Bio_count<- length(MM_2013_Bio)

MM_2013_Phys<- MM_2013[grep("^/Physical sciences",MM_2013[,1]),2]

MM_2013_Phys_count<- length(MM_2013_Phys) 

MM_2013_Med<- MM_2013[grep("^/Medicine and health sciences",MM_2013[,1]),2]

MM_2013_Med_count<- length(MM_2013_Med) 

MM_2013_Res<- MM_2013[grep("^/Research and analysis methods",MM_2013[,1]),2]

MM_2013_Res_count<- length(MM_2013_Res) 

MM_2013_Earth<- MM_2013[grep("^/Earth sciences",MM_2013[,1]),2]

MM_2013_Earth_count<- length(MM_2013_Earth) 

MM_2013_Comp<- MM_2013[grep("^/Computer and information sciences",MM_2013[,1]),2]

MM_2013_Comp_count<- length(MM_2013_Comp) 

MM_2013_Eng<- MM_2013[grep("^/Engineering and technology",MM_2013[,1]),2]

MM_2013_Eng_count<- length(MM_2013_Eng) 

MM_2013_Soc<- MM_2013[grep("^/Social sciences",MM_2013[,1]),2]

MM_2013_Soc_count<- length(MM_2013_Soc)

###MM 2014

MM_2014<- MM_search_clean[grep("^2014",MM_search_clean[,2]),]


MM_2014_Bio<- MM_2014[grep("^/Biology and life sciences",MM_2014[,1]),2]

MM_2014_Bio_count<- length(MM_2014_Bio)

MM_2014_Phys<- MM_2014[grep("^/Physical sciences",MM_2014[,1]),2]

MM_2014_Phys_count<- length(MM_2014_Phys) 

MM_2014_Med<- MM_2014[grep("^/Medicine and health sciences",MM_2014[,1]),2]

MM_2014_Med_count<- length(MM_2014_Med) 

MM_2014_Res<- MM_2014[grep("^/Research and analysis methods",MM_2014[,1]),2]

MM_2014_Res_count<- length(MM_2014_Res) 

MM_2014_Earth<- MM_2014[grep("^/Earth sciences",MM_2014[,1]),2]

MM_2014_Earth_count<- length(MM_2014_Earth) 

MM_2014_Comp<- MM_2014[grep("^/Computer and information sciences",MM_2014[,1]),2]

MM_2014_Comp_count<- length(MM_2014_Comp) 

MM_2014_Eng<- MM_2014[grep("^/Engineering and technology",MM_2014[,1]),2]

MM_2014_Eng_count<- length(MM_2014_Eng) 

MM_2014_Soc<- MM_2014[grep("^/Social sciences",MM_2014[,1]),2]

MM_2014_Soc_count<- length(MM_2014_Soc)

### MM 2015

MM_2015<- MM_search_clean[grep("^2015",MM_search_clean[,2]),]


MM_2015_Bio<- MM_2015[grep("^/Biology and life sciences",MM_2015[,1]),2]

MM_2015_Bio_count<- length(MM_2015_Bio)

MM_2015_Phys<- MM_2015[grep("^/Physical sciences",MM_2015[,1]),2]

MM_2015_Phys_count<- length(MM_2015_Phys) 

MM_2015_Med<- MM_2015[grep("^/Medicine and health sciences",MM_2015[,1]),2]

MM_2015_Med_count<- length(MM_2015_Med) 

MM_2015_Res<- MM_2015[grep("^/Research and analysis methods",MM_2015[,1]),2]

MM_2015_Res_count<- length(MM_2015_Res) 

MM_2015_Earth<- MM_2015[grep("^/Earth sciences",MM_2015[,1]),2]

MM_2015_Earth_count<- length(MM_2015_Earth) 

MM_2015_Comp<- MM_2015[grep("^/Computer and information sciences",MM_2015[,1]),2]

MM_2015_Comp_count<- length(MM_2015_Comp) 

MM_2015_Eng<- MM_2015[grep("^/Engineering and technology",MM_2015[,1]),2]

MM_2015_Eng_count<- length(MM_2015_Eng) 

MM_2015_Soc<- MM_2015[grep("^/Social sciences",MM_2015[,1]),2]

MM_2015_Soc_count<- length(MM_2015_Soc)

##MM 2016

MM_2016<- MM_search_clean[grep("^2016",MM_search_clean[,2]),]


MM_2016_Bio<- MM_2016[grep("^/Biology and life sciences",MM_2016[,1]),2]

MM_2016_Bio_count<- length(MM_2016_Bio)

MM_2016_Phys<- MM_2016[grep("^/Physical sciences",MM_2016[,1]),2]

MM_2016_Phys_count<- length(MM_2016_Phys) 

MM_2016_Med<- MM_2016[grep("^/Medicine and health sciences",MM_2016[,1]),2]

MM_2016_Med_count<- length(MM_2016_Med) 

MM_2016_Res<- MM_2016[grep("^/Research and analysis methods",MM_2016[,1]),2]

MM_2016_Res_count<- length(MM_2016_Res) 

MM_2016_Earth<- MM_2016[grep("^/Earth sciences",MM_2016[,1]),2]

MM_2016_Earth_count<- length(MM_2016_Earth) 

MM_2016_Comp<- MM_2016[grep("^/Computer and information sciences",MM_2016[,1]),2]

MM_2016_Comp_count<- length(MM_2016_Comp) 

MM_2016_Eng<- MM_2016[grep("^/Engineering and technology",MM_2016[,1]),2]

MM_2016_Eng_count<- length(MM_2016_Eng) 

MM_2016_Soc<- MM_2016[grep("^/Social sciences",MM_2016[,1]),2]

MM_2016_Soc_count<- length(MM_2016_Soc)

## MM 2017

MM_2017<- MM_search_clean[grep("^2017",MM_search_clean[,2]),]


MM_2017_Bio<- MM_2017[grep("^/Biology and life sciences",MM_2017[,1]),2]

MM_2017_Bio_count<- length(MM_2017_Bio)

MM_2017_Phys<- MM_2017[grep("^/Physical sciences",MM_2017[,1]),2]

MM_2017_Phys_count<- length(MM_2017_Phys) 

MM_2017_Med<- MM_2017[grep("^/Medicine and health sciences",MM_2017[,1]),2]

MM_2017_Med_count<- length(MM_2017_Med) 

MM_2017_Res<- MM_2017[grep("^/Research and analysis methods",MM_2017[,1]),2]

MM_2017_Res_count<- length(MM_2017_Res) 

MM_2017_Earth<- MM_2017[grep("^/Earth sciences",MM_2017[,1]),2]

MM_2017_Earth_count<- length(MM_2017_Earth) 

MM_2017_Comp<- MM_2017[grep("^/Computer and information sciences",MM_2017[,1]),2]

MM_2017_Comp_count<- length(MM_2017_Comp) 

MM_2017_Eng<- MM_2017[grep("^/Engineering and technology",MM_2017[,1]),2]

MM_2017_Eng_count<- length(MM_2017_Eng) 

MM_2017_Soc<- MM_2017[grep("^/Social sciences",MM_2017[,1]),2]

MM_2017_Soc_count<- length(MM_2017_Soc)

############ MM counts table


MM_counts_2004_bio<- c(MM_2004_Bio_count,1,rep(0,13),1,rep(0,7))
MM_counts_2004_Comp<- c(MM_2004_Comp_count,1,rep(0,13),0,1,rep(0,6))
MM_counts_2004_Earth<-c(MM_2004_Earth_count,1,rep(0,13),0,0,1,rep(0,5))
MM_counts_2004_Eng<- c(MM_2004_Eng_count,1,rep(0,13),0,0,0,1,rep(0,4))
MM_counts_2004_Med<- c(MM_2004_Med_count,1,rep(0,13),rep(0,4),1,0,0,0)
MM_counts_2004_Phys<- c(MM_2004_Phys_count,1,rep(0,13),rep(0,5),1,0,0)
MM_count_2004_Res<-c(MM_2004_Res_count,1,rep(0,13),rep(0,6),1,0)
MM_count_2004_Soc<-c(MM_2004_Soc_count,1,rep(0,13),rep(0,7),1)

MM_counts_2005_bio<- c(MM_2005_Bio_count,0,1,rep(0,12),1,rep(0,7))
MM_counts_2005_Comp<- c(MM_2005_Comp_count,0,1,rep(0,12),0,1,rep(0,6))
MM_counts_2005_Earth<-c(MM_2005_Earth_count,0,1,rep(0,12),0,0,1,rep(0,5))
MM_counts_2005_Eng<- c(MM_2005_Eng_count,0,1,rep(0,12),0,0,0,1,rep(0,4))
MM_counts_2005_Med<- c(MM_2005_Med_count,0,1,rep(0,12),rep(0,4),1,0,0,0)
MM_counts_2005_Phys<- c(MM_2005_Phys_count,0,1,rep(0,12),rep(0,5),1,0,0)
MM_count_2005_Res<-c(MM_2005_Res_count,0,1,rep(0,12),rep(0,6),1,0)
MM_count_2005_Soc<-c(MM_2005_Soc_count,0,1,rep(0,12),rep(0,7),1)

MM_counts_2006_bio<- c(MM_2006_Bio_count,0,0,1,rep(0,11),1,rep(0,7))
MM_counts_2006_Comp<- c(MM_2006_Comp_count,0,0,1,rep(0,11),0,1,rep(0,6))
MM_counts_2006_Earth<-c(MM_2006_Earth_count,0,0,1,rep(0,11),0,0,1,rep(0,5))
MM_counts_2006_Eng<- c(MM_2006_Eng_count,0,0,1,rep(0,11),0,0,0,1,rep(0,4))
MM_counts_2006_Med<- c(MM_2006_Med_count,0,0,1,rep(0,11),rep(0,4),1,0,0,0)
MM_counts_2006_Phys<- c(MM_2006_Phys_count,0,0,1,rep(0,11),rep(0,5),1,0,0)
MM_count_2006_Res<-c(MM_2006_Res_count,0,0,1,rep(0,11),rep(0,6),1,0)
MM_count_2006_Soc<-c(MM_2006_Soc_count,0,0,1,rep(0,11),rep(0,7),1)

MM_counts_2007_bio<- c(MM_2007_Bio_count,0,0,0,1,rep(0,10),1,rep(0,7))
MM_counts_2007_Comp<- c(MM_2007_Comp_count,0,0,0,1,rep(0,10),0,1,rep(0,6))
MM_counts_2007_Earth<-c(MM_2007_Earth_count,0,0,0,1,rep(0,10),0,0,1,rep(0,5))
MM_counts_2007_Eng<- c(MM_2007_Eng_count,0,0,0,1,rep(0,10),0,0,0,1,rep(0,4))
MM_counts_2007_Med<- c(MM_2007_Med_count,0,0,0,1,rep(0,10),rep(0,4),1,0,0,0)
MM_counts_2007_Phys<- c(MM_2007_Phys_count,0,0,0,1,rep(0,10),rep(0,5),1,0,0)
MM_count_2007_Res<-c(MM_2007_Res_count,0,0,0,1,rep(0,10),rep(0,6),1,0)
MM_count_2007_Soc<-c(MM_2007_Soc_count,0,0,0,1,rep(0,10),rep(0,7),1)

MM_counts_2008_bio<- c(MM_2008_Bio_count,rep(0,4),1,rep(0,9),1,rep(0,7))
MM_counts_2008_Comp<- c(MM_2008_Comp_count,rep(0,4),1,rep(0,9),0,1,rep(0,6))
MM_counts_2008_Earth<-c(MM_2008_Earth_count,rep(0,4),1,rep(0,9),0,0,1,rep(0,5))
MM_counts_2008_Eng<- c(MM_2008_Eng_count,rep(0,4),1,rep(0,9),0,0,0,1,rep(0,4))
MM_counts_2008_Med<- c(MM_2008_Med_count,rep(0,4),1,rep(0,9),rep(0,4),1,0,0,0)
MM_counts_2008_Phys<- c(MM_2008_Phys_count,rep(0,4),1,rep(0,9),rep(0,5),1,0,0)
MM_count_2008_Res<-c(MM_2008_Res_count,rep(0,4),1,rep(0,9),rep(0,6),1,0)
MM_count_2008_Soc<-c(MM_2008_Soc_count,rep(0,4),1,rep(0,9),rep(0,7),1)


MM_counts_2009_bio<- c(MM_2009_Bio_count,rep(0,5),1,rep(0,8),1,rep(0,7))
MM_counts_2009_Comp<- c(MM_2009_Comp_count,rep(0,5),1,rep(0,8),0,1,rep(0,6))
MM_counts_2009_Earth<-c(MM_2009_Earth_count,rep(0,5),1,rep(0,8),0,0,1,rep(0,5))
MM_counts_2009_Eng<- c(MM_2009_Eng_count,rep(0,5),1,rep(0,8),0,0,0,1,rep(0,4))
MM_counts_2009_Med<- c(MM_2009_Med_count,rep(0,5),1,rep(0,8),rep(0,4),1,0,0,0)
MM_counts_2009_Phys<- c(MM_2009_Phys_count,rep(0,5),1,rep(0,8),rep(0,5),1,0,0)
MM_count_2009_Res<-c(MM_2009_Res_count,rep(0,5),1,rep(0,8),rep(0,6),1,0)
MM_count_2009_Soc<-c(MM_2009_Soc_count,rep(0,5),1,rep(0,8),rep(0,7),1)

MM_counts_2010_bio<- c(MM_2010_Bio_count,rep(0,6),1,rep(0,7),1,rep(0,7))
MM_counts_2010_Comp<- c(MM_2010_Comp_count,rep(0,6),1,rep(0,7),0,1,rep(0,6))
MM_counts_2010_Earth<-c(MM_2010_Earth_count,rep(0,6),1,rep(0,7),0,0,1,rep(0,5))
MM_counts_2010_Eng<- c(MM_2010_Eng_count,rep(0,6),1,rep(0,7),0,0,0,1,rep(0,4))
MM_counts_2010_Med<- c(MM_2010_Med_count,rep(0,6),1,rep(0,7),rep(0,4),1,0,0,0)
MM_counts_2010_Phys<- c(MM_2010_Phys_count,rep(0,6),1,rep(0,7),rep(0,5),1,0,0)
MM_count_2010_Res<-c(MM_2010_Res_count,rep(0,6),1,rep(0,7),rep(0,6),1,0)
MM_count_2010_Soc<-c(MM_2010_Soc_count,rep(0,6),1,rep(0,7),rep(0,7),1)


MM_counts_2011_bio<- c(MM_2011_Bio_count,rep(0,7),1,rep(0,6),1,rep(0,7))
MM_counts_2011_Comp<- c(MM_2011_Comp_count,rep(0,7),1,rep(0,6),0,1,rep(0,6))
MM_counts_2011_Earth<-c(MM_2011_Earth_count,rep(0,7),1,rep(0,6),0,0,1,rep(0,5))
MM_counts_2011_Eng<- c(MM_2011_Eng_count,rep(0,7),1,rep(0,6),0,0,0,1,rep(0,4))
MM_counts_2011_Med<- c(MM_2011_Med_count,rep(0,7),1,rep(0,6),rep(0,4),1,0,0,0)
MM_counts_2011_Phys<- c(MM_2011_Phys_count,rep(0,7),1,rep(0,6),rep(0,5),1,0,0)
MM_count_2011_Res<-c(MM_2011_Res_count,rep(0,7),1,rep(0,6),rep(0,6),1,0)
MM_count_2011_Soc<-c(MM_2011_Soc_count,rep(0,7),1,rep(0,6),rep(0,7),1)

MM_counts_2012_bio<- c(MM_2012_Bio_count,rep(0,8),1,rep(0,5),1,rep(0,7))
MM_counts_2012_Comp<- c(MM_2012_Comp_count,rep(0,8),1,rep(0,5),0,1,rep(0,6))
MM_counts_2012_Earth<-c(MM_2012_Earth_count,rep(0,8),1,rep(0,5),0,0,1,rep(0,5))
MM_counts_2012_Eng<- c(MM_2012_Eng_count,rep(0,8),1,rep(0,5),0,0,0,1,rep(0,4))
MM_counts_2012_Med<- c(MM_2012_Med_count,rep(0,8),1,rep(0,5),rep(0,4),1,0,0,0)
MM_counts_2012_Phys<- c(MM_2012_Phys_count,rep(0,8),1,rep(0,5),rep(0,5),1,0,0)
MM_count_2012_Res<-c(MM_2012_Res_count,rep(0,8),1,rep(0,5),rep(0,6),1,0)
MM_count_2012_Soc<-c(MM_2012_Soc_count,rep(0,8),1,rep(0,5),rep(0,7),1)

MM_counts_2013_bio<- c(MM_2013_Bio_count,rep(0,9),1,rep(0,4),1,rep(0,7))
MM_counts_2013_Comp<- c(MM_2013_Comp_count,rep(0,9),1,rep(0,4),0,1,rep(0,6))
MM_counts_2013_Earth<-c(MM_2013_Earth_count,rep(0,9),1,rep(0,4),0,0,1,rep(0,5))
MM_counts_2013_Eng<- c(MM_2013_Eng_count,rep(0,9),1,rep(0,4),0,0,0,1,rep(0,4))
MM_counts_2013_Med<- c(MM_2013_Med_count,rep(0,9),1,rep(0,4),rep(0,4),1,0,0,0)
MM_counts_2013_Phys<- c(MM_2013_Phys_count,rep(0,9),1,rep(0,4),rep(0,5),1,0,0)
MM_count_2013_Res<-c(MM_2013_Res_count,rep(0,9),1,rep(0,4),rep(0,6),1,0)
MM_count_2013_Soc<-c(MM_2013_Soc_count,rep(0,9),1,rep(0,4),rep(0,7),1)

MM_counts_2014_bio<- c(MM_2014_Bio_count,rep(0,10),1,rep(0,3),1,rep(0,7))
MM_counts_2014_Comp<- c(MM_2014_Comp_count,rep(0,10),1,rep(0,3),0,1,rep(0,6))
MM_counts_2014_Earth<-c(MM_2014_Earth_count,rep(0,10),1,rep(0,3),0,0,1,rep(0,5))
MM_counts_2014_Eng<- c(MM_2014_Eng_count,rep(0,10),1,rep(0,3),0,0,0,1,rep(0,4))
MM_counts_2014_Med<- c(MM_2014_Med_count,rep(0,10),1,rep(0,3),rep(0,4),1,0,0,0)
MM_counts_2014_Phys<- c(MM_2014_Phys_count,rep(0,10),1,rep(0,3),rep(0,5),1,0,0)
MM_count_2014_Res<-c(MM_2014_Res_count,rep(0,10),1,rep(0,3),rep(0,6),1,0)
MM_count_2014_Soc<-c(MM_2014_Soc_count,rep(0,10),1,rep(0,3),rep(0,7),1)

MM_counts_2015_bio<- c(MM_2015_Bio_count,rep(0,11),1,rep(0,2),1,rep(0,7))
MM_counts_2015_Comp<- c(MM_2015_Comp_count,rep(0,11),1,rep(0,2),0,1,rep(0,6))
MM_counts_2015_Earth<-c(MM_2015_Earth_count,rep(0,11),1,rep(0,2),0,0,1,rep(0,5))
MM_counts_2015_Eng<- c(MM_2015_Eng_count,rep(0,11),1,rep(0,2),0,0,0,1,rep(0,4))
MM_counts_2015_Med<- c(MM_2015_Med_count,rep(0,11),1,rep(0,2),rep(0,4),1,0,0,0)
MM_counts_2015_Phys<- c(MM_2015_Phys_count,rep(0,11),1,rep(0,2),rep(0,5),1,0,0)
MM_count_2015_Res<-c(MM_2015_Res_count,rep(0,11),1,rep(0,2),rep(0,6),1,0)
MM_count_2015_Soc<-c(MM_2015_Soc_count,rep(0,11),1,rep(0,2),rep(0,7),1)

MM_counts_2016_bio<- c(MM_2016_Bio_count,rep(0,12),1,rep(0,1),1,rep(0,7))
MM_counts_2016_Comp<- c(MM_2016_Comp_count,rep(0,12),1,rep(0,1),0,1,rep(0,6))
MM_counts_2016_Earth<-c(MM_2016_Earth_count,rep(0,12),1,rep(0,1),0,0,1,rep(0,5))
MM_counts_2016_Eng<- c(MM_2016_Eng_count,rep(0,12),1,rep(0,1),0,0,0,1,rep(0,4))
MM_counts_2016_Med<- c(MM_2016_Med_count,rep(0,12),1,rep(0,1),rep(0,4),1,0,0,0)
MM_counts_2016_Phys<- c(MM_2016_Phys_count,rep(0,12),1,rep(0,1),rep(0,5),1,0,0)
MM_count_2016_Res<-c(MM_2016_Res_count,rep(0,12),1,rep(0,1),rep(0,6),1,0)
MM_count_2016_Soc<-c(MM_2016_Soc_count,rep(0,12),1,rep(0,1),rep(0,7),1)

MM_counts_2017_bio<- c(MM_2017_Bio_count,rep(0,13),1,1,rep(0,7))
MM_counts_2017_Comp<- c(MM_2017_Comp_count,rep(0,13),1,0,1,rep(0,6))
MM_counts_2017_Earth<-c(MM_2017_Earth_count,rep(0,13),1,0,0,1,rep(0,5))
MM_counts_2017_Eng<- c(MM_2017_Eng_count,rep(0,13),1,0,0,0,1,rep(0,4))
MM_counts_2017_Med<- c(MM_2017_Med_count,rep(0,13),1,rep(0,4),1,0,0,0)
MM_counts_2017_Phys<- c(MM_2017_Phys_count,rep(0,13),1,rep(0,5),1,0,0)
MM_count_2017_Res<-c(MM_2017_Res_count,rep(0,13),1,rep(0,6),1,0)
MM_count_2017_Soc<-c(MM_2017_Soc_count,rep(0,13),1,rep(0,7),1)

MM_table<- rbind(MM_counts_2004_bio,MM_counts_2004_Comp,MM_counts_2004_Earth,
                    MM_counts_2004_Eng,MM_counts_2004_Med,MM_counts_2004_Phys,
                    MM_count_2004_Res,MM_count_2004_Soc,MM_counts_2005_bio,
                    MM_counts_2005_Comp,MM_counts_2005_Earth,MM_counts_2005_Eng,
                    MM_counts_2005_Med,MM_counts_2005_Phys,MM_count_2005_Res,
                    MM_count_2005_Soc,MM_counts_2006_bio,
                    MM_counts_2006_Comp,MM_counts_2006_Earth,MM_counts_2006_Eng,
                    MM_counts_2006_Med,MM_counts_2006_Phys,MM_count_2006_Res,
                    MM_count_2006_Soc,MM_counts_2007_bio,
                    MM_counts_2007_Comp,MM_counts_2007_Earth,MM_counts_2007_Eng,
                    MM_counts_2007_Med,MM_counts_2007_Phys,MM_count_2007_Res,
                    MM_count_2007_Soc, MM_counts_2008_bio,
                    MM_counts_2008_Comp,MM_counts_2008_Earth,MM_counts_2008_Eng,
                    MM_counts_2008_Med,MM_counts_2008_Phys,MM_count_2008_Res,
                    MM_count_2008_Soc, MM_counts_2009_bio,
                    MM_counts_2009_Comp,MM_counts_2009_Earth,MM_counts_2009_Eng,
                    MM_counts_2009_Med,MM_counts_2009_Phys,MM_count_2009_Res,
                    MM_count_2009_Soc,MM_counts_2010_bio,
                    MM_counts_2010_Comp,MM_counts_2010_Earth,MM_counts_2010_Eng,
                    MM_counts_2010_Med,MM_counts_2010_Phys,MM_count_2010_Res,
                    MM_count_2010_Soc,MM_counts_2011_bio,
                    MM_counts_2011_Comp,MM_counts_2011_Earth,MM_counts_2011_Eng,
                    MM_counts_2011_Med,MM_counts_2011_Phys,MM_count_2011_Res,
                    MM_count_2011_Soc,MM_counts_2012_bio,
                    MM_counts_2012_Comp,MM_counts_2012_Earth,MM_counts_2012_Eng,
                    MM_counts_2012_Med,MM_counts_2012_Phys,MM_count_2012_Res,
                    MM_count_2012_Soc, MM_counts_2013_bio,
                    MM_counts_2013_Comp,MM_counts_2013_Earth,MM_counts_2013_Eng,
                    MM_counts_2013_Med,MM_counts_2013_Phys,MM_count_2013_Res,
                    MM_count_2013_Soc, MM_counts_2014_bio,
                    MM_counts_2014_Comp,MM_counts_2014_Earth,MM_counts_2014_Eng,
                    MM_counts_2014_Med,MM_counts_2014_Phys,MM_count_2014_Res,
                    MM_count_2014_Soc,MM_counts_2015_bio,
                    MM_counts_2015_Comp,MM_counts_2015_Earth,MM_counts_2015_Eng,
                    MM_counts_2015_Med,MM_counts_2015_Phys,MM_count_2015_Res,
                    MM_count_2015_Soc,MM_counts_2016_bio,
                    MM_counts_2016_Comp,MM_counts_2016_Earth,MM_counts_2016_Eng,
                    MM_counts_2016_Med,MM_counts_2016_Phys,MM_count_2016_Res,
                    MM_count_2016_Soc, MM_counts_2017_bio,
                    MM_counts_2017_Comp,MM_counts_2017_Earth,MM_counts_2017_Eng,
                    MM_counts_2017_Med,MM_counts_2017_Phys,MM_count_2017_Res,
                    MM_count_2017_Soc)

MM_table[97:112,]
as.data.frame(MM_table)

colnames(MM_table)<- c("MM_counts","2004","2005","2006","2007","2008","2009",
                          "2010","2011","2012","2013","2014","2015","2016","2017",
                          "Biology and life sciences","Computer and information sciences",
                          "Earth sciences","Engineering and tecnhology",
                          "Medicine and health sciences","Physical sciences",
                          "Research and analysis","Social Sciences")

as.numeric(MM_table[,1])

year_covs<- MM_table[,2:15]

terms_covs<- MM_table[,16:23]

##################### Mixed effect models, model fit ############

model_MM<- glm(MM_table[,1]~year_covs*terms_covs, family="poisson")

summary(model_MM)

################### Generalized estimating equations counts assembly#########

GEE_search<- searchplos(q="generalized estimating equation",fl=c("subject","publication_date"),limit=10000)


GEE_search_clean<- matrix(unlist(GEE_search[[2]]),ncol=2)







###GEE 2004
GEE_2004<- GEE_search_clean[grep("^2004",GEE_search_clean[,2]),]


GEE_2004_Bio<- GEE_2004[grep("^/Biology and life sciences",GEE_2004[,1]),2]

GEE_2004_Bio_count<- length(GEE_2004_Bio)

GEE_2004_Phys<- GEE_2004[grep("^/Physical sciences",GEE_2004[,1]),2]

GEE_2004_Phys_count<- length(GEE_2004_Phys) 

GEE_2004_Med<- GEE_2004[grep("^/Medicine and health sciences",GEE_2004[,1]),2]

GEE_2004_Med_count<- length(GEE_2004_Med) 

GEE_2004_Res<- GEE_2004[grep("^/Research and analysis methods",GEE_2004[,1]),2]

GEE_2004_Res_count<- length(GEE_2004_Res) 

GEE_2004_Earth<- GEE_2004[grep("^/Earth sciences",GEE_2004[,1]),2]

GEE_2004_Earth_count<- length(GEE_2004_Earth) 

GEE_2004_Comp<- GEE_2004[grep("^/Computer and information sciences",GEE_2004[,1]),2]

GEE_2004_Comp_count<- length(GEE_2004_Comp) 

GEE_2004_Eng<- GEE_2004[grep("^/Engineering and technology",GEE_2004[,1]),2]

GEE_2004_Eng_count<- length(GEE_2004_Eng) 

GEE_2004_Soc<- GEE_2004[grep("^/Social sciences",GEE_2004[,1]),2]

GEE_2004_Soc_count<- length(GEE_2004_Soc) 


########GEE 2005

GEE_2005<- GEE_search_clean[grep("^2005",GEE_search_clean[,2]),]


GEE_2005_Bio<- GEE_2005[grep("^/Biology and life sciences",GEE_2005[,1]),2]

GEE_2005_Bio_count<- length(GEE_2005_Bio)

GEE_2005_Phys<- GEE_2005[grep("^/Physical sciences",GEE_2005[,1]),2]

GEE_2005_Phys_count<- length(GEE_2005_Phys) 

GEE_2005_Med<- GEE_2005[grep("^/Medicine and health sciences",GEE_2005[,1]),2]

GEE_2005_Med_count<- length(GEE_2005_Med) 

GEE_2005_Res<- GEE_2005[grep("^/Research and analysis methods",GEE_2005[,1]),2]

GEE_2005_Res_count<- length(GEE_2005_Res) 

GEE_2005_Earth<- GEE_2005[grep("^/Earth sciences",GEE_2005[,1]),2]

GEE_2005_Earth_count<- length(GEE_2005_Earth) 

GEE_2005_Comp<- GEE_2005[grep("^/Computer and information sciences",GEE_2005[,1]),2]

GEE_2005_Comp_count<- length(GEE_2005_Comp) 

GEE_2005_Eng<- GEE_2005[grep("^/Engineering and technology",GEE_2005[,1]),2]

GEE_2005_Eng_count<- length(GEE_2005_Eng) 

GEE_2005_Soc<- GEE_2005[grep("^/Social sciences",GEE_2005[,1]),2]

GEE_2005_Soc_count<- length(GEE_2005_Soc) 


###### GEE 2006


GEE_2006<- GEE_search_clean[grep("^2006",GEE_search_clean[,2]),]


GEE_2006_Bio<- GEE_2006[grep("^/Biology and life sciences",GEE_2006[,1]),2]

GEE_2006_Bio_count<- length(GEE_2006_Bio)

GEE_2006_Phys<- GEE_2006[grep("^/Physical sciences",GEE_2006[,1]),2]

GEE_2006_Phys_count<- length(GEE_2006_Phys) 

GEE_2006_Med<- GEE_2006[grep("^/Medicine and health sciences",GEE_2006[,1]),2]

GEE_2006_Med_count<- length(GEE_2006_Med) 

GEE_2006_Res<- GEE_2006[grep("^/Research and analysis methods",GEE_2006[,1]),2]

GEE_2006_Res_count<- length(GEE_2006_Res) 

GEE_2006_Earth<- GEE_2006[grep("^/Earth sciences",GEE_2006[,1]),2]

GEE_2006_Earth_count<- length(GEE_2006_Earth) 

GEE_2006_Comp<- GEE_2006[grep("^/Computer and information sciences",GEE_2006[,1]),2]

GEE_2006_Comp_count<- length(GEE_2006_Comp) 

GEE_2006_Eng<- GEE_2006[grep("^/Engineering and technology",GEE_2006[,1]),2]

GEE_2006_Eng_count<- length(GEE_2006_Eng) 

GEE_2006_Soc<- GEE_2006[grep("^/Social sciences",GEE_2006[,1]),2]

GEE_2006_Soc_count<- length(GEE_2006_Soc) 

## GEE 2007


GEE_2007<- GEE_search_clean[grep("^2007",GEE_search_clean[,2]),]



GEE_2007_Bio<- GEE_2007[grep("^/Biology and life sciences",GEE_2007[,1]),2]

GEE_2007_Bio_count<- length(GEE_2007_Bio)

GEE_2007_Phys<- GEE_2007[grep("^/Physical sciences",GEE_2007[,1]),2]

GEE_2007_Phys_count<- length(GEE_2007_Phys) 

GEE_2007_Med<- GEE_2007[grep("^/Medicine and health sciences",GEE_2007[,1]),2]

GEE_2007_Med_count<- length(GEE_2007_Med) 

GEE_2007_Res<- GEE_2007[grep("^/Research and analysis methods",GEE_2007[,1]),2]

GEE_2007_Res_count<- length(GEE_2007_Res) 

GEE_2007_Earth<- GEE_2007[grep("^/Earth sciences",GEE_2007[,1]),2]

GEE_2007_Earth_count<- length(GEE_2007_Earth) 

GEE_2007_Comp<- GEE_2007[grep("^/Computer and information sciences",GEE_2007[,1]),2]

GEE_2007_Comp_count<- length(GEE_2007_Comp) 

GEE_2007_Eng<- GEE_2007[grep("^/Engineering and technology",GEE_2007[,1]),2]

GEE_2007_Eng_count<- length(GEE_2007_Eng) 

GEE_2007_Soc<- GEE_2007[grep("^/Social sciences",GEE_2007[,1]),2]

GEE_2007_Soc_count<- length(GEE_2007_Soc) 

#### GEE 2008
GEE_2008<- GEE_search_clean[grep("^2008",GEE_search_clean[,2]),]


GEE_2008_Bio<- GEE_2008[grep("^/Biology and life sciences",GEE_2008[,1]),2]

GEE_2008_Bio_count<- length(GEE_2008_Bio)

GEE_2008_Phys<- GEE_2008[grep("^/Physical sciences",GEE_2008[,1]),2]

GEE_2008_Phys_count<- length(GEE_2008_Phys) 

GEE_2008_Med<- GEE_2008[grep("^/Medicine and health sciences",GEE_2008[,1]),2]

GEE_2008_Med_count<- length(GEE_2008_Med) 

GEE_2008_Res<- GEE_2008[grep("^/Research and analysis methods",GEE_2008[,1]),2]

GEE_2008_Res_count<- length(GEE_2008_Res) 

GEE_2008_Earth<- GEE_2008[grep("^/Earth sciences",GEE_2008[,1]),2]

GEE_2008_Earth_count<- length(GEE_2008_Earth) 

GEE_2008_Comp<- GEE_2008[grep("^/Computer and information sciences",GEE_2008[,1]),2]

GEE_2008_Comp_count<- length(GEE_2008_Comp) 

GEE_2008_Eng<- GEE_2008[grep("^/Engineering and technology",GEE_2008[,1]),2]

GEE_2008_Eng_count<- length(GEE_2008_Eng) 

GEE_2008_Soc<- GEE_2008[grep("^/Social sciences",GEE_2008[,1]),2]

GEE_2008_Soc_count<- length(GEE_2008_Soc) 

##2009

GEE_2009<- GEE_search_clean[grep("^2009",GEE_search_clean[,2]),]


GEE_2009_Bio<- GEE_2009[grep("^/Biology and life sciences",GEE_2009[,1]),2]

GEE_2009_Bio_count<- length(GEE_2009_Bio)

GEE_2009_Phys<- GEE_2009[grep("^/Physical sciences",GEE_2009[,1]),2]

GEE_2009_Phys_count<- length(GEE_2009_Phys) 

GEE_2009_Med<- GEE_2009[grep("^/Medicine and health sciences",GEE_2009[,1]),2]

GEE_2009_Med_count<- length(GEE_2009_Med) 

GEE_2009_Res<- GEE_2009[grep("^/Research and analysis methods",GEE_2009[,1]),2]

GEE_2009_Res_count<- length(GEE_2009_Res) 

GEE_2009_Earth<- GEE_2009[grep("^/Earth sciences",GEE_2009[,1]),2]

GEE_2009_Earth_count<- length(GEE_2009_Earth) 

GEE_2009_Comp<- GEE_2009[grep("^/Computer and information sciences",GEE_2009[,1]),2]

GEE_2009_Comp_count<- length(GEE_2009_Comp) 

GEE_2009_Eng<- GEE_2009[grep("^/Engineering and technology",GEE_2009[,1]),2]

GEE_2009_Eng_count<- length(GEE_2009_Eng) 

GEE_2009_Soc<- GEE_2009[grep("^/Social sciences",GEE_2009[,1]),2]

GEE_2009_Soc_count<- length(GEE_2009_Soc)

### GEE 2010

GEE_2010<- GEE_search_clean[grep("^2010",GEE_search_clean[,2]),]


GEE_2010_Bio<- GEE_2010[grep("^/Biology and life sciences",GEE_2010[,1]),2]

GEE_2010_Bio_count<- length(GEE_2010_Bio)

GEE_2010_Phys<- GEE_2010[grep("^/Physical sciences",GEE_2010[,1]),2]

GEE_2010_Phys_count<- length(GEE_2010_Phys) 

GEE_2010_Med<- GEE_2010[grep("^/Medicine and health sciences",GEE_2010[,1]),2]

GEE_2010_Med_count<- length(GEE_2010_Med) 

GEE_2010_Res<- GEE_2010[grep("^/Research and analysis methods",GEE_2010[,1]),2]

GEE_2010_Res_count<- length(GEE_2010_Res) 

GEE_2010_Earth<- GEE_2010[grep("^/Earth sciences",GEE_2010[,1]),2]

GEE_2010_Earth_count<- length(GEE_2010_Earth) 

GEE_2010_Comp<- GEE_2010[grep("^/Computer and information sciences",GEE_2010[,1]),2]

GEE_2010_Comp_count<- length(GEE_2010_Comp) 

GEE_2010_Eng<- GEE_2010[grep("^/Engineering and technology",GEE_2010[,1]),2]

GEE_2010_Eng_count<- length(GEE_2010_Eng) 

GEE_2010_Soc<- GEE_2010[grep("^/Social sciences",GEE_2010[,1]),2]

GEE_2010_Soc_count<- length(GEE_2010_Soc)

###2011 GEE

GEE_2011<- GEE_search_clean[grep("^2011",GEE_search_clean[,2]),]


GEE_2011_Bio<- GEE_2011[grep("^/Biology and life sciences",GEE_2011[,1]),2]

GEE_2011_Bio_count<- length(GEE_2011_Bio)

GEE_2011_Phys<- GEE_2011[grep("^/Physical sciences",GEE_2011[,1]),2]

GEE_2011_Phys_count<- length(GEE_2011_Phys) 

GEE_2011_Med<- GEE_2011[grep("^/Medicine and health sciences",GEE_2011[,1]),2]

GEE_2011_Med_count<- length(GEE_2011_Med) 

GEE_2011_Res<- GEE_2011[grep("^/Research and analysis methods",GEE_2011[,1]),2]

GEE_2011_Res_count<- length(GEE_2011_Res) 

GEE_2011_Earth<- GEE_2011[grep("^/Earth sciences",GEE_2011[,1]),2]

GEE_2011_Earth_count<- length(GEE_2011_Earth) 

GEE_2011_Comp<- GEE_2011[grep("^/Computer and information sciences",GEE_2011[,1]),2]

GEE_2011_Comp_count<- length(GEE_2011_Comp) 

GEE_2011_Eng<- GEE_2011[grep("^/Engineering and technology",GEE_2011[,1]),2]

GEE_2011_Eng_count<- length(GEE_2011_Eng) 

GEE_2011_Soc<- GEE_2011[grep("^/Social sciences",GEE_2011[,1]),2]

GEE_2011_Soc_count<- length(GEE_2011_Soc)

###GEE 2012
GEE_2012<- GEE_search_clean[grep("^2012",GEE_search_clean[,2]),]


GEE_2012_Bio<- GEE_2012[grep("^/Biology and life sciences",GEE_2012[,1]),2]

GEE_2012_Bio_count<- length(GEE_2012_Bio)

GEE_2012_Phys<- GEE_2012[grep("^/Physical sciences",GEE_2012[,1]),2]

GEE_2012_Phys_count<- length(GEE_2012_Phys) 

GEE_2012_Med<- GEE_2012[grep("^/Medicine and health sciences",GEE_2012[,1]),2]

GEE_2012_Med_count<- length(GEE_2012_Med) 

GEE_2012_Res<- GEE_2012[grep("^/Research and analysis methods",GEE_2012[,1]),2]

GEE_2012_Res_count<- length(GEE_2012_Res) 

GEE_2012_Earth<- GEE_2012[grep("^/Earth sciences",GEE_2012[,1]),2]

GEE_2012_Earth_count<- length(GEE_2012_Earth) 

GEE_2012_Comp<- GEE_2012[grep("^/Computer and information sciences",GEE_2012[,1]),2]

GEE_2012_Comp_count<- length(GEE_2012_Comp) 

GEE_2012_Eng<- GEE_2012[grep("^/Engineering and technology",GEE_2012[,1]),2]

GEE_2012_Eng_count<- length(GEE_2012_Eng) 

GEE_2012_Soc<- GEE_2012[grep("^/Social sciences",GEE_2012[,1]),2]

GEE_2012_Soc_count<- length(GEE_2012_Soc)

##GEE 2013

GEE_2013<- GEE_search_clean[grep("^2013",GEE_search_clean[,2]),]


GEE_2013_Bio<- GEE_2013[grep("^/Biology and life sciences",GEE_2013[,1]),2]

GEE_2013_Bio_count<- length(GEE_2013_Bio)

GEE_2013_Phys<- GEE_2013[grep("^/Physical sciences",GEE_2013[,1]),2]

GEE_2013_Phys_count<- length(GEE_2013_Phys) 

GEE_2013_Med<- GEE_2013[grep("^/Medicine and health sciences",GEE_2013[,1]),2]

GEE_2013_Med_count<- length(GEE_2013_Med) 

GEE_2013_Res<- GEE_2013[grep("^/Research and analysis methods",GEE_2013[,1]),2]

GEE_2013_Res_count<- length(GEE_2013_Res) 

GEE_2013_Earth<- GEE_2013[grep("^/Earth sciences",GEE_2013[,1]),2]

GEE_2013_Earth_count<- length(GEE_2013_Earth) 

GEE_2013_Comp<- GEE_2013[grep("^/Computer and information sciences",GEE_2013[,1]),2]

GEE_2013_Comp_count<- length(GEE_2013_Comp) 

GEE_2013_Eng<- GEE_2013[grep("^/Engineering and technology",GEE_2013[,1]),2]

GEE_2013_Eng_count<- length(GEE_2013_Eng) 

GEE_2013_Soc<- GEE_2013[grep("^/Social sciences",GEE_2013[,1]),2]

GEE_2013_Soc_count<- length(GEE_2013_Soc)

###GEE 2014

GEE_2014<- GEE_search_clean[grep("^2014",GEE_search_clean[,2]),]

GEE_2014_Bio<- GEE_2014[grep("^/Biology and life sciences",GEE_2014[,1]),2]

GEE_2014_Bio_count<- length(GEE_2014_Bio)

GEE_2014_Phys<- GEE_2014[grep("^/Physical sciences",GEE_2014[,1]),2]

GEE_2014_Phys_count<- length(GEE_2014_Phys) 

GEE_2014_Med<- GEE_2014[grep("^/Medicine and health sciences",GEE_2014[,1]),2]

GEE_2014_Med_count<- length(GEE_2014_Med) 

GEE_2014_Res<- GEE_2014[grep("^/Research and analysis methods",GEE_2014[,1]),2]

GEE_2014_Res_count<- length(GEE_2014_Res) 

GEE_2014_Earth<- GEE_2014[grep("^/Earth sciences",GEE_2014[,1]),2]

GEE_2014_Earth_count<- length(GEE_2014_Earth) 

GEE_2014_Comp<- GEE_2014[grep("^/Computer and information sciences",GEE_2014[,1]),2]

GEE_2014_Comp_count<- length(GEE_2014_Comp) 

GEE_2014_Eng<- GEE_2014[grep("^/Engineering and technology",GEE_2014[,1]),2]

GEE_2014_Eng_count<- length(GEE_2014_Eng) 

GEE_2014_Soc<- GEE_2014[grep("^/Social sciences",GEE_2014[,1]),2]

GEE_2014_Soc_count<- length(GEE_2014_Soc)

### GEE 2015

GEE_2015<- GEE_search_clean[grep("^2015",GEE_search_clean[,2]),]


GEE_2015_Bio<- GEE_2015[grep("^/Biology and life sciences",GEE_2015[,1]),2]

GEE_2015_Bio_count<- length(GEE_2015_Bio)

GEE_2015_Phys<- GEE_2015[grep("^/Physical sciences",GEE_2015[,1]),2]

GEE_2015_Phys_count<- length(GEE_2015_Phys) 

GEE_2015_Med<- GEE_2015[grep("^/Medicine and health sciences",GEE_2015[,1]),2]

GEE_2015_Med_count<- length(GEE_2015_Med) 

GEE_2015_Res<- GEE_2015[grep("^/Research and analysis methods",GEE_2015[,1]),2]

GEE_2015_Res_count<- length(GEE_2015_Res) 

GEE_2015_Earth<- GEE_2015[grep("^/Earth sciences",GEE_2015[,1]),2]

GEE_2015_Earth_count<- length(GEE_2015_Earth) 

GEE_2015_Comp<- GEE_2015[grep("^/Computer and information sciences",GEE_2015[,1]),2]

GEE_2015_Comp_count<- length(GEE_2015_Comp) 

GEE_2015_Eng<- GEE_2015[grep("^/Engineering and technology",GEE_2015[,1]),2]

GEE_2015_Eng_count<- length(GEE_2015_Eng) 

GEE_2015_Soc<- GEE_2015[grep("^/Social sciences",GEE_2015[,1]),2]

GEE_2015_Soc_count<- length(GEE_2015_Soc)

##GEE 2016

GEE_2016<- GEE_search_clean[grep("^2016",GEE_search_clean[,2]),]


GEE_2016_Bio<- GEE_2016[grep("^/Biology and life sciences",GEE_2016[,1]),2]

GEE_2016_Bio_count<- length(GEE_2016_Bio)

GEE_2016_Phys<- GEE_2016[grep("^/Physical sciences",GEE_2016[,1]),2]

GEE_2016_Phys_count<- length(GEE_2016_Phys) 

GEE_2016_Med<- GEE_2016[grep("^/Medicine and health sciences",GEE_2016[,1]),2]

GEE_2016_Med_count<- length(GEE_2016_Med) 

GEE_2016_Res<- GEE_2016[grep("^/Research and analysis methods",GEE_2016[,1]),2]

GEE_2016_Res_count<- length(GEE_2016_Res) 

GEE_2016_Earth<- GEE_2016[grep("^/Earth sciences",GEE_2016[,1]),2]

GEE_2016_Earth_count<- length(GEE_2016_Earth) 

GEE_2016_Comp<- GEE_2016[grep("^/Computer and information sciences",GEE_2016[,1]),2]

GEE_2016_Comp_count<- length(GEE_2016_Comp) 

GEE_2016_Eng<- GEE_2016[grep("^/Engineering and technology",GEE_2016[,1]),2]

GEE_2016_Eng_count<- length(GEE_2016_Eng) 

GEE_2016_Soc<- GEE_2016[grep("^/Social sciences",GEE_2016[,1]),2]

GEE_2016_Soc_count<- length(GEE_2016_Soc)

## GEE 2017

GEE_2017<- GEE_search_clean[grep("^2017",GEE_search_clean[,2]),]
dim(GEE_2017)

GEE_2017_Bio<- GEE_2017[grep("^/Biology and life sciences",GEE_2017[,1]),2]

GEE_2017_Bio_count<- length(GEE_2017_Bio)

GEE_2017_Phys<- GEE_2017[grep("^/Physical sciences",GEE_2017[,1]),2]

GEE_2017_Phys_count<- length(GEE_2017_Phys) 

GEE_2017_Med<- GEE_2017[grep("^/Medicine and health sciences",GEE_2017[,1]),2]

GEE_2017_Med_count<- length(GEE_2017_Med) 

GEE_2017_Res<- GEE_2017[grep("^/Research and analysis methods",GEE_2017[,1]),2]

GEE_2017_Res_count<- length(GEE_2017_Res) 

GEE_2017_Earth<- GEE_2017[grep("^/Earth sciences",GEE_2017[,1]),2]

GEE_2017_Earth_count<- length(GEE_2017_Earth) 

GEE_2017_Comp<- GEE_2017[grep("^/Computer and information sciences",GEE_2017[,1]),2]

GEE_2017_Comp_count<- length(GEE_2017_Comp) 

GEE_2017_Eng<- GEE_2017[grep("^/Engineering and technology",GEE_2017[,1]),2]

GEE_2017_Eng_count<- length(GEE_2017_Eng) 

GEE_2017_Soc<- GEE_2017[grep("^/Social sciences",GEE_2017[,1]),2]

GEE_2017_Soc_count<- length(GEE_2017_Soc)

############ GEE counts table


GEE_counts_2004_bio<- c(GEE_2004_Bio_count,1,rep(0,13),1,rep(0,7))
GEE_counts_2004_Comp<- c(GEE_2004_Comp_count,1,rep(0,13),0,1,rep(0,6))
GEE_counts_2004_Earth<-c(GEE_2004_Earth_count,1,rep(0,13),0,0,1,rep(0,5))
GEE_counts_2004_Eng<- c(GEE_2004_Eng_count,1,rep(0,13),0,0,0,1,rep(0,4))
GEE_counts_2004_Med<- c(GEE_2004_Med_count,1,rep(0,13),rep(0,4),1,0,0,0)
GEE_counts_2004_Phys<- c(GEE_2004_Phys_count,1,rep(0,13),rep(0,5),1,0,0)
GEE_count_2004_Res<-c(GEE_2004_Res_count,1,rep(0,13),rep(0,6),1,0)
GEE_count_2004_Soc<-c(GEE_2004_Soc_count,1,rep(0,13),rep(0,7),1)

GEE_counts_2005_bio<- c(GEE_2005_Bio_count,0,1,rep(0,12),1,rep(0,7))
GEE_counts_2005_Comp<- c(GEE_2005_Comp_count,0,1,rep(0,12),0,1,rep(0,6))
GEE_counts_2005_Earth<-c(GEE_2005_Earth_count,0,1,rep(0,12),0,0,1,rep(0,5))
GEE_counts_2005_Eng<- c(GEE_2005_Eng_count,0,1,rep(0,12),0,0,0,1,rep(0,4))
GEE_counts_2005_Med<- c(GEE_2005_Med_count,0,1,rep(0,12),rep(0,4),1,0,0,0)
GEE_counts_2005_Phys<- c(GEE_2005_Phys_count,0,1,rep(0,12),rep(0,5),1,0,0)
GEE_count_2005_Res<-c(GEE_2005_Res_count,0,1,rep(0,12),rep(0,6),1,0)
GEE_count_2005_Soc<-c(GEE_2005_Soc_count,0,1,rep(0,12),rep(0,7),1)

GEE_counts_2006_bio<- c(GEE_2006_Bio_count,0,0,1,rep(0,11),1,rep(0,7))
GEE_counts_2006_Comp<- c(GEE_2006_Comp_count,0,0,1,rep(0,11),0,1,rep(0,6))
GEE_counts_2006_Earth<-c(GEE_2006_Earth_count,0,0,1,rep(0,11),0,0,1,rep(0,5))
GEE_counts_2006_Eng<- c(GEE_2006_Eng_count,0,0,1,rep(0,11),0,0,0,1,rep(0,4))
GEE_counts_2006_Med<- c(GEE_2006_Med_count,0,0,1,rep(0,11),rep(0,4),1,0,0,0)
GEE_counts_2006_Phys<- c(GEE_2006_Phys_count,0,0,1,rep(0,11),rep(0,5),1,0,0)
GEE_count_2006_Res<-c(GEE_2006_Res_count,0,0,1,rep(0,11),rep(0,6),1,0)
GEE_count_2006_Soc<-c(GEE_2006_Soc_count,0,0,1,rep(0,11),rep(0,7),1)

GEE_counts_2007_bio<- c(GEE_2007_Bio_count,0,0,0,1,rep(0,10),1,rep(0,7))
GEE_counts_2007_Comp<- c(GEE_2007_Comp_count,0,0,0,1,rep(0,10),0,1,rep(0,6))
GEE_counts_2007_Earth<-c(GEE_2007_Earth_count,0,0,0,1,rep(0,10),0,0,1,rep(0,5))
GEE_counts_2007_Eng<- c(GEE_2007_Eng_count,0,0,0,1,rep(0,10),0,0,0,1,rep(0,4))
GEE_counts_2007_Med<- c(GEE_2007_Med_count,0,0,0,1,rep(0,10),rep(0,4),1,0,0,0)
GEE_counts_2007_Phys<- c(GEE_2007_Phys_count,0,0,0,1,rep(0,10),rep(0,5),1,0,0)
GEE_count_2007_Res<-c(GEE_2007_Res_count,0,0,0,1,rep(0,10),rep(0,6),1,0)
GEE_count_2007_Soc<-c(GEE_2007_Soc_count,0,0,0,1,rep(0,10),rep(0,7),1)

GEE_counts_2008_bio<- c(GEE_2008_Bio_count,rep(0,4),1,rep(0,9),1,rep(0,7))
GEE_counts_2008_Comp<- c(GEE_2008_Comp_count,rep(0,4),1,rep(0,9),0,1,rep(0,6))
GEE_counts_2008_Earth<-c(GEE_2008_Earth_count,rep(0,4),1,rep(0,9),0,0,1,rep(0,5))
GEE_counts_2008_Eng<- c(GEE_2008_Eng_count,rep(0,4),1,rep(0,9),0,0,0,1,rep(0,4))
GEE_counts_2008_Med<- c(GEE_2008_Med_count,rep(0,4),1,rep(0,9),rep(0,4),1,0,0,0)
GEE_counts_2008_Phys<- c(GEE_2008_Phys_count,rep(0,4),1,rep(0,9),rep(0,5),1,0,0)
GEE_count_2008_Res<-c(GEE_2008_Res_count,rep(0,4),1,rep(0,9),rep(0,6),1,0)
GEE_count_2008_Soc<-c(GEE_2008_Soc_count,rep(0,4),1,rep(0,9),rep(0,7),1)


GEE_counts_2009_bio<- c(GEE_2009_Bio_count,rep(0,5),1,rep(0,8),1,rep(0,7))
GEE_counts_2009_Comp<- c(GEE_2009_Comp_count,rep(0,5),1,rep(0,8),0,1,rep(0,6))
GEE_counts_2009_Earth<-c(GEE_2009_Earth_count,rep(0,5),1,rep(0,8),0,0,1,rep(0,5))
GEE_counts_2009_Eng<- c(GEE_2009_Eng_count,rep(0,5),1,rep(0,8),0,0,0,1,rep(0,4))
GEE_counts_2009_Med<- c(GEE_2009_Med_count,rep(0,5),1,rep(0,8),rep(0,4),1,0,0,0)
GEE_counts_2009_Phys<- c(GEE_2009_Phys_count,rep(0,5),1,rep(0,8),rep(0,5),1,0,0)
GEE_count_2009_Res<-c(GEE_2009_Res_count,rep(0,5),1,rep(0,8),rep(0,6),1,0)
GEE_count_2009_Soc<-c(GEE_2009_Soc_count,rep(0,5),1,rep(0,8),rep(0,7),1)

GEE_counts_2010_bio<- c(GEE_2010_Bio_count,rep(0,6),1,rep(0,7),1,rep(0,7))
GEE_counts_2010_Comp<- c(GEE_2010_Comp_count,rep(0,6),1,rep(0,7),0,1,rep(0,6))
GEE_counts_2010_Earth<-c(GEE_2010_Earth_count,rep(0,6),1,rep(0,7),0,0,1,rep(0,5))
GEE_counts_2010_Eng<- c(GEE_2010_Eng_count,rep(0,6),1,rep(0,7),0,0,0,1,rep(0,4))
GEE_counts_2010_Med<- c(GEE_2010_Med_count,rep(0,6),1,rep(0,7),rep(0,4),1,0,0,0)
GEE_counts_2010_Phys<- c(GEE_2010_Phys_count,rep(0,6),1,rep(0,7),rep(0,5),1,0,0)
GEE_count_2010_Res<-c(GEE_2010_Res_count,rep(0,6),1,rep(0,7),rep(0,6),1,0)
GEE_count_2010_Soc<-c(GEE_2010_Soc_count,rep(0,6),1,rep(0,7),rep(0,7),1)


GEE_counts_2011_bio<- c(GEE_2011_Bio_count,rep(0,7),1,rep(0,6),1,rep(0,7))
GEE_counts_2011_Comp<- c(GEE_2011_Comp_count,rep(0,7),1,rep(0,6),0,1,rep(0,6))
GEE_counts_2011_Earth<-c(GEE_2011_Earth_count,rep(0,7),1,rep(0,6),0,0,1,rep(0,5))
GEE_counts_2011_Eng<- c(GEE_2011_Eng_count,rep(0,7),1,rep(0,6),0,0,0,1,rep(0,4))
GEE_counts_2011_Med<- c(GEE_2011_Med_count,rep(0,7),1,rep(0,6),rep(0,4),1,0,0,0)
GEE_counts_2011_Phys<- c(GEE_2011_Phys_count,rep(0,7),1,rep(0,6),rep(0,5),1,0,0)
GEE_count_2011_Res<-c(GEE_2011_Res_count,rep(0,7),1,rep(0,6),rep(0,6),1,0)
GEE_count_2011_Soc<-c(GEE_2011_Soc_count,rep(0,7),1,rep(0,6),rep(0,7),1)

GEE_counts_2012_bio<- c(GEE_2012_Bio_count,rep(0,8),1,rep(0,5),1,rep(0,7))
GEE_counts_2012_Comp<- c(GEE_2012_Comp_count,rep(0,8),1,rep(0,5),0,1,rep(0,6))
GEE_counts_2012_Earth<-c(GEE_2012_Earth_count,rep(0,8),1,rep(0,5),0,0,1,rep(0,5))
GEE_counts_2012_Eng<- c(GEE_2012_Eng_count,rep(0,8),1,rep(0,5),0,0,0,1,rep(0,4))
GEE_counts_2012_Med<- c(GEE_2012_Med_count,rep(0,8),1,rep(0,5),rep(0,4),1,0,0,0)
GEE_counts_2012_Phys<- c(GEE_2012_Phys_count,rep(0,8),1,rep(0,5),rep(0,5),1,0,0)
GEE_count_2012_Res<-c(GEE_2012_Res_count,rep(0,8),1,rep(0,5),rep(0,6),1,0)
GEE_count_2012_Soc<-c(GEE_2012_Soc_count,rep(0,8),1,rep(0,5),rep(0,7),1)

GEE_counts_2013_bio<- c(GEE_2013_Bio_count,rep(0,9),1,rep(0,4),1,rep(0,7))
GEE_counts_2013_Comp<- c(GEE_2013_Comp_count,rep(0,9),1,rep(0,4),0,1,rep(0,6))
GEE_counts_2013_Earth<-c(GEE_2013_Earth_count,rep(0,9),1,rep(0,4),0,0,1,rep(0,5))
GEE_counts_2013_Eng<- c(GEE_2013_Eng_count,rep(0,9),1,rep(0,4),0,0,0,1,rep(0,4))
GEE_counts_2013_Med<- c(GEE_2013_Med_count,rep(0,9),1,rep(0,4),rep(0,4),1,0,0,0)
GEE_counts_2013_Phys<- c(GEE_2013_Phys_count,rep(0,9),1,rep(0,4),rep(0,5),1,0,0)
GEE_count_2013_Res<-c(GEE_2013_Res_count,rep(0,9),1,rep(0,4),rep(0,6),1,0)
GEE_count_2013_Soc<-c(GEE_2013_Soc_count,rep(0,9),1,rep(0,4),rep(0,7),1)

GEE_counts_2014_bio<- c(GEE_2014_Bio_count,rep(0,10),1,rep(0,3),1,rep(0,7))
GEE_counts_2014_Comp<- c(GEE_2014_Comp_count,rep(0,10),1,rep(0,3),0,1,rep(0,6))
GEE_counts_2014_Earth<-c(GEE_2014_Earth_count,rep(0,10),1,rep(0,3),0,0,1,rep(0,5))
GEE_counts_2014_Eng<- c(GEE_2014_Eng_count,rep(0,10),1,rep(0,3),0,0,0,1,rep(0,4))
GEE_counts_2014_Med<- c(GEE_2014_Med_count,rep(0,10),1,rep(0,3),rep(0,4),1,0,0,0)
GEE_counts_2014_Phys<- c(GEE_2014_Phys_count,rep(0,10),1,rep(0,3),rep(0,5),1,0,0)
GEE_count_2014_Res<-c(GEE_2014_Res_count,rep(0,10),1,rep(0,3),rep(0,6),1,0)
GEE_count_2014_Soc<-c(GEE_2014_Soc_count,rep(0,10),1,rep(0,3),rep(0,7),1)

GEE_counts_2015_bio<- c(GEE_2015_Bio_count,rep(0,11),1,rep(0,2),1,rep(0,7))
GEE_counts_2015_Comp<- c(GEE_2015_Comp_count,rep(0,11),1,rep(0,2),0,1,rep(0,6))
GEE_counts_2015_Earth<-c(GEE_2015_Earth_count,rep(0,11),1,rep(0,2),0,0,1,rep(0,5))
GEE_counts_2015_Eng<- c(GEE_2015_Eng_count,rep(0,11),1,rep(0,2),0,0,0,1,rep(0,4))
GEE_counts_2015_Med<- c(GEE_2015_Med_count,rep(0,11),1,rep(0,2),rep(0,4),1,0,0,0)
GEE_counts_2015_Phys<- c(GEE_2015_Phys_count,rep(0,11),1,rep(0,2),rep(0,5),1,0,0)
GEE_count_2015_Res<-c(GEE_2015_Res_count,rep(0,11),1,rep(0,2),rep(0,6),1,0)
GEE_count_2015_Soc<-c(GEE_2015_Soc_count,rep(0,11),1,rep(0,2),rep(0,7),1)

GEE_counts_2016_bio<- c(GEE_2016_Bio_count,rep(0,12),1,rep(0,1),1,rep(0,7))
GEE_counts_2016_Comp<- c(GEE_2016_Comp_count,rep(0,12),1,rep(0,1),0,1,rep(0,6))
GEE_counts_2016_Earth<-c(GEE_2016_Earth_count,rep(0,12),1,rep(0,1),0,0,1,rep(0,5))
GEE_counts_2016_Eng<- c(GEE_2016_Eng_count,rep(0,12),1,rep(0,1),0,0,0,1,rep(0,4))
GEE_counts_2016_Med<- c(GEE_2016_Med_count,rep(0,12),1,rep(0,1),rep(0,4),1,0,0,0)
GEE_counts_2016_Phys<- c(GEE_2016_Phys_count,rep(0,12),1,rep(0,1),rep(0,5),1,0,0)
GEE_count_2016_Res<-c(GEE_2016_Res_count,rep(0,12),1,rep(0,1),rep(0,6),1,0)
GEE_count_2016_Soc<-c(GEE_2016_Soc_count,rep(0,12),1,rep(0,1),rep(0,7),1)

GEE_counts_2017_bio<- c(GEE_2017_Bio_count,rep(0,13),1,1,rep(0,7))
GEE_counts_2017_Comp<- c(GEE_2017_Comp_count,rep(0,13),1,0,1,rep(0,6))
GEE_counts_2017_Earth<-c(GEE_2017_Earth_count,rep(0,13),1,0,0,1,rep(0,5))
GEE_counts_2017_Eng<- c(GEE_2017_Eng_count,rep(0,13),1,0,0,0,1,rep(0,4))
GEE_counts_2017_Med<- c(GEE_2017_Med_count,rep(0,13),1,rep(0,4),1,0,0,0)
GEE_counts_2017_Phys<- c(GEE_2017_Phys_count,rep(0,13),1,rep(0,5),1,0,0)
GEE_count_2017_Res<-c(GEE_2017_Res_count,rep(0,13),1,rep(0,6),1,0)
GEE_count_2017_Soc<-c(GEE_2017_Soc_count,rep(0,13),1,rep(0,7),1)

GEE_table<- rbind(GEE_counts_2004_bio,GEE_counts_2004_Comp,GEE_counts_2004_Earth,
                    GEE_counts_2004_Eng,GEE_counts_2004_Med,GEE_counts_2004_Phys,
                    GEE_count_2004_Res,GEE_count_2004_Soc,GEE_counts_2005_bio,
                    GEE_counts_2005_Comp,GEE_counts_2005_Earth,GEE_counts_2005_Eng,
                    GEE_counts_2005_Med,GEE_counts_2005_Phys,GEE_count_2005_Res,
                    GEE_count_2005_Soc,GEE_counts_2006_bio,
                    GEE_counts_2006_Comp,GEE_counts_2006_Earth,GEE_counts_2006_Eng,
                    GEE_counts_2006_Med,GEE_counts_2006_Phys,GEE_count_2006_Res,
                    GEE_count_2006_Soc,GEE_counts_2007_bio,
                    GEE_counts_2007_Comp,GEE_counts_2007_Earth,GEE_counts_2007_Eng,
                    GEE_counts_2007_Med,GEE_counts_2007_Phys,GEE_count_2007_Res,
                    GEE_count_2007_Soc, GEE_counts_2008_bio,
                    GEE_counts_2008_Comp,GEE_counts_2008_Earth,GEE_counts_2008_Eng,
                    GEE_counts_2008_Med,GEE_counts_2008_Phys,GEE_count_2008_Res,
                    GEE_count_2008_Soc, GEE_counts_2009_bio,
                    GEE_counts_2009_Comp,GEE_counts_2009_Earth,GEE_counts_2009_Eng,
                    GEE_counts_2009_Med,GEE_counts_2009_Phys,GEE_count_2009_Res,
                    GEE_count_2009_Soc,GEE_counts_2010_bio,
                    GEE_counts_2010_Comp,GEE_counts_2010_Earth,GEE_counts_2010_Eng,
                    GEE_counts_2010_Med,GEE_counts_2010_Phys,GEE_count_2010_Res,
                    GEE_count_2010_Soc,GEE_counts_2011_bio,
                    GEE_counts_2011_Comp,GEE_counts_2011_Earth,GEE_counts_2011_Eng,
                    GEE_counts_2011_Med,GEE_counts_2011_Phys,GEE_count_2011_Res,
                    GEE_count_2011_Soc,GEE_counts_2012_bio,
                    GEE_counts_2012_Comp,GEE_counts_2012_Earth,GEE_counts_2012_Eng,
                    GEE_counts_2012_Med,GEE_counts_2012_Phys,GEE_count_2012_Res,
                    GEE_count_2012_Soc, GEE_counts_2013_bio,
                    GEE_counts_2013_Comp,GEE_counts_2013_Earth,GEE_counts_2013_Eng,
                    GEE_counts_2013_Med,GEE_counts_2013_Phys,GEE_count_2013_Res,
                    GEE_count_2013_Soc, GEE_counts_2014_bio,
                    GEE_counts_2014_Comp,GEE_counts_2014_Earth,GEE_counts_2014_Eng,
                    GEE_counts_2014_Med,GEE_counts_2014_Phys,GEE_count_2014_Res,
                    GEE_count_2014_Soc,GEE_counts_2015_bio,
                    GEE_counts_2015_Comp,GEE_counts_2015_Earth,GEE_counts_2015_Eng,
                    GEE_counts_2015_Med,GEE_counts_2015_Phys,GEE_count_2015_Res,
                    GEE_count_2015_Soc,GEE_counts_2016_bio,
                    GEE_counts_2016_Comp,GEE_counts_2016_Earth,GEE_counts_2016_Eng,
                    GEE_counts_2016_Med,GEE_counts_2016_Phys,GEE_count_2016_Res,
                    GEE_count_2016_Soc, GEE_counts_2017_bio,
                    GEE_counts_2017_Comp,GEE_counts_2017_Earth,GEE_counts_2017_Eng,
                    GEE_counts_2017_Med,GEE_counts_2017_Phys,GEE_count_2017_Res,
                    GEE_count_2017_Soc)

GEE_table[97:112,]
as.data.frame(GEE_table)

colnames(GEE_table)<- c("GEE_counts","2004","2005","2006","2007","2008","2009",
                          "2010","2011","2012","2013","2014","2015","2016","2017",
                          "Biology and life sciences","Computer and information sciences",
                          "Earth sciences","Engineering and tecnhology",
                          "Medicine and health sciences","Physical sciences",
                          "Research and analysis","Social Sciences")

as.numeric(GEE_table[,1])

year_covs<- GEE_table[,2:15]

terms_covs<- GEE_table[,16:23]

########### GEE model fit #################

model_GEE<- glm(GEE_table[,1]~year_covs*terms_covs, family="poisson")

summary(model_GEE)

##################### Bootstrap counts assembly ##################


btstp_search<- searchplos(q="bootstrap",fl=c("subject","publication_date"),limit=10000)

btstp_search_clean<- matrix(unlist(btstp_search[[2]]),ncol=2)



###btstp 2004
btstp_2004<- btstp_search_clean[grep("^2004",btstp_search_clean[,2]),]


btstp_2004_Bio<- btstp_2004[grep("^/Biology and life sciences",btstp_2004[,1]),2]

btstp_2004_Bio_count<- length(btstp_2004_Bio)

btstp_2004_Phys<- btstp_2004[grep("^/Physical sciences",btstp_2004[,1]),2]

btstp_2004_Phys_count<- length(btstp_2004_Phys) 

btstp_2004_Med<- btstp_2004[grep("^/Medicine and health sciences",btstp_2004[,1]),2]

btstp_2004_Med_count<- length(btstp_2004_Med) 

btstp_2004_Res<- btstp_2004[grep("^/Research and analysis methods",btstp_2004[,1]),2]

btstp_2004_Res_count<- length(btstp_2004_Res) 

btstp_2004_Earth<- btstp_2004[grep("^/Earth sciences",btstp_2004[,1]),2]

btstp_2004_Earth_count<- length(btstp_2004_Earth) 

btstp_2004_Comp<- btstp_2004[grep("^/Computer and information sciences",btstp_2004[,1]),2]

btstp_2004_Comp_count<- length(btstp_2004_Comp) 

btstp_2004_Eng<- btstp_2004[grep("^/Engineering and technology",btstp_2004[,1]),2]

btstp_2004_Eng_count<- length(btstp_2004_Eng) 

btstp_2004_Soc<- btstp_2004[grep("^/Social sciences",btstp_2004[,1]),2]

btstp_2004_Soc_count<- length(btstp_2004_Soc) 


########btstp 2005

btstp_2005<- btstp_search_clean[grep("^2005",btstp_search_clean[,2]),]


btstp_2005_Bio<- btstp_2005[grep("^/Biology and life sciences",btstp_2005[,1]),2]

btstp_2005_Bio_count<- length(btstp_2005_Bio)

btstp_2005_Phys<- btstp_2005[grep("^/Physical sciences",btstp_2005[,1]),2]

btstp_2005_Phys_count<- length(btstp_2005_Phys) 

btstp_2005_Med<- btstp_2005[grep("^/Medicine and health sciences",btstp_2005[,1]),2]

btstp_2005_Med_count<- length(btstp_2005_Med) 

btstp_2005_Res<- btstp_2005[grep("^/Research and analysis methods",btstp_2005[,1]),2]

btstp_2005_Res_count<- length(btstp_2005_Res) 

btstp_2005_Earth<- btstp_2005[grep("^/Earth sciences",btstp_2005[,1]),2]

btstp_2005_Earth_count<- length(btstp_2005_Earth) 

btstp_2005_Comp<- btstp_2005[grep("^/Computer and information sciences",btstp_2005[,1]),2]

btstp_2005_Comp_count<- length(btstp_2005_Comp) 

btstp_2005_Eng<- btstp_2005[grep("^/Engineering and technology",btstp_2005[,1]),2]

btstp_2005_Eng_count<- length(btstp_2005_Eng) 

btstp_2005_Soc<- btstp_2005[grep("^/Social sciences",btstp_2005[,1]),2]

btstp_2005_Soc_count<- length(btstp_2005_Soc) 


###### btstp 2006


btstp_2006<- btstp_search_clean[grep("^2006",btstp_search_clean[,2]),]


btstp_2006_Bio<- btstp_2006[grep("^/Biology and life sciences",btstp_2006[,1]),2]

btstp_2006_Bio_count<- length(btstp_2006_Bio)

btstp_2006_Phys<- btstp_2006[grep("^/Physical sciences",btstp_2006[,1]),2]

btstp_2006_Phys_count<- length(btstp_2006_Phys) 

btstp_2006_Med<- btstp_2006[grep("^/Medicine and health sciences",btstp_2006[,1]),2]

btstp_2006_Med_count<- length(btstp_2006_Med) 

btstp_2006_Res<- btstp_2006[grep("^/Research and analysis methods",btstp_2006[,1]),2]

btstp_2006_Res_count<- length(btstp_2006_Res) 

btstp_2006_Earth<- btstp_2006[grep("^/Earth sciences",btstp_2006[,1]),2]

btstp_2006_Earth_count<- length(btstp_2006_Earth) 

btstp_2006_Comp<- btstp_2006[grep("^/Computer and information sciences",btstp_2006[,1]),2]

btstp_2006_Comp_count<- length(btstp_2006_Comp) 

btstp_2006_Eng<- btstp_2006[grep("^/Engineering and technology",btstp_2006[,1]),2]

btstp_2006_Eng_count<- length(btstp_2006_Eng) 

btstp_2006_Soc<- btstp_2006[grep("^/Social sciences",btstp_2006[,1]),2]

btstp_2006_Soc_count<- length(btstp_2006_Soc) 

## btstp 2007


btstp_2007<- btstp_search_clean[grep("^2007",btstp_search_clean[,2]),]



btstp_2007_Bio<- btstp_2007[grep("^/Biology and life sciences",btstp_2007[,1]),2]

btstp_2007_Bio_count<- length(btstp_2007_Bio)

btstp_2007_Phys<- btstp_2007[grep("^/Physical sciences",btstp_2007[,1]),2]

btstp_2007_Phys_count<- length(btstp_2007_Phys) 

btstp_2007_Med<- btstp_2007[grep("^/Medicine and health sciences",btstp_2007[,1]),2]

btstp_2007_Med_count<- length(btstp_2007_Med) 

btstp_2007_Res<- btstp_2007[grep("^/Research and analysis methods",btstp_2007[,1]),2]

btstp_2007_Res_count<- length(btstp_2007_Res) 

btstp_2007_Earth<- btstp_2007[grep("^/Earth sciences",btstp_2007[,1]),2]

btstp_2007_Earth_count<- length(btstp_2007_Earth) 

btstp_2007_Comp<- btstp_2007[grep("^/Computer and information sciences",btstp_2007[,1]),2]

btstp_2007_Comp_count<- length(btstp_2007_Comp) 

btstp_2007_Eng<- btstp_2007[grep("^/Engineering and technology",btstp_2007[,1]),2]

btstp_2007_Eng_count<- length(btstp_2007_Eng) 

btstp_2007_Soc<- btstp_2007[grep("^/Social sciences",btstp_2007[,1]),2]

btstp_2007_Soc_count<- length(btstp_2007_Soc) 

#### btstp 2008
btstp_2008<- btstp_search_clean[grep("^2008",btstp_search_clean[,2]),]


btstp_2008_Bio<- btstp_2008[grep("^/Biology and life sciences",btstp_2008[,1]),2]

btstp_2008_Bio_count<- length(btstp_2008_Bio)

btstp_2008_Phys<- btstp_2008[grep("^/Physical sciences",btstp_2008[,1]),2]

btstp_2008_Phys_count<- length(btstp_2008_Phys) 

btstp_2008_Med<- btstp_2008[grep("^/Medicine and health sciences",btstp_2008[,1]),2]

btstp_2008_Med_count<- length(btstp_2008_Med) 

btstp_2008_Res<- btstp_2008[grep("^/Research and analysis methods",btstp_2008[,1]),2]

btstp_2008_Res_count<- length(btstp_2008_Res) 

btstp_2008_Earth<- btstp_2008[grep("^/Earth sciences",btstp_2008[,1]),2]

btstp_2008_Earth_count<- length(btstp_2008_Earth) 

btstp_2008_Comp<- btstp_2008[grep("^/Computer and information sciences",btstp_2008[,1]),2]

btstp_2008_Comp_count<- length(btstp_2008_Comp) 

btstp_2008_Eng<- btstp_2008[grep("^/Engineering and technology",btstp_2008[,1]),2]

btstp_2008_Eng_count<- length(btstp_2008_Eng) 

btstp_2008_Soc<- btstp_2008[grep("^/Social sciences",btstp_2008[,1]),2]

btstp_2008_Soc_count<- length(btstp_2008_Soc) 

##2009

btstp_2009<- btstp_search_clean[grep("^2009",btstp_search_clean[,2]),]


btstp_2009_Bio<- btstp_2009[grep("^/Biology and life sciences",btstp_2009[,1]),2]

btstp_2009_Bio_count<- length(btstp_2009_Bio)

btstp_2009_Phys<- btstp_2009[grep("^/Physical sciences",btstp_2009[,1]),2]

btstp_2009_Phys_count<- length(btstp_2009_Phys) 

btstp_2009_Med<- btstp_2009[grep("^/Medicine and health sciences",btstp_2009[,1]),2]

btstp_2009_Med_count<- length(btstp_2009_Med) 

btstp_2009_Res<- btstp_2009[grep("^/Research and analysis methods",btstp_2009[,1]),2]

btstp_2009_Res_count<- length(btstp_2009_Res) 

btstp_2009_Earth<- btstp_2009[grep("^/Earth sciences",btstp_2009[,1]),2]

btstp_2009_Earth_count<- length(btstp_2009_Earth) 

btstp_2009_Comp<- btstp_2009[grep("^/Computer and information sciences",btstp_2009[,1]),2]

btstp_2009_Comp_count<- length(btstp_2009_Comp) 

btstp_2009_Eng<- btstp_2009[grep("^/Engineering and technology",btstp_2009[,1]),2]

btstp_2009_Eng_count<- length(btstp_2009_Eng) 

btstp_2009_Soc<- btstp_2009[grep("^/Social sciences",btstp_2009[,1]),2]

btstp_2009_Soc_count<- length(btstp_2009_Soc)

### btstp 2010

btstp_2010<- btstp_search_clean[grep("^2010",btstp_search_clean[,2]),]


btstp_2010_Bio<- btstp_2010[grep("^/Biology and life sciences",btstp_2010[,1]),2]

btstp_2010_Bio_count<- length(btstp_2010_Bio)

btstp_2010_Phys<- btstp_2010[grep("^/Physical sciences",btstp_2010[,1]),2]

btstp_2010_Phys_count<- length(btstp_2010_Phys) 

btstp_2010_Med<- btstp_2010[grep("^/Medicine and health sciences",btstp_2010[,1]),2]

btstp_2010_Med_count<- length(btstp_2010_Med) 

btstp_2010_Res<- btstp_2010[grep("^/Research and analysis methods",btstp_2010[,1]),2]

btstp_2010_Res_count<- length(btstp_2010_Res) 

btstp_2010_Earth<- btstp_2010[grep("^/Earth sciences",btstp_2010[,1]),2]

btstp_2010_Earth_count<- length(btstp_2010_Earth) 

btstp_2010_Comp<- btstp_2010[grep("^/Computer and information sciences",btstp_2010[,1]),2]

btstp_2010_Comp_count<- length(btstp_2010_Comp) 

btstp_2010_Eng<- btstp_2010[grep("^/Engineering and technology",btstp_2010[,1]),2]

btstp_2010_Eng_count<- length(btstp_2010_Eng) 

btstp_2010_Soc<- btstp_2010[grep("^/Social sciences",btstp_2010[,1]),2]

btstp_2010_Soc_count<- length(btstp_2010_Soc)

###2011 btstp

btstp_2011<- btstp_search_clean[grep("^2011",btstp_search_clean[,2]),]


btstp_2011_Bio<- btstp_2011[grep("^/Biology and life sciences",btstp_2011[,1]),2]

btstp_2011_Bio_count<- length(btstp_2011_Bio)

btstp_2011_Phys<- btstp_2011[grep("^/Physical sciences",btstp_2011[,1]),2]

btstp_2011_Phys_count<- length(btstp_2011_Phys) 

btstp_2011_Med<- btstp_2011[grep("^/Medicine and health sciences",btstp_2011[,1]),2]

btstp_2011_Med_count<- length(btstp_2011_Med) 

btstp_2011_Res<- btstp_2011[grep("^/Research and analysis methods",btstp_2011[,1]),2]

btstp_2011_Res_count<- length(btstp_2011_Res) 

btstp_2011_Earth<- btstp_2011[grep("^/Earth sciences",btstp_2011[,1]),2]

btstp_2011_Earth_count<- length(btstp_2011_Earth) 

btstp_2011_Comp<- btstp_2011[grep("^/Computer and information sciences",btstp_2011[,1]),2]

btstp_2011_Comp_count<- length(btstp_2011_Comp) 

btstp_2011_Eng<- btstp_2011[grep("^/Engineering and technology",btstp_2011[,1]),2]

btstp_2011_Eng_count<- length(btstp_2011_Eng) 

btstp_2011_Soc<- btstp_2011[grep("^/Social sciences",btstp_2011[,1]),2]

btstp_2011_Soc_count<- length(btstp_2011_Soc)

###btstp 2012
btstp_2012<- btstp_search_clean[grep("^2012",btstp_search_clean[,2]),]


btstp_2012_Bio<- btstp_2012[grep("^/Biology and life sciences",btstp_2012[,1]),2]

btstp_2012_Bio_count<- length(btstp_2012_Bio)

btstp_2012_Phys<- btstp_2012[grep("^/Physical sciences",btstp_2012[,1]),2]

btstp_2012_Phys_count<- length(btstp_2012_Phys) 

btstp_2012_Med<- btstp_2012[grep("^/Medicine and health sciences",btstp_2012[,1]),2]

btstp_2012_Med_count<- length(btstp_2012_Med) 

btstp_2012_Res<- btstp_2012[grep("^/Research and analysis methods",btstp_2012[,1]),2]

btstp_2012_Res_count<- length(btstp_2012_Res) 

btstp_2012_Earth<- btstp_2012[grep("^/Earth sciences",btstp_2012[,1]),2]

btstp_2012_Earth_count<- length(btstp_2012_Earth) 

btstp_2012_Comp<- btstp_2012[grep("^/Computer and information sciences",btstp_2012[,1]),2]

btstp_2012_Comp_count<- length(btstp_2012_Comp) 

btstp_2012_Eng<- btstp_2012[grep("^/Engineering and technology",btstp_2012[,1]),2]

btstp_2012_Eng_count<- length(btstp_2012_Eng) 

btstp_2012_Soc<- btstp_2012[grep("^/Social sciences",btstp_2012[,1]),2]

btstp_2012_Soc_count<- length(btstp_2012_Soc)

##btstp 2013

btstp_2013<- btstp_search_clean[grep("^2013",btstp_search_clean[,2]),]


btstp_2013_Bio<- btstp_2013[grep("^/Biology and life sciences",btstp_2013[,1]),2]

btstp_2013_Bio_count<- length(btstp_2013_Bio)

btstp_2013_Phys<- btstp_2013[grep("^/Physical sciences",btstp_2013[,1]),2]

btstp_2013_Phys_count<- length(btstp_2013_Phys) 

btstp_2013_Med<- btstp_2013[grep("^/Medicine and health sciences",btstp_2013[,1]),2]

btstp_2013_Med_count<- length(btstp_2013_Med) 

btstp_2013_Res<- btstp_2013[grep("^/Research and analysis methods",btstp_2013[,1]),2]

btstp_2013_Res_count<- length(btstp_2013_Res) 

btstp_2013_Earth<- btstp_2013[grep("^/Earth sciences",btstp_2013[,1]),2]

btstp_2013_Earth_count<- length(btstp_2013_Earth) 

btstp_2013_Comp<- btstp_2013[grep("^/Computer and information sciences",btstp_2013[,1]),2]

btstp_2013_Comp_count<- length(btstp_2013_Comp) 

btstp_2013_Eng<- btstp_2013[grep("^/Engineering and technology",btstp_2013[,1]),2]

btstp_2013_Eng_count<- length(btstp_2013_Eng) 

btstp_2013_Soc<- btstp_2013[grep("^/Social sciences",btstp_2013[,1]),2]

btstp_2013_Soc_count<- length(btstp_2013_Soc)

###btstp 2014

btstp_2014<- btstp_search_clean[grep("^2014",btstp_search_clean[,2]),]



btstp_2014_Bio<- btstp_2014[grep("^/Biology and life sciences",btstp_2014[,1]),2]

btstp_2014_Bio_count<- length(btstp_2014_Bio)

btstp_2014_Phys<- btstp_2014[grep("^/Physical sciences",btstp_2014[,1]),2]

btstp_2014_Phys_count<- length(btstp_2014_Phys) 

btstp_2014_Med<- btstp_2014[grep("^/Medicine and health sciences",btstp_2014[,1]),2]

btstp_2014_Med_count<- length(btstp_2014_Med) 

btstp_2014_Res<- btstp_2014[grep("^/Research and analysis methods",btstp_2014[,1]),2]

btstp_2014_Res_count<- length(btstp_2014_Res) 

btstp_2014_Earth<- btstp_2014[grep("^/Earth sciences",btstp_2014[,1]),2]

btstp_2014_Earth_count<- length(btstp_2014_Earth) 

btstp_2014_Comp<- btstp_2014[grep("^/Computer and information sciences",btstp_2014[,1]),2]

btstp_2014_Comp_count<- length(btstp_2014_Comp) 

btstp_2014_Eng<- btstp_2014[grep("^/Engineering and technology",btstp_2014[,1]),2]

btstp_2014_Eng_count<- length(btstp_2014_Eng) 

btstp_2014_Soc<- btstp_2014[grep("^/Social sciences",btstp_2014[,1]),2]

btstp_2014_Soc_count<- length(btstp_2014_Soc)

### btstp 2015

btstp_2015<- btstp_search_clean[grep("^2015",btstp_search_clean[,2]),]


btstp_2015_Bio<- btstp_2015[grep("^/Biology and life sciences",btstp_2015[,1]),2]

btstp_2015_Bio_count<- length(btstp_2015_Bio)

btstp_2015_Phys<- btstp_2015[grep("^/Physical sciences",btstp_2015[,1]),2]

btstp_2015_Phys_count<- length(btstp_2015_Phys) 

btstp_2015_Med<- btstp_2015[grep("^/Medicine and health sciences",btstp_2015[,1]),2]

btstp_2015_Med_count<- length(btstp_2015_Med) 

btstp_2015_Res<- btstp_2015[grep("^/Research and analysis methods",btstp_2015[,1]),2]

btstp_2015_Res_count<- length(btstp_2015_Res) 

btstp_2015_Earth<- btstp_2015[grep("^/Earth sciences",btstp_2015[,1]),2]

btstp_2015_Earth_count<- length(btstp_2015_Earth) 

btstp_2015_Comp<- btstp_2015[grep("^/Computer and information sciences",btstp_2015[,1]),2]

btstp_2015_Comp_count<- length(btstp_2015_Comp) 

btstp_2015_Eng<- btstp_2015[grep("^/Engineering and technology",btstp_2015[,1]),2]

btstp_2015_Eng_count<- length(btstp_2015_Eng) 

btstp_2015_Soc<- btstp_2015[grep("^/Social sciences",btstp_2015[,1]),2]

btstp_2015_Soc_count<- length(btstp_2015_Soc)

##btstp 2016

btstp_2016<- btstp_search_clean[grep("^2016",btstp_search_clean[,2]),]


btstp_2016_Bio<- btstp_2016[grep("^/Biology and life sciences",btstp_2016[,1]),2]

btstp_2016_Bio_count<- length(btstp_2016_Bio)

btstp_2016_Phys<- btstp_2016[grep("^/Physical sciences",btstp_2016[,1]),2]

btstp_2016_Phys_count<- length(btstp_2016_Phys) 

btstp_2016_Med<- btstp_2016[grep("^/Medicine and health sciences",btstp_2016[,1]),2]

btstp_2016_Med_count<- length(btstp_2016_Med) 

btstp_2016_Res<- btstp_2016[grep("^/Research and analysis methods",btstp_2016[,1]),2]

btstp_2016_Res_count<- length(btstp_2016_Res) 

btstp_2016_Earth<- btstp_2016[grep("^/Earth sciences",btstp_2016[,1]),2]

btstp_2016_Earth_count<- length(btstp_2016_Earth) 

btstp_2016_Comp<- btstp_2016[grep("^/Computer and information sciences",btstp_2016[,1]),2]

btstp_2016_Comp_count<- length(btstp_2016_Comp) 

btstp_2016_Eng<- btstp_2016[grep("^/Engineering and technology",btstp_2016[,1]),2]

btstp_2016_Eng_count<- length(btstp_2016_Eng) 

btstp_2016_Soc<- btstp_2016[grep("^/Social sciences",btstp_2016[,1]),2]

btstp_2016_Soc_count<- length(btstp_2016_Soc)

## btstp 2017

btstp_2017<- btstp_search_clean[grep("^2017",btstp_search_clean[,2]),]


btstp_2017_Bio<- btstp_2017[grep("^/Biology and life sciences",btstp_2017[,1]),2]

btstp_2017_Bio_count<- length(btstp_2017_Bio)

btstp_2017_Phys<- btstp_2017[grep("^/Physical sciences",btstp_2017[,1]),2]

btstp_2017_Phys_count<- length(btstp_2017_Phys) 

btstp_2017_Med<- btstp_2017[grep("^/Medicine and health sciences",btstp_2017[,1]),2]

btstp_2017_Med_count<- length(btstp_2017_Med) 

btstp_2017_Res<- btstp_2017[grep("^/Research and analysis methods",btstp_2017[,1]),2]

btstp_2017_Res_count<- length(btstp_2017_Res) 

btstp_2017_Earth<- btstp_2017[grep("^/Earth sciences",btstp_2017[,1]),2]

btstp_2017_Earth_count<- length(btstp_2017_Earth) 

btstp_2017_Comp<- btstp_2017[grep("^/Computer and information sciences",btstp_2017[,1]),2]

btstp_2017_Comp_count<- length(btstp_2017_Comp) 

btstp_2017_Eng<- btstp_2017[grep("^/Engineering and technology",btstp_2017[,1]),2]

btstp_2017_Eng_count<- length(btstp_2017_Eng) 

btstp_2017_Soc<- btstp_2017[grep("^/Social sciences",btstp_2017[,1]),2]

btstp_2017_Soc_count<- length(btstp_2017_Soc)

################## btstp counts table

btstp_counts_2004_bio<- c(btstp_2004_Bio_count,1,rep(0,13),1,rep(0,7))
btstp_counts_2004_Comp<- c(btstp_2004_Comp_count,1,rep(0,13),0,1,rep(0,6))
btstp_counts_2004_Earth<-c(btstp_2004_Earth_count,1,rep(0,13),0,0,1,rep(0,5))
btstp_counts_2004_Eng<- c(btstp_2004_Eng_count,1,rep(0,13),0,0,0,1,rep(0,4))
btstp_counts_2004_Med<- c(btstp_2004_Med_count,1,rep(0,13),rep(0,4),1,0,0,0)
btstp_counts_2004_Phys<- c(btstp_2004_Phys_count,1,rep(0,13),rep(0,5),1,0,0)
btstp_count_2004_Res<-c(btstp_2004_Res_count,1,rep(0,13),rep(0,6),1,0)
btstp_count_2004_Soc<-c(btstp_2004_Soc_count,1,rep(0,13),rep(0,7),1)

btstp_counts_2005_bio<- c(btstp_2005_Bio_count,0,1,rep(0,12),1,rep(0,7))
btstp_counts_2005_Comp<- c(btstp_2005_Comp_count,0,1,rep(0,12),0,1,rep(0,6))
btstp_counts_2005_Earth<-c(btstp_2005_Earth_count,0,1,rep(0,12),0,0,1,rep(0,5))
btstp_counts_2005_Eng<- c(btstp_2005_Eng_count,0,1,rep(0,12),0,0,0,1,rep(0,4))
btstp_counts_2005_Med<- c(btstp_2005_Med_count,0,1,rep(0,12),rep(0,4),1,0,0,0)
btstp_counts_2005_Phys<- c(btstp_2005_Phys_count,0,1,rep(0,12),rep(0,5),1,0,0)
btstp_count_2005_Res<-c(btstp_2005_Res_count,0,1,rep(0,12),rep(0,6),1,0)
btstp_count_2005_Soc<-c(btstp_2005_Soc_count,0,1,rep(0,12),rep(0,7),1)

btstp_counts_2006_bio<- c(btstp_2006_Bio_count,0,0,1,rep(0,11),1,rep(0,7))
btstp_counts_2006_Comp<- c(btstp_2006_Comp_count,0,0,1,rep(0,11),0,1,rep(0,6))
btstp_counts_2006_Earth<-c(btstp_2006_Earth_count,0,0,1,rep(0,11),0,0,1,rep(0,5))
btstp_counts_2006_Eng<- c(btstp_2006_Eng_count,0,0,1,rep(0,11),0,0,0,1,rep(0,4))
btstp_counts_2006_Med<- c(btstp_2006_Med_count,0,0,1,rep(0,11),rep(0,4),1,0,0,0)
btstp_counts_2006_Phys<- c(btstp_2006_Phys_count,0,0,1,rep(0,11),rep(0,5),1,0,0)
btstp_count_2006_Res<-c(btstp_2006_Res_count,0,0,1,rep(0,11),rep(0,6),1,0)
btstp_count_2006_Soc<-c(btstp_2006_Soc_count,0,0,1,rep(0,11),rep(0,7),1)

btstp_counts_2007_bio<- c(btstp_2007_Bio_count,0,0,0,1,rep(0,10),1,rep(0,7))
btstp_counts_2007_Comp<- c(btstp_2007_Comp_count,0,0,0,1,rep(0,10),0,1,rep(0,6))
btstp_counts_2007_Earth<-c(btstp_2007_Earth_count,0,0,0,1,rep(0,10),0,0,1,rep(0,5))
btstp_counts_2007_Eng<- c(btstp_2007_Eng_count,0,0,0,1,rep(0,10),0,0,0,1,rep(0,4))
btstp_counts_2007_Med<- c(btstp_2007_Med_count,0,0,0,1,rep(0,10),rep(0,4),1,0,0,0)
btstp_counts_2007_Phys<- c(btstp_2007_Phys_count,0,0,0,1,rep(0,10),rep(0,5),1,0,0)
btstp_count_2007_Res<-c(btstp_2007_Res_count,0,0,0,1,rep(0,10),rep(0,6),1,0)
btstp_count_2007_Soc<-c(btstp_2007_Soc_count,0,0,0,1,rep(0,10),rep(0,7),1)

btstp_counts_2008_bio<- c(btstp_2008_Bio_count,rep(0,4),1,rep(0,9),1,rep(0,7))
btstp_counts_2008_Comp<- c(btstp_2008_Comp_count,rep(0,4),1,rep(0,9),0,1,rep(0,6))
btstp_counts_2008_Earth<-c(btstp_2008_Earth_count,rep(0,4),1,rep(0,9),0,0,1,rep(0,5))
btstp_counts_2008_Eng<- c(btstp_2008_Eng_count,rep(0,4),1,rep(0,9),0,0,0,1,rep(0,4))
btstp_counts_2008_Med<- c(btstp_2008_Med_count,rep(0,4),1,rep(0,9),rep(0,4),1,0,0,0)
btstp_counts_2008_Phys<- c(btstp_2008_Phys_count,rep(0,4),1,rep(0,9),rep(0,5),1,0,0)
btstp_count_2008_Res<-c(btstp_2008_Res_count,rep(0,4),1,rep(0,9),rep(0,6),1,0)
btstp_count_2008_Soc<-c(btstp_2008_Soc_count,rep(0,4),1,rep(0,9),rep(0,7),1)


btstp_counts_2009_bio<- c(btstp_2009_Bio_count,rep(0,5),1,rep(0,8),1,rep(0,7))
btstp_counts_2009_Comp<- c(btstp_2009_Comp_count,rep(0,5),1,rep(0,8),0,1,rep(0,6))
btstp_counts_2009_Earth<-c(btstp_2009_Earth_count,rep(0,5),1,rep(0,8),0,0,1,rep(0,5))
btstp_counts_2009_Eng<- c(btstp_2009_Eng_count,rep(0,5),1,rep(0,8),0,0,0,1,rep(0,4))
btstp_counts_2009_Med<- c(btstp_2009_Med_count,rep(0,5),1,rep(0,8),rep(0,4),1,0,0,0)
btstp_counts_2009_Phys<- c(btstp_2009_Phys_count,rep(0,5),1,rep(0,8),rep(0,5),1,0,0)
btstp_count_2009_Res<-c(btstp_2009_Res_count,rep(0,5),1,rep(0,8),rep(0,6),1,0)
btstp_count_2009_Soc<-c(btstp_2009_Soc_count,rep(0,5),1,rep(0,8),rep(0,7),1)

btstp_counts_2010_bio<- c(btstp_2010_Bio_count,rep(0,6),1,rep(0,7),1,rep(0,7))
btstp_counts_2010_Comp<- c(btstp_2010_Comp_count,rep(0,6),1,rep(0,7),0,1,rep(0,6))
btstp_counts_2010_Earth<-c(btstp_2010_Earth_count,rep(0,6),1,rep(0,7),0,0,1,rep(0,5))
btstp_counts_2010_Eng<- c(btstp_2010_Eng_count,rep(0,6),1,rep(0,7),0,0,0,1,rep(0,4))
btstp_counts_2010_Med<- c(btstp_2010_Med_count,rep(0,6),1,rep(0,7),rep(0,4),1,0,0,0)
btstp_counts_2010_Phys<- c(btstp_2010_Phys_count,rep(0,6),1,rep(0,7),rep(0,5),1,0,0)
btstp_count_2010_Res<-c(btstp_2010_Res_count,rep(0,6),1,rep(0,7),rep(0,6),1,0)
btstp_count_2010_Soc<-c(btstp_2010_Soc_count,rep(0,6),1,rep(0,7),rep(0,7),1)


btstp_counts_2011_bio<- c(btstp_2011_Bio_count,rep(0,7),1,rep(0,6),1,rep(0,7))
btstp_counts_2011_Comp<- c(btstp_2011_Comp_count,rep(0,7),1,rep(0,6),0,1,rep(0,6))
btstp_counts_2011_Earth<-c(btstp_2011_Earth_count,rep(0,7),1,rep(0,6),0,0,1,rep(0,5))
btstp_counts_2011_Eng<- c(btstp_2011_Eng_count,rep(0,7),1,rep(0,6),0,0,0,1,rep(0,4))
btstp_counts_2011_Med<- c(btstp_2011_Med_count,rep(0,7),1,rep(0,6),rep(0,4),1,0,0,0)
btstp_counts_2011_Phys<- c(btstp_2011_Phys_count,rep(0,7),1,rep(0,6),rep(0,5),1,0,0)
btstp_count_2011_Res<-c(btstp_2011_Res_count,rep(0,7),1,rep(0,6),rep(0,6),1,0)
btstp_count_2011_Soc<-c(btstp_2011_Soc_count,rep(0,7),1,rep(0,6),rep(0,7),1)

btstp_counts_2012_bio<- c(btstp_2012_Bio_count,rep(0,8),1,rep(0,5),1,rep(0,7))
btstp_counts_2012_Comp<- c(btstp_2012_Comp_count,rep(0,8),1,rep(0,5),0,1,rep(0,6))
btstp_counts_2012_Earth<-c(btstp_2012_Earth_count,rep(0,8),1,rep(0,5),0,0,1,rep(0,5))
btstp_counts_2012_Eng<- c(btstp_2012_Eng_count,rep(0,8),1,rep(0,5),0,0,0,1,rep(0,4))
btstp_counts_2012_Med<- c(btstp_2012_Med_count,rep(0,8),1,rep(0,5),rep(0,4),1,0,0,0)
btstp_counts_2012_Phys<- c(btstp_2012_Phys_count,rep(0,8),1,rep(0,5),rep(0,5),1,0,0)
btstp_count_2012_Res<-c(btstp_2012_Res_count,rep(0,8),1,rep(0,5),rep(0,6),1,0)
btstp_count_2012_Soc<-c(btstp_2012_Soc_count,rep(0,8),1,rep(0,5),rep(0,7),1)

btstp_counts_2013_bio<- c(btstp_2013_Bio_count,rep(0,9),1,rep(0,4),1,rep(0,7))
btstp_counts_2013_Comp<- c(btstp_2013_Comp_count,rep(0,9),1,rep(0,4),0,1,rep(0,6))
btstp_counts_2013_Earth<-c(btstp_2013_Earth_count,rep(0,9),1,rep(0,4),0,0,1,rep(0,5))
btstp_counts_2013_Eng<- c(btstp_2013_Eng_count,rep(0,9),1,rep(0,4),0,0,0,1,rep(0,4))
btstp_counts_2013_Med<- c(btstp_2013_Med_count,rep(0,9),1,rep(0,4),rep(0,4),1,0,0,0)
btstp_counts_2013_Phys<- c(btstp_2013_Phys_count,rep(0,9),1,rep(0,4),rep(0,5),1,0,0)
btstp_count_2013_Res<-c(btstp_2013_Res_count,rep(0,9),1,rep(0,4),rep(0,6),1,0)
btstp_count_2013_Soc<-c(btstp_2013_Soc_count,rep(0,9),1,rep(0,4),rep(0,7),1)

btstp_counts_2014_bio<- c(btstp_2014_Bio_count,rep(0,10),1,rep(0,3),1,rep(0,7))
btstp_counts_2014_Comp<- c(btstp_2014_Comp_count,rep(0,10),1,rep(0,3),0,1,rep(0,6))
btstp_counts_2014_Earth<-c(btstp_2014_Earth_count,rep(0,10),1,rep(0,3),0,0,1,rep(0,5))
btstp_counts_2014_Eng<- c(btstp_2014_Eng_count,rep(0,10),1,rep(0,3),0,0,0,1,rep(0,4))
btstp_counts_2014_Med<- c(btstp_2014_Med_count,rep(0,10),1,rep(0,3),rep(0,4),1,0,0,0)
btstp_counts_2014_Phys<- c(btstp_2014_Phys_count,rep(0,10),1,rep(0,3),rep(0,5),1,0,0)
btstp_count_2014_Res<-c(btstp_2014_Res_count,rep(0,10),1,rep(0,3),rep(0,6),1,0)
btstp_count_2014_Soc<-c(btstp_2014_Soc_count,rep(0,10),1,rep(0,3),rep(0,7),1)

btstp_counts_2015_bio<- c(btstp_2015_Bio_count,rep(0,11),1,rep(0,2),1,rep(0,7))
btstp_counts_2015_Comp<- c(btstp_2015_Comp_count,rep(0,11),1,rep(0,2),0,1,rep(0,6))
btstp_counts_2015_Earth<-c(btstp_2015_Earth_count,rep(0,11),1,rep(0,2),0,0,1,rep(0,5))
btstp_counts_2015_Eng<- c(btstp_2015_Eng_count,rep(0,11),1,rep(0,2),0,0,0,1,rep(0,4))
btstp_counts_2015_Med<- c(btstp_2015_Med_count,rep(0,11),1,rep(0,2),rep(0,4),1,0,0,0)
btstp_counts_2015_Phys<- c(btstp_2015_Phys_count,rep(0,11),1,rep(0,2),rep(0,5),1,0,0)
btstp_count_2015_Res<-c(btstp_2015_Res_count,rep(0,11),1,rep(0,2),rep(0,6),1,0)
btstp_count_2015_Soc<-c(btstp_2015_Soc_count,rep(0,11),1,rep(0,2),rep(0,7),1)

btstp_counts_2016_bio<- c(btstp_2016_Bio_count,rep(0,12),1,rep(0,1),1,rep(0,7))
btstp_counts_2016_Comp<- c(btstp_2016_Comp_count,rep(0,12),1,rep(0,1),0,1,rep(0,6))
btstp_counts_2016_Earth<-c(btstp_2016_Earth_count,rep(0,12),1,rep(0,1),0,0,1,rep(0,5))
btstp_counts_2016_Eng<- c(btstp_2016_Eng_count,rep(0,12),1,rep(0,1),0,0,0,1,rep(0,4))
btstp_counts_2016_Med<- c(btstp_2016_Med_count,rep(0,12),1,rep(0,1),rep(0,4),1,0,0,0)
btstp_counts_2016_Phys<- c(btstp_2016_Phys_count,rep(0,12),1,rep(0,1),rep(0,5),1,0,0)
btstp_count_2016_Res<-c(btstp_2016_Res_count,rep(0,12),1,rep(0,1),rep(0,6),1,0)
btstp_count_2016_Soc<-c(btstp_2016_Soc_count,rep(0,12),1,rep(0,1),rep(0,7),1)

btstp_counts_2017_bio<- c(btstp_2017_Bio_count,rep(0,13),1,1,rep(0,7))
btstp_counts_2017_Comp<- c(btstp_2017_Comp_count,rep(0,13),1,0,1,rep(0,6))
btstp_counts_2017_Earth<-c(btstp_2017_Earth_count,rep(0,13),1,0,0,1,rep(0,5))
btstp_counts_2017_Eng<- c(btstp_2017_Eng_count,rep(0,13),1,0,0,0,1,rep(0,4))
btstp_counts_2017_Med<- c(btstp_2017_Med_count,rep(0,13),1,rep(0,4),1,0,0,0)
btstp_counts_2017_Phys<- c(btstp_2017_Phys_count,rep(0,13),1,rep(0,5),1,0,0)
btstp_count_2017_Res<-c(btstp_2017_Res_count,rep(0,13),1,rep(0,6),1,0)
btstp_count_2017_Soc<-c(btstp_2017_Soc_count,rep(0,13),1,rep(0,7),1)

btstp_table<- rbind(btstp_counts_2004_bio,btstp_counts_2004_Comp,btstp_counts_2004_Earth,
                    btstp_counts_2004_Eng,btstp_counts_2004_Med,btstp_counts_2004_Phys,
                    btstp_count_2004_Res,btstp_count_2004_Soc,btstp_counts_2005_bio,
                    btstp_counts_2005_Comp,btstp_counts_2005_Earth,btstp_counts_2005_Eng,
                    btstp_counts_2005_Med,btstp_counts_2005_Phys,btstp_count_2005_Res,
                    btstp_count_2005_Soc,btstp_counts_2006_bio,
                    btstp_counts_2006_Comp,btstp_counts_2006_Earth,btstp_counts_2006_Eng,
                    btstp_counts_2006_Med,btstp_counts_2006_Phys,btstp_count_2006_Res,
                    btstp_count_2006_Soc,btstp_counts_2007_bio,
                    btstp_counts_2007_Comp,btstp_counts_2007_Earth,btstp_counts_2007_Eng,
                    btstp_counts_2007_Med,btstp_counts_2007_Phys,btstp_count_2007_Res,
                    btstp_count_2007_Soc, btstp_counts_2008_bio,
                    btstp_counts_2008_Comp,btstp_counts_2008_Earth,btstp_counts_2008_Eng,
                    btstp_counts_2008_Med,btstp_counts_2008_Phys,btstp_count_2008_Res,
                    btstp_count_2008_Soc, btstp_counts_2009_bio,
                    btstp_counts_2009_Comp,btstp_counts_2009_Earth,btstp_counts_2009_Eng,
                    btstp_counts_2009_Med,btstp_counts_2009_Phys,btstp_count_2009_Res,
                    btstp_count_2009_Soc,btstp_counts_2010_bio,
                    btstp_counts_2010_Comp,btstp_counts_2010_Earth,btstp_counts_2010_Eng,
                    btstp_counts_2010_Med,btstp_counts_2010_Phys,btstp_count_2010_Res,
                    btstp_count_2010_Soc,btstp_counts_2011_bio,
                    btstp_counts_2011_Comp,btstp_counts_2011_Earth,btstp_counts_2011_Eng,
                    btstp_counts_2011_Med,btstp_counts_2011_Phys,btstp_count_2011_Res,
                    btstp_count_2011_Soc,btstp_counts_2012_bio,
                    btstp_counts_2012_Comp,btstp_counts_2012_Earth,btstp_counts_2012_Eng,
                    btstp_counts_2012_Med,btstp_counts_2012_Phys,btstp_count_2012_Res,
                    btstp_count_2012_Soc, btstp_counts_2013_bio,
                    btstp_counts_2013_Comp,btstp_counts_2013_Earth,btstp_counts_2013_Eng,
                    btstp_counts_2013_Med,btstp_counts_2013_Phys,btstp_count_2013_Res,
                    btstp_count_2013_Soc, btstp_counts_2014_bio,
                    btstp_counts_2014_Comp,btstp_counts_2014_Earth,btstp_counts_2014_Eng,
                    btstp_counts_2014_Med,btstp_counts_2014_Phys,btstp_count_2014_Res,
                    btstp_count_2014_Soc,btstp_counts_2015_bio,
                    btstp_counts_2015_Comp,btstp_counts_2015_Earth,btstp_counts_2015_Eng,
                    btstp_counts_2015_Med,btstp_counts_2015_Phys,btstp_count_2015_Res,
                    btstp_count_2015_Soc,btstp_counts_2016_bio,
                    btstp_counts_2016_Comp,btstp_counts_2016_Earth,btstp_counts_2016_Eng,
                    btstp_counts_2016_Med,btstp_counts_2016_Phys,btstp_count_2016_Res,
                    btstp_count_2016_Soc, btstp_counts_2017_bio,
                    btstp_counts_2017_Comp,btstp_counts_2017_Earth,btstp_counts_2017_Eng,
                    btstp_counts_2017_Med,btstp_counts_2017_Phys,btstp_count_2017_Res,
                    btstp_count_2017_Soc)

btstp_table[97:112,]
as.data.frame(btstp_table)

colnames(btstp_table)<- c("btstp_counts","2004","2005","2006","2007","2008","2009",
                          "2010","2011","2012","2013","2014","2015","2016","2017",
                          "Biology and life sciences","Computer and information sciences",
                          "Earth sciences","Engineering and tecnhology",
                          "Medicine and health sciences","Physical sciences",
                          "Research and analysis","Social Sciences")

as.numeric(btstp_table[,1])

year_covs<- btstp_table[,2:15]

terms_covs<- btstp_table[,16:23]

################ GEE model fit ##############################

model_btstp<- glm(btstp_table[,1]~year_covs*terms_covs, family="poisson")

summary(model_btstp)

######################## Support Vector Machines counts assembly ############
SVM_search<- searchplos(q="support vector machine",fl=c("subject","publication_date"),limit=10000)


SVM_search_clean<- matrix(unlist(SVM_search[[2]]),ncol=2)



###SVM 2004
SVM_2004<- SVM_search_clean[grep("^2004",SVM_search_clean[,2]),]


SVM_2004_Bio<- SVM_2004[grep("^/Biology and life sciences",SVM_2004[,1]),2]

SVM_2004_Bio_count<- length(SVM_2004_Bio)

SVM_2004_Phys<- SVM_2004[grep("^/Physical sciences",SVM_2004[,1]),2]

SVM_2004_Phys_count<- length(SVM_2004_Phys) 

SVM_2004_Med<- SVM_2004[grep("^/Medicine and health sciences",SVM_2004[,1]),2]

SVM_2004_Med_count<- length(SVM_2004_Med) 

SVM_2004_Res<- SVM_2004[grep("^/Research and analysis methods",SVM_2004[,1]),2]

SVM_2004_Res_count<- length(SVM_2004_Res) 

SVM_2004_Earth<- SVM_2004[grep("^/Earth sciences",SVM_2004[,1]),2]

SVM_2004_Earth_count<- length(SVM_2004_Earth) 

SVM_2004_Comp<- SVM_2004[grep("^/Computer and information sciences",SVM_2004[,1]),2]

SVM_2004_Comp_count<- length(SVM_2004_Comp) 

SVM_2004_Eng<- SVM_2004[grep("^/Engineering and technology",SVM_2004[,1]),2]

SVM_2004_Eng_count<- length(SVM_2004_Eng) 

SVM_2004_Soc<- SVM_2004[grep("^/Social sciences",SVM_2004[,1]),2]

SVM_2004_Soc_count<- length(SVM_2004_Soc) 


########SVM 2005

SVM_2005<- SVM_search_clean[grep("^2005",SVM_search_clean[,2]),]

SVM_2005_Bio<- SVM_2005[grep("^/Biology and life sciences",SVM_2005[,1]),2]

SVM_2005_Bio_count<- length(SVM_2005_Bio)

SVM_2005_Phys<- SVM_2005[grep("^/Physical sciences",SVM_2005[,1]),2]

SVM_2005_Phys_count<- length(SVM_2005_Phys) 

SVM_2005_Med<- SVM_2005[grep("^/Medicine and health sciences",SVM_2005[,1]),2]

SVM_2005_Med_count<- length(SVM_2005_Med) 

SVM_2005_Res<- SVM_2005[grep("^/Research and analysis methods",SVM_2005[,1]),2]

SVM_2005_Res_count<- length(SVM_2005_Res) 

SVM_2005_Earth<- SVM_2005[grep("^/Earth sciences",SVM_2005[,1]),2]

SVM_2005_Earth_count<- length(SVM_2005_Earth) 

SVM_2005_Comp<- SVM_2005[grep("^/Computer and information sciences",SVM_2005[,1]),2]

SVM_2005_Comp_count<- length(SVM_2005_Comp) 

SVM_2005_Eng<- SVM_2005[grep("^/Engineering and technology",SVM_2005[,1]),2]

SVM_2005_Eng_count<- length(SVM_2005_Eng) 

SVM_2005_Soc<- SVM_2005[grep("^/Social sciences",SVM_2005[,1]),2]

SVM_2005_Soc_count<- length(SVM_2005_Soc) 


###### SVM 2006


SVM_2006<- SVM_search_clean[grep("^2006",SVM_search_clean[,2]),]


SVM_2006_Bio<- SVM_2006[grep("^/Biology and life sciences",SVM_2006[,1]),2]

SVM_2006_Bio_count<- length(SVM_2006_Bio)

SVM_2006_Phys<- SVM_2006[grep("^/Physical sciences",SVM_2006[,1]),2]

SVM_2006_Phys_count<- length(SVM_2006_Phys) 

SVM_2006_Med<- SVM_2006[grep("^/Medicine and health sciences",SVM_2006[,1]),2]

SVM_2006_Med_count<- length(SVM_2006_Med) 

SVM_2006_Res<- SVM_2006[grep("^/Research and analysis methods",SVM_2006[,1]),2]

SVM_2006_Res_count<- length(SVM_2006_Res) 

SVM_2006_Earth<- SVM_2006[grep("^/Earth sciences",SVM_2006[,1]),2]

SVM_2006_Earth_count<- length(SVM_2006_Earth) 

SVM_2006_Comp<- SVM_2006[grep("^/Computer and information sciences",SVM_2006[,1]),2]

SVM_2006_Comp_count<- length(SVM_2006_Comp) 

SVM_2006_Eng<- SVM_2006[grep("^/Engineering and technology",SVM_2006[,1]),2]

SVM_2006_Eng_count<- length(SVM_2006_Eng) 

SVM_2006_Soc<- SVM_2006[grep("^/Social sciences",SVM_2006[,1]),2]

SVM_2006_Soc_count<- length(SVM_2006_Soc) 

## SVM 2007


SVM_2007<- SVM_search_clean[grep("^2007",SVM_search_clean[,2]),]


SVM_2007_Bio<- SVM_2007[grep("^/Biology and life sciences",SVM_2007[,1]),2]

SVM_2007_Bio_count<- length(SVM_2007_Bio)

SVM_2007_Phys<- SVM_2007[grep("^/Physical sciences",SVM_2007[,1]),2]

SVM_2007_Phys_count<- length(SVM_2007_Phys) 

SVM_2007_Med<- SVM_2007[grep("^/Medicine and health sciences",SVM_2007[,1]),2]

SVM_2007_Med_count<- length(SVM_2007_Med) 

SVM_2007_Res<- SVM_2007[grep("^/Research and analysis methods",SVM_2007[,1]),2]

SVM_2007_Res_count<- length(SVM_2007_Res) 

SVM_2007_Earth<- SVM_2007[grep("^/Earth sciences",SVM_2007[,1]),2]

SVM_2007_Earth_count<- length(SVM_2007_Earth) 

SVM_2007_Comp<- SVM_2007[grep("^/Computer and information sciences",SVM_2007[,1]),2]

SVM_2007_Comp_count<- length(SVM_2007_Comp) 

SVM_2007_Eng<- SVM_2007[grep("^/Engineering and technology",SVM_2007[,1]),2]

SVM_2007_Eng_count<- length(SVM_2007_Eng) 

SVM_2007_Soc<- SVM_2007[grep("^/Social sciences",SVM_2007[,1]),2]

SVM_2007_Soc_count<- length(SVM_2007_Soc) 

#### SVM 2008
SVM_2008<- SVM_search_clean[grep("^2008",SVM_search_clean[,2]),]


SVM_2008_Bio<- SVM_2008[grep("^/Biology and life sciences",SVM_2008[,1]),2]

SVM_2008_Bio_count<- length(SVM_2008_Bio)

SVM_2008_Phys<- SVM_2008[grep("^/Physical sciences",SVM_2008[,1]),2]

SVM_2008_Phys_count<- length(SVM_2008_Phys) 

SVM_2008_Med<- SVM_2008[grep("^/Medicine and health sciences",SVM_2008[,1]),2]

SVM_2008_Med_count<- length(SVM_2008_Med) 

SVM_2008_Res<- SVM_2008[grep("^/Research and analysis methods",SVM_2008[,1]),2]

SVM_2008_Res_count<- length(SVM_2008_Res) 

SVM_2008_Earth<- SVM_2008[grep("^/Earth sciences",SVM_2008[,1]),2]

SVM_2008_Earth_count<- length(SVM_2008_Earth) 

SVM_2008_Comp<- SVM_2008[grep("^/Computer and information sciences",SVM_2008[,1]),2]

SVM_2008_Comp_count<- length(SVM_2008_Comp) 

SVM_2008_Eng<- SVM_2008[grep("^/Engineering and technology",SVM_2008[,1]),2]

SVM_2008_Eng_count<- length(SVM_2008_Eng) 

SVM_2008_Soc<- SVM_2008[grep("^/Social sciences",SVM_2008[,1]),2]

SVM_2008_Soc_count<- length(SVM_2008_Soc) 

##2009

SVM_2009<- SVM_search_clean[grep("^2009",SVM_search_clean[,2]),]


SVM_2009_Bio<- SVM_2009[grep("^/Biology and life sciences",SVM_2009[,1]),2]

SVM_2009_Bio_count<- length(SVM_2009_Bio)

SVM_2009_Phys<- SVM_2009[grep("^/Physical sciences",SVM_2009[,1]),2]

SVM_2009_Phys_count<- length(SVM_2009_Phys) 

SVM_2009_Med<- SVM_2009[grep("^/Medicine and health sciences",SVM_2009[,1]),2]

SVM_2009_Med_count<- length(SVM_2009_Med) 

SVM_2009_Res<- SVM_2009[grep("^/Research and analysis methods",SVM_2009[,1]),2]

SVM_2009_Res_count<- length(SVM_2009_Res) 

SVM_2009_Earth<- SVM_2009[grep("^/Earth sciences",SVM_2009[,1]),2]

SVM_2009_Earth_count<- length(SVM_2009_Earth) 

SVM_2009_Comp<- SVM_2009[grep("^/Computer and information sciences",SVM_2009[,1]),2]

SVM_2009_Comp_count<- length(SVM_2009_Comp) 

SVM_2009_Eng<- SVM_2009[grep("^/Engineering and technology",SVM_2009[,1]),2]

SVM_2009_Eng_count<- length(SVM_2009_Eng) 

SVM_2009_Soc<- SVM_2009[grep("^/Social sciences",SVM_2009[,1]),2]

SVM_2009_Soc_count<- length(SVM_2009_Soc)

### SVM 2010

SVM_2010<- SVM_search_clean[grep("^2010",SVM_search_clean[,2]),]


SVM_2010_Bio<- SVM_2010[grep("^/Biology and life sciences",SVM_2010[,1]),2]

SVM_2010_Bio_count<- length(SVM_2010_Bio)

SVM_2010_Phys<- SVM_2010[grep("^/Physical sciences",SVM_2010[,1]),2]

SVM_2010_Phys_count<- length(SVM_2010_Phys) 

SVM_2010_Med<- SVM_2010[grep("^/Medicine and health sciences",SVM_2010[,1]),2]

SVM_2010_Med_count<- length(SVM_2010_Med) 

SVM_2010_Res<- SVM_2010[grep("^/Research and analysis methods",SVM_2010[,1]),2]

SVM_2010_Res_count<- length(SVM_2010_Res) 

SVM_2010_Earth<- SVM_2010[grep("^/Earth sciences",SVM_2010[,1]),2]

SVM_2010_Earth_count<- length(SVM_2010_Earth) 

SVM_2010_Comp<- SVM_2010[grep("^/Computer and information sciences",SVM_2010[,1]),2]

SVM_2010_Comp_count<- length(SVM_2010_Comp) 

SVM_2010_Eng<- SVM_2010[grep("^/Engineering and technology",SVM_2010[,1]),2]

SVM_2010_Eng_count<- length(SVM_2010_Eng) 

SVM_2010_Soc<- SVM_2010[grep("^/Social sciences",SVM_2010[,1]),2]

SVM_2010_Soc_count<- length(SVM_2010_Soc)

###2011 SVM

SVM_2011<- SVM_search_clean[grep("^2011",SVM_search_clean[,2]),]

SVM_2011_Bio<- SVM_2011[grep("^/Biology and life sciences",SVM_2011[,1]),2]

SVM_2011_Bio_count<- length(SVM_2011_Bio)

SVM_2011_Phys<- SVM_2011[grep("^/Physical sciences",SVM_2011[,1]),2]

SVM_2011_Phys_count<- length(SVM_2011_Phys) 

SVM_2011_Med<- SVM_2011[grep("^/Medicine and health sciences",SVM_2011[,1]),2]

SVM_2011_Med_count<- length(SVM_2011_Med) 

SVM_2011_Res<- SVM_2011[grep("^/Research and analysis methods",SVM_2011[,1]),2]

SVM_2011_Res_count<- length(SVM_2011_Res) 

SVM_2011_Earth<- SVM_2011[grep("^/Earth sciences",SVM_2011[,1]),2]

SVM_2011_Earth_count<- length(SVM_2011_Earth) 

SVM_2011_Comp<- SVM_2011[grep("^/Computer and information sciences",SVM_2011[,1]),2]

SVM_2011_Comp_count<- length(SVM_2011_Comp) 

SVM_2011_Eng<- SVM_2011[grep("^/Engineering and technology",SVM_2011[,1]),2]

SVM_2011_Eng_count<- length(SVM_2011_Eng) 

SVM_2011_Soc<- SVM_2011[grep("^/Social sciences",SVM_2011[,1]),2]

SVM_2011_Soc_count<- length(SVM_2011_Soc)

###SVM 2012
SVM_2012<- SVM_search_clean[grep("^2012",SVM_search_clean[,2]),]

SVM_2012_Bio<- SVM_2012[grep("^/Biology and life sciences",SVM_2012[,1]),2]

SVM_2012_Bio_count<- length(SVM_2012_Bio)

SVM_2012_Phys<- SVM_2012[grep("^/Physical sciences",SVM_2012[,1]),2]

SVM_2012_Phys_count<- length(SVM_2012_Phys) 

SVM_2012_Med<- SVM_2012[grep("^/Medicine and health sciences",SVM_2012[,1]),2]

SVM_2012_Med_count<- length(SVM_2012_Med) 

SVM_2012_Res<- SVM_2012[grep("^/Research and analysis methods",SVM_2012[,1]),2]

SVM_2012_Res_count<- length(SVM_2012_Res) 

SVM_2012_Earth<- SVM_2012[grep("^/Earth sciences",SVM_2012[,1]),2]

SVM_2012_Earth_count<- length(SVM_2012_Earth) 

SVM_2012_Comp<- SVM_2012[grep("^/Computer and information sciences",SVM_2012[,1]),2]

SVM_2012_Comp_count<- length(SVM_2012_Comp) 

SVM_2012_Eng<- SVM_2012[grep("^/Engineering and technology",SVM_2012[,1]),2]

SVM_2012_Eng_count<- length(SVM_2012_Eng) 

SVM_2012_Soc<- SVM_2012[grep("^/Social sciences",SVM_2012[,1]),2]

SVM_2012_Soc_count<- length(SVM_2012_Soc)

##SVM 2013

SVM_2013<- SVM_search_clean[grep("^2013",SVM_search_clean[,2]),]

SVM_2013_Bio<- SVM_2013[grep("^/Biology and life sciences",SVM_2013[,1]),2]

SVM_2013_Bio_count<- length(SVM_2013_Bio)

SVM_2013_Phys<- SVM_2013[grep("^/Physical sciences",SVM_2013[,1]),2]

SVM_2013_Phys_count<- length(SVM_2013_Phys) 

SVM_2013_Med<- SVM_2013[grep("^/Medicine and health sciences",SVM_2013[,1]),2]

SVM_2013_Med_count<- length(SVM_2013_Med) 

SVM_2013_Res<- SVM_2013[grep("^/Research and analysis methods",SVM_2013[,1]),2]

SVM_2013_Res_count<- length(SVM_2013_Res) 

SVM_2013_Earth<- SVM_2013[grep("^/Earth sciences",SVM_2013[,1]),2]

SVM_2013_Earth_count<- length(SVM_2013_Earth) 

SVM_2013_Comp<- SVM_2013[grep("^/Computer and information sciences",SVM_2013[,1]),2]

SVM_2013_Comp_count<- length(SVM_2013_Comp) 

SVM_2013_Eng<- SVM_2013[grep("^/Engineering and technology",SVM_2013[,1]),2]

SVM_2013_Eng_count<- length(SVM_2013_Eng) 

SVM_2013_Soc<- SVM_2013[grep("^/Social sciences",SVM_2013[,1]),2]

SVM_2013_Soc_count<- length(SVM_2013_Soc)


###SVM 2014

SVM_2014<- SVM_search_clean[grep("^2014",SVM_search_clean[,2]),]



SVM_2014_Bio<- SVM_2014[grep("^/Biology and life sciences",SVM_2014[,1]),2]

SVM_2014_Bio_count<- length(SVM_2014_Bio)

SVM_2014_Phys<- SVM_2014[grep("^/Physical sciences",SVM_2014[,1]),2]

SVM_2014_Phys_count<- length(SVM_2014_Phys) 

SVM_2014_Med<- SVM_2014[grep("^/Medicine and health sciences",SVM_2014[,1]),2]

SVM_2014_Med_count<- length(SVM_2014_Med) 

SVM_2014_Res<- SVM_2014[grep("^/Research and analysis methods",SVM_2014[,1]),2]

SVM_2014_Res_count<- length(SVM_2014_Res) 

SVM_2014_Earth<- SVM_2014[grep("^/Earth sciences",SVM_2014[,1]),2]

SVM_2014_Earth_count<- length(SVM_2014_Earth) 

SVM_2014_Comp<- SVM_2014[grep("^/Computer and information sciences",SVM_2014[,1]),2]

SVM_2014_Comp_count<- length(SVM_2014_Comp) 

SVM_2014_Eng<- SVM_2014[grep("^/Engineering and technology",SVM_2014[,1]),2]

SVM_2014_Eng_count<- length(SVM_2014_Eng) 

SVM_2014_Soc<- SVM_2014[grep("^/Social sciences",SVM_2014[,1]),2]

SVM_2014_Soc_count<- length(SVM_2014_Soc)


### SVM 2015

SVM_2015<- SVM_search_clean[grep("^2015",SVM_search_clean[,2]),]


SVM_2015_Bio<- SVM_2015[grep("^/Biology and life sciences",SVM_2015[,1]),2]

SVM_2015_Bio_count<- length(SVM_2015_Bio)

SVM_2015_Phys<- SVM_2015[grep("^/Physical sciences",SVM_2015[,1]),2]

SVM_2015_Phys_count<- length(SVM_2015_Phys) 

SVM_2015_Med<- SVM_2015[grep("^/Medicine and health sciences",SVM_2015[,1]),2]

SVM_2015_Med_count<- length(SVM_2015_Med) 

SVM_2015_Res<- SVM_2015[grep("^/Research and analysis methods",SVM_2015[,1]),2]

SVM_2015_Res_count<- length(SVM_2015_Res) 

SVM_2015_Earth<- SVM_2015[grep("^/Earth sciences",SVM_2015[,1]),2]

SVM_2015_Earth_count<- length(SVM_2015_Earth) 

SVM_2015_Comp<- SVM_2015[grep("^/Computer and information sciences",SVM_2015[,1]),2]

SVM_2015_Comp_count<- length(SVM_2015_Comp) 

SVM_2015_Eng<- SVM_2015[grep("^/Engineering and technology",SVM_2015[,1]),2]

SVM_2015_Eng_count<- length(SVM_2015_Eng) 

SVM_2015_Soc<- SVM_2015[grep("^/Social sciences",SVM_2015[,1]),2]

SVM_2015_Soc_count<- length(SVM_2015_Soc)


##SVM 2016

SVM_2016<- SVM_search_clean[grep("^2016",SVM_search_clean[,2]),]


SVM_2016_Bio<- SVM_2016[grep("^/Biology and life sciences",SVM_2016[,1]),2]

SVM_2016_Bio_count<- length(SVM_2016_Bio)

SVM_2016_Phys<- SVM_2016[grep("^/Physical sciences",SVM_2016[,1]),2]

SVM_2016_Phys_count<- length(SVM_2016_Phys) 

SVM_2016_Med<- SVM_2016[grep("^/Medicine and health sciences",SVM_2016[,1]),2]

SVM_2016_Med_count<- length(SVM_2016_Med) 

SVM_2016_Res<- SVM_2016[grep("^/Research and analysis methods",SVM_2016[,1]),2]

SVM_2016_Res_count<- length(SVM_2016_Res) 

SVM_2016_Earth<- SVM_2016[grep("^/Earth sciences",SVM_2016[,1]),2]

SVM_2016_Earth_count<- length(SVM_2016_Earth) 

SVM_2016_Comp<- SVM_2016[grep("^/Computer and information sciences",SVM_2016[,1]),2]

SVM_2016_Comp_count<- length(SVM_2016_Comp) 

SVM_2016_Eng<- SVM_2016[grep("^/Engineering and technology",SVM_2016[,1]),2]

SVM_2016_Eng_count<- length(SVM_2016_Eng) 

SVM_2016_Soc<- SVM_2016[grep("^/Social sciences",SVM_2016[,1]),2]

SVM_2016_Soc_count<- length(SVM_2016_Soc)



## SVM 2017

SVM_2017<- SVM_search_clean[grep("^2017",SVM_search_clean[,2]),]


SVM_2017_Bio<- SVM_2017[grep("^/Biology and life sciences",SVM_2017[,1]),2]

SVM_2017_Bio_count<- length(SVM_2017_Bio)

SVM_2017_Phys<- SVM_2017[grep("^/Physical sciences",SVM_2017[,1]),2]

SVM_2017_Phys_count<- length(SVM_2017_Phys) 

SVM_2017_Med<- SVM_2017[grep("^/Medicine and health sciences",SVM_2017[,1]),2]

SVM_2017_Med_count<- length(SVM_2017_Med) 

SVM_2017_Res<- SVM_2017[grep("^/Research and analysis methods",SVM_2017[,1]),2]

SVM_2017_Res_count<- length(SVM_2017_Res) 

SVM_2017_Earth<- SVM_2017[grep("^/Earth sciences",SVM_2017[,1]),2]

SVM_2017_Earth_count<- length(SVM_2017_Earth) 

SVM_2017_Comp<- SVM_2017[grep("^/Computer and information sciences",SVM_2017[,1]),2]

SVM_2017_Comp_count<- length(SVM_2017_Comp) 

SVM_2017_Eng<- SVM_2017[grep("^/Engineering and technology",SVM_2017[,1]),2]

SVM_2017_Eng_count<- length(SVM_2017_Eng) 

SVM_2017_Soc<- SVM_2017[grep("^/Social sciences",SVM_2017[,1]),2]

SVM_2017_Soc_count<- length(SVM_2017_Soc)

################## SVM counts table

SVM_counts_2004_bio<- c(SVM_2004_Bio_count,1,rep(0,13),1,rep(0,7))
SVM_counts_2004_Comp<- c(SVM_2004_Comp_count,1,rep(0,13),0,1,rep(0,6))
SVM_counts_2004_Earth<-c(SVM_2004_Earth_count,1,rep(0,13),0,0,1,rep(0,5))
SVM_counts_2004_Eng<- c(SVM_2004_Eng_count,1,rep(0,13),0,0,0,1,rep(0,4))
SVM_counts_2004_Med<- c(SVM_2004_Med_count,1,rep(0,13),rep(0,4),1,0,0,0)
SVM_counts_2004_Phys<- c(SVM_2004_Phys_count,1,rep(0,13),rep(0,5),1,0,0)
SVM_count_2004_Res<-c(SVM_2004_Res_count,1,rep(0,13),rep(0,6),1,0)
SVM_count_2004_Soc<-c(SVM_2004_Soc_count,1,rep(0,13),rep(0,7),1)

SVM_counts_2005_bio<- c(SVM_2005_Bio_count,0,1,rep(0,12),1,rep(0,7))
SVM_counts_2005_Comp<- c(SVM_2005_Comp_count,0,1,rep(0,12),0,1,rep(0,6))
SVM_counts_2005_Earth<-c(SVM_2005_Earth_count,0,1,rep(0,12),0,0,1,rep(0,5))
SVM_counts_2005_Eng<- c(SVM_2005_Eng_count,0,1,rep(0,12),0,0,0,1,rep(0,4))
SVM_counts_2005_Med<- c(SVM_2005_Med_count,0,1,rep(0,12),rep(0,4),1,0,0,0)
SVM_counts_2005_Phys<- c(SVM_2005_Phys_count,0,1,rep(0,12),rep(0,5),1,0,0)
SVM_count_2005_Res<-c(SVM_2005_Res_count,0,1,rep(0,12),rep(0,6),1,0)
SVM_count_2005_Soc<-c(SVM_2005_Soc_count,0,1,rep(0,12),rep(0,7),1)

SVM_counts_2006_bio<- c(SVM_2006_Bio_count,0,0,1,rep(0,11),1,rep(0,7))
SVM_counts_2006_Comp<- c(SVM_2006_Comp_count,0,0,1,rep(0,11),0,1,rep(0,6))
SVM_counts_2006_Earth<-c(SVM_2006_Earth_count,0,0,1,rep(0,11),0,0,1,rep(0,5))
SVM_counts_2006_Eng<- c(SVM_2006_Eng_count,0,0,1,rep(0,11),0,0,0,1,rep(0,4))
SVM_counts_2006_Med<- c(SVM_2006_Med_count,0,0,1,rep(0,11),rep(0,4),1,0,0,0)
SVM_counts_2006_Phys<- c(SVM_2006_Phys_count,0,0,1,rep(0,11),rep(0,5),1,0,0)
SVM_count_2006_Res<-c(SVM_2006_Res_count,0,0,1,rep(0,11),rep(0,6),1,0)
SVM_count_2006_Soc<-c(SVM_2006_Soc_count,0,0,1,rep(0,11),rep(0,7),1)

SVM_counts_2007_bio<- c(SVM_2007_Bio_count,0,0,0,1,rep(0,10),1,rep(0,7))
SVM_counts_2007_Comp<- c(SVM_2007_Comp_count,0,0,0,1,rep(0,10),0,1,rep(0,6))
SVM_counts_2007_Earth<-c(SVM_2007_Earth_count,0,0,0,1,rep(0,10),0,0,1,rep(0,5))
SVM_counts_2007_Eng<- c(SVM_2007_Eng_count,0,0,0,1,rep(0,10),0,0,0,1,rep(0,4))
SVM_counts_2007_Med<- c(SVM_2007_Med_count,0,0,0,1,rep(0,10),rep(0,4),1,0,0,0)
SVM_counts_2007_Phys<- c(SVM_2007_Phys_count,0,0,0,1,rep(0,10),rep(0,5),1,0,0)
SVM_count_2007_Res<-c(SVM_2007_Res_count,0,0,0,1,rep(0,10),rep(0,6),1,0)
SVM_count_2007_Soc<-c(SVM_2007_Soc_count,0,0,0,1,rep(0,10),rep(0,7),1)

SVM_counts_2008_bio<- c(SVM_2008_Bio_count,rep(0,4),1,rep(0,9),1,rep(0,7))
SVM_counts_2008_Comp<- c(SVM_2008_Comp_count,rep(0,4),1,rep(0,9),0,1,rep(0,6))
SVM_counts_2008_Earth<-c(SVM_2008_Earth_count,rep(0,4),1,rep(0,9),0,0,1,rep(0,5))
SVM_counts_2008_Eng<- c(SVM_2008_Eng_count,rep(0,4),1,rep(0,9),0,0,0,1,rep(0,4))
SVM_counts_2008_Med<- c(SVM_2008_Med_count,rep(0,4),1,rep(0,9),rep(0,4),1,0,0,0)
SVM_counts_2008_Phys<- c(SVM_2008_Phys_count,rep(0,4),1,rep(0,9),rep(0,5),1,0,0)
SVM_count_2008_Res<-c(SVM_2008_Res_count,rep(0,4),1,rep(0,9),rep(0,6),1,0)
SVM_count_2008_Soc<-c(SVM_2008_Soc_count,rep(0,4),1,rep(0,9),rep(0,7),1)


SVM_counts_2009_bio<- c(SVM_2009_Bio_count,rep(0,5),1,rep(0,8),1,rep(0,7))
SVM_counts_2009_Comp<- c(SVM_2009_Comp_count,rep(0,5),1,rep(0,8),0,1,rep(0,6))
SVM_counts_2009_Earth<-c(SVM_2009_Earth_count,rep(0,5),1,rep(0,8),0,0,1,rep(0,5))
SVM_counts_2009_Eng<- c(SVM_2009_Eng_count,rep(0,5),1,rep(0,8),0,0,0,1,rep(0,4))
SVM_counts_2009_Med<- c(SVM_2009_Med_count,rep(0,5),1,rep(0,8),rep(0,4),1,0,0,0)
SVM_counts_2009_Phys<- c(SVM_2009_Phys_count,rep(0,5),1,rep(0,8),rep(0,5),1,0,0)
SVM_count_2009_Res<-c(SVM_2009_Res_count,rep(0,5),1,rep(0,8),rep(0,6),1,0)
SVM_count_2009_Soc<-c(SVM_2009_Soc_count,rep(0,5),1,rep(0,8),rep(0,7),1)

SVM_counts_2010_bio<- c(SVM_2010_Bio_count,rep(0,6),1,rep(0,7),1,rep(0,7))
SVM_counts_2010_Comp<- c(SVM_2010_Comp_count,rep(0,6),1,rep(0,7),0,1,rep(0,6))
SVM_counts_2010_Earth<-c(SVM_2010_Earth_count,rep(0,6),1,rep(0,7),0,0,1,rep(0,5))
SVM_counts_2010_Eng<- c(SVM_2010_Eng_count,rep(0,6),1,rep(0,7),0,0,0,1,rep(0,4))
SVM_counts_2010_Med<- c(SVM_2010_Med_count,rep(0,6),1,rep(0,7),rep(0,4),1,0,0,0)
SVM_counts_2010_Phys<- c(SVM_2010_Phys_count,rep(0,6),1,rep(0,7),rep(0,5),1,0,0)
SVM_count_2010_Res<-c(SVM_2010_Res_count,rep(0,6),1,rep(0,7),rep(0,6),1,0)
SVM_count_2010_Soc<-c(SVM_2010_Soc_count,rep(0,6),1,rep(0,7),rep(0,7),1)


SVM_counts_2011_bio<- c(SVM_2011_Bio_count,rep(0,7),1,rep(0,6),1,rep(0,7))
SVM_counts_2011_Comp<- c(SVM_2011_Comp_count,rep(0,7),1,rep(0,6),0,1,rep(0,6))
SVM_counts_2011_Earth<-c(SVM_2011_Earth_count,rep(0,7),1,rep(0,6),0,0,1,rep(0,5))
SVM_counts_2011_Eng<- c(SVM_2011_Eng_count,rep(0,7),1,rep(0,6),0,0,0,1,rep(0,4))
SVM_counts_2011_Med<- c(SVM_2011_Med_count,rep(0,7),1,rep(0,6),rep(0,4),1,0,0,0)
SVM_counts_2011_Phys<- c(SVM_2011_Phys_count,rep(0,7),1,rep(0,6),rep(0,5),1,0,0)
SVM_count_2011_Res<-c(SVM_2011_Res_count,rep(0,7),1,rep(0,6),rep(0,6),1,0)
SVM_count_2011_Soc<-c(SVM_2011_Soc_count,rep(0,7),1,rep(0,6),rep(0,7),1)

SVM_counts_2012_bio<- c(SVM_2012_Bio_count,rep(0,8),1,rep(0,5),1,rep(0,7))
SVM_counts_2012_Comp<- c(SVM_2012_Comp_count,rep(0,8),1,rep(0,5),0,1,rep(0,6))
SVM_counts_2012_Earth<-c(SVM_2012_Earth_count,rep(0,8),1,rep(0,5),0,0,1,rep(0,5))
SVM_counts_2012_Eng<- c(SVM_2012_Eng_count,rep(0,8),1,rep(0,5),0,0,0,1,rep(0,4))
SVM_counts_2012_Med<- c(SVM_2012_Med_count,rep(0,8),1,rep(0,5),rep(0,4),1,0,0,0)
SVM_counts_2012_Phys<- c(SVM_2012_Phys_count,rep(0,8),1,rep(0,5),rep(0,5),1,0,0)
SVM_count_2012_Res<-c(SVM_2012_Res_count,rep(0,8),1,rep(0,5),rep(0,6),1,0)
SVM_count_2012_Soc<-c(SVM_2012_Soc_count,rep(0,8),1,rep(0,5),rep(0,7),1)

SVM_counts_2013_bio<- c(SVM_2013_Bio_count,rep(0,9),1,rep(0,4),1,rep(0,7))
SVM_counts_2013_Comp<- c(SVM_2013_Comp_count,rep(0,9),1,rep(0,4),0,1,rep(0,6))
SVM_counts_2013_Earth<-c(SVM_2013_Earth_count,rep(0,9),1,rep(0,4),0,0,1,rep(0,5))
SVM_counts_2013_Eng<- c(SVM_2013_Eng_count,rep(0,9),1,rep(0,4),0,0,0,1,rep(0,4))
SVM_counts_2013_Med<- c(SVM_2013_Med_count,rep(0,9),1,rep(0,4),rep(0,4),1,0,0,0)
SVM_counts_2013_Phys<- c(SVM_2013_Phys_count,rep(0,9),1,rep(0,4),rep(0,5),1,0,0)
SVM_count_2013_Res<-c(SVM_2013_Res_count,rep(0,9),1,rep(0,4),rep(0,6),1,0)
SVM_count_2013_Soc<-c(SVM_2013_Soc_count,rep(0,9),1,rep(0,4),rep(0,7),1)

SVM_counts_2014_bio<- c(SVM_2014_Bio_count,rep(0,10),1,rep(0,3),1,rep(0,7))
SVM_counts_2014_Comp<- c(SVM_2014_Comp_count,rep(0,10),1,rep(0,3),0,1,rep(0,6))
SVM_counts_2014_Earth<-c(SVM_2014_Earth_count,rep(0,10),1,rep(0,3),0,0,1,rep(0,5))
SVM_counts_2014_Eng<- c(SVM_2014_Eng_count,rep(0,10),1,rep(0,3),0,0,0,1,rep(0,4))
SVM_counts_2014_Med<- c(SVM_2014_Med_count,rep(0,10),1,rep(0,3),rep(0,4),1,0,0,0)
SVM_counts_2014_Phys<- c(SVM_2014_Phys_count,rep(0,10),1,rep(0,3),rep(0,5),1,0,0)
SVM_count_2014_Res<-c(SVM_2014_Res_count,rep(0,10),1,rep(0,3),rep(0,6),1,0)
SVM_count_2014_Soc<-c(SVM_2014_Soc_count,rep(0,10),1,rep(0,3),rep(0,7),1)

SVM_counts_2015_bio<- c(SVM_2015_Bio_count,rep(0,11),1,rep(0,2),1,rep(0,7))
SVM_counts_2015_Comp<- c(SVM_2015_Comp_count,rep(0,11),1,rep(0,2),0,1,rep(0,6))
SVM_counts_2015_Earth<-c(SVM_2015_Earth_count,rep(0,11),1,rep(0,2),0,0,1,rep(0,5))
SVM_counts_2015_Eng<- c(SVM_2015_Eng_count,rep(0,11),1,rep(0,2),0,0,0,1,rep(0,4))
SVM_counts_2015_Med<- c(SVM_2015_Med_count,rep(0,11),1,rep(0,2),rep(0,4),1,0,0,0)
SVM_counts_2015_Phys<- c(SVM_2015_Phys_count,rep(0,11),1,rep(0,2),rep(0,5),1,0,0)
SVM_count_2015_Res<-c(SVM_2015_Res_count,rep(0,11),1,rep(0,2),rep(0,6),1,0)
SVM_count_2015_Soc<-c(SVM_2015_Soc_count,rep(0,11),1,rep(0,2),rep(0,7),1)

SVM_counts_2016_bio<- c(SVM_2016_Bio_count,rep(0,12),1,rep(0,1),1,rep(0,7))
SVM_counts_2016_Comp<- c(SVM_2016_Comp_count,rep(0,12),1,rep(0,1),0,1,rep(0,6))
SVM_counts_2016_Earth<-c(SVM_2016_Earth_count,rep(0,12),1,rep(0,1),0,0,1,rep(0,5))
SVM_counts_2016_Eng<- c(SVM_2016_Eng_count,rep(0,12),1,rep(0,1),0,0,0,1,rep(0,4))
SVM_counts_2016_Med<- c(SVM_2016_Med_count,rep(0,12),1,rep(0,1),rep(0,4),1,0,0,0)
SVM_counts_2016_Phys<- c(SVM_2016_Phys_count,rep(0,12),1,rep(0,1),rep(0,5),1,0,0)
SVM_count_2016_Res<-c(SVM_2016_Res_count,rep(0,12),1,rep(0,1),rep(0,6),1,0)
SVM_count_2016_Soc<-c(SVM_2016_Soc_count,rep(0,12),1,rep(0,1),rep(0,7),1)

SVM_counts_2017_bio<- c(SVM_2017_Bio_count,rep(0,13),1,1,rep(0,7))
SVM_counts_2017_Comp<- c(SVM_2017_Comp_count,rep(0,13),1,0,1,rep(0,6))
SVM_counts_2017_Earth<-c(SVM_2017_Earth_count,rep(0,13),1,0,0,1,rep(0,5))
SVM_counts_2017_Eng<- c(SVM_2017_Eng_count,rep(0,13),1,0,0,0,1,rep(0,4))
SVM_counts_2017_Med<- c(SVM_2017_Med_count,rep(0,13),1,rep(0,4),1,0,0,0)
SVM_counts_2017_Phys<- c(SVM_2017_Phys_count,rep(0,13),1,rep(0,5),1,0,0)
SVM_count_2017_Res<-c(SVM_2017_Res_count,rep(0,13),1,rep(0,6),1,0)
SVM_count_2017_Soc<-c(SVM_2017_Soc_count,rep(0,13),1,rep(0,7),1)

SVM_table<- rbind(SVM_counts_2004_bio,SVM_counts_2004_Comp,SVM_counts_2004_Earth,
                    SVM_counts_2004_Eng,SVM_counts_2004_Med,SVM_counts_2004_Phys,
                    SVM_count_2004_Res,SVM_count_2004_Soc,SVM_counts_2005_bio,
                    SVM_counts_2005_Comp,SVM_counts_2005_Earth,SVM_counts_2005_Eng,
                    SVM_counts_2005_Med,SVM_counts_2005_Phys,SVM_count_2005_Res,
                    SVM_count_2005_Soc,SVM_counts_2006_bio,
                    SVM_counts_2006_Comp,SVM_counts_2006_Earth,SVM_counts_2006_Eng,
                    SVM_counts_2006_Med,SVM_counts_2006_Phys,SVM_count_2006_Res,
                    SVM_count_2006_Soc,SVM_counts_2007_bio,
                    SVM_counts_2007_Comp,SVM_counts_2007_Earth,SVM_counts_2007_Eng,
                    SVM_counts_2007_Med,SVM_counts_2007_Phys,SVM_count_2007_Res,
                    SVM_count_2007_Soc, SVM_counts_2008_bio,
                    SVM_counts_2008_Comp,SVM_counts_2008_Earth,SVM_counts_2008_Eng,
                    SVM_counts_2008_Med,SVM_counts_2008_Phys,SVM_count_2008_Res,
                    SVM_count_2008_Soc, SVM_counts_2009_bio,
                    SVM_counts_2009_Comp,SVM_counts_2009_Earth,SVM_counts_2009_Eng,
                    SVM_counts_2009_Med,SVM_counts_2009_Phys,SVM_count_2009_Res,
                    SVM_count_2009_Soc,SVM_counts_2010_bio,
                    SVM_counts_2010_Comp,SVM_counts_2010_Earth,SVM_counts_2010_Eng,
                    SVM_counts_2010_Med,SVM_counts_2010_Phys,SVM_count_2010_Res,
                    SVM_count_2010_Soc,SVM_counts_2011_bio,
                    SVM_counts_2011_Comp,SVM_counts_2011_Earth,SVM_counts_2011_Eng,
                    SVM_counts_2011_Med,SVM_counts_2011_Phys,SVM_count_2011_Res,
                    SVM_count_2011_Soc,SVM_counts_2012_bio,
                    SVM_counts_2012_Comp,SVM_counts_2012_Earth,SVM_counts_2012_Eng,
                    SVM_counts_2012_Med,SVM_counts_2012_Phys,SVM_count_2012_Res,
                    SVM_count_2012_Soc, SVM_counts_2013_bio,
                    SVM_counts_2013_Comp,SVM_counts_2013_Earth,SVM_counts_2013_Eng,
                    SVM_counts_2013_Med,SVM_counts_2013_Phys,SVM_count_2013_Res,
                    SVM_count_2013_Soc, SVM_counts_2014_bio,
                    SVM_counts_2014_Comp,SVM_counts_2014_Earth,SVM_counts_2014_Eng,
                    SVM_counts_2014_Med,SVM_counts_2014_Phys,SVM_count_2014_Res,
                    SVM_count_2014_Soc,SVM_counts_2015_bio,
                    SVM_counts_2015_Comp,SVM_counts_2015_Earth,SVM_counts_2015_Eng,
                    SVM_counts_2015_Med,SVM_counts_2015_Phys,SVM_count_2015_Res,
                    SVM_count_2015_Soc,SVM_counts_2016_bio,
                    SVM_counts_2016_Comp,SVM_counts_2016_Earth,SVM_counts_2016_Eng,
                    SVM_counts_2016_Med,SVM_counts_2016_Phys,SVM_count_2016_Res,
                    SVM_count_2016_Soc, SVM_counts_2017_bio,
                    SVM_counts_2017_Comp,SVM_counts_2017_Earth,SVM_counts_2017_Eng,
                    SVM_counts_2017_Med,SVM_counts_2017_Phys,SVM_count_2017_Res,
                    SVM_count_2017_Soc)

SVM_table[97:112,]
as.data.frame(SVM_table)

colnames(SVM_table)<- c("SVM_counts","2004","2005","2006","2007","2008","2009",
                          "2010","2011","2012","2013","2014","2015","2016","2017",
                          "Biology and life sciences","Computer and information sciences",
                          "Earth sciences","Engineering and tecnhology",
                          "Medicine and health sciences","Physical sciences",
                          "Research and analysis","Social Sciences")

as.numeric(SVM_table[,1])

year_covs<- SVM_table[,2:15]

terms_covs<- SVM_table[,16:23]

########################## SVM model fit $##################

model_SVM<- glm(SVM_table[,1]~year_covs*terms_covs, family="poisson")

summary(model_SVM)

################ Machine learning counts assembly ############

ML_search<- searchplos(q="machine learning",fl=c("subject","publication_date"),limit=10000)


ML_search_clean<- matrix(unlist(ML_search[[2]]),ncol=2)



###ML 2004
ML_2004<- ML_search_clean[grep("^2004",ML_search_clean[,2]),]


ML_2004_Bio<- ML_2004[grep("^/Biology and life sciences",ML_2004[,1]),2]

ML_2004_Bio_count<- length(ML_2004_Bio)

ML_2004_Phys<- ML_2004[grep("^/Physical sciences",ML_2004[,1]),2]

ML_2004_Phys_count<- length(ML_2004_Phys) 

ML_2004_Med<- ML_2004[grep("^/Medicine and health sciences",ML_2004[,1]),2]

ML_2004_Med_count<- length(ML_2004_Med) 

ML_2004_Res<- ML_2004[grep("^/Research and analysis methods",ML_2004[,1]),2]

ML_2004_Res_count<- length(ML_2004_Res) 

ML_2004_Earth<- ML_2004[grep("^/Earth sciences",ML_2004[,1]),2]

ML_2004_Earth_count<- length(ML_2004_Earth) 

ML_2004_Comp<- ML_2004[grep("^/Computer and information sciences",ML_2004[,1]),2]

ML_2004_Comp_count<- length(ML_2004_Comp) 

ML_2004_Eng<- ML_2004[grep("^/Engineering and technology",ML_2004[,1]),2]

ML_2004_Eng_count<- length(ML_2004_Eng) 

ML_2004_Soc<- ML_2004[grep("^/Social sciences",ML_2004[,1]),2]

ML_2004_Soc_count<- length(ML_2004_Soc) 



########ML 2005

ML_2005<- ML_search_clean[grep("^2005",ML_search_clean[,2]),]

ML_2005_Bio<- ML_2005[grep("^/Biology and life sciences",ML_2005[,1]),2]

ML_2005_Bio_count<- length(ML_2005_Bio)

ML_2005_Phys<- ML_2005[grep("^/Physical sciences",ML_2005[,1]),2]

ML_2005_Phys_count<- length(ML_2005_Phys) 

ML_2005_Med<- ML_2005[grep("^/Medicine and health sciences",ML_2005[,1]),2]

ML_2005_Med_count<- length(ML_2005_Med) 

ML_2005_Res<- ML_2005[grep("^/Research and analysis methods",ML_2005[,1]),2]

ML_2005_Res_count<- length(ML_2005_Res) 

ML_2005_Earth<- ML_2005[grep("^/Earth sciences",ML_2005[,1]),2]

ML_2005_Earth_count<- length(ML_2005_Earth) 

ML_2005_Comp<- ML_2005[grep("^/Computer and information sciences",ML_2005[,1]),2]

ML_2005_Comp_count<- length(ML_2005_Comp) 

ML_2005_Eng<- ML_2005[grep("^/Engineering and technology",ML_2005[,1]),2]

ML_2005_Eng_count<- length(ML_2005_Eng) 

ML_2005_Soc<- ML_2005[grep("^/Social sciences",ML_2005[,1]),2]

ML_2005_Soc_count<- length(ML_2005_Soc) 


###### ML 2006


ML_2006<- ML_search_clean[grep("^2006",ML_search_clean[,2]),]


ML_2006_Bio<- ML_2006[grep("^/Biology and life sciences",ML_2006[,1]),2]

ML_2006_Bio_count<- length(ML_2006_Bio)

ML_2006_Phys<- ML_2006[grep("^/Physical sciences",ML_2006[,1]),2]

ML_2006_Phys_count<- length(ML_2006_Phys) 

ML_2006_Med<- ML_2006[grep("^/Medicine and health sciences",ML_2006[,1]),2]

ML_2006_Med_count<- length(ML_2006_Med) 

ML_2006_Res<- ML_2006[grep("^/Research and analysis methods",ML_2006[,1]),2]

ML_2006_Res_count<- length(ML_2006_Res) 

ML_2006_Earth<- ML_2006[grep("^/Earth sciences",ML_2006[,1]),2]

ML_2006_Earth_count<- length(ML_2006_Earth) 

ML_2006_Comp<- ML_2006[grep("^/Computer and information sciences",ML_2006[,1]),2]

ML_2006_Comp_count<- length(ML_2006_Comp) 

ML_2006_Eng<- ML_2006[grep("^/Engineering and technology",ML_2006[,1]),2]

ML_2006_Eng_count<- length(ML_2006_Eng) 

ML_2006_Soc<- ML_2006[grep("^/Social sciences",ML_2006[,1]),2]

ML_2006_Soc_count<- length(ML_2006_Soc) 


## ML 2007


ML_2007<- ML_search_clean[grep("^2007",ML_search_clean[,2]),]


ML_2007_Bio<- ML_2007[grep("^/Biology and life sciences",ML_2007[,1]),2]

ML_2007_Bio_count<- length(ML_2007_Bio)

ML_2007_Phys<- ML_2007[grep("^/Physical sciences",ML_2007[,1]),2]

ML_2007_Phys_count<- length(ML_2007_Phys) 

ML_2007_Med<- ML_2007[grep("^/Medicine and health sciences",ML_2007[,1]),2]

ML_2007_Med_count<- length(ML_2007_Med) 

ML_2007_Res<- ML_2007[grep("^/Research and analysis methods",ML_2007[,1]),2]

ML_2007_Res_count<- length(ML_2007_Res) 

ML_2007_Earth<- ML_2007[grep("^/Earth sciences",ML_2007[,1]),2]

ML_2007_Earth_count<- length(ML_2007_Earth) 

ML_2007_Comp<- ML_2007[grep("^/Computer and information sciences",ML_2007[,1]),2]

ML_2007_Comp_count<- length(ML_2007_Comp) 

ML_2007_Eng<- ML_2007[grep("^/Engineering and technology",ML_2007[,1]),2]

ML_2007_Eng_count<- length(ML_2007_Eng) 

ML_2007_Soc<- ML_2007[grep("^/Social sciences",ML_2007[,1]),2]

ML_2007_Soc_count<- length(ML_2007_Soc) 


#### ML 2008
ML_2008<- ML_search_clean[grep("^2008",ML_search_clean[,2]),]


ML_2008_Bio<- ML_2008[grep("^/Biology and life sciences",ML_2008[,1]),2]

ML_2008_Bio_count<- length(ML_2008_Bio)

ML_2008_Phys<- ML_2008[grep("^/Physical sciences",ML_2008[,1]),2]

ML_2008_Phys_count<- length(ML_2008_Phys) 

ML_2008_Med<- ML_2008[grep("^/Medicine and health sciences",ML_2008[,1]),2]

ML_2008_Med_count<- length(ML_2008_Med) 

ML_2008_Res<- ML_2008[grep("^/Research and analysis methods",ML_2008[,1]),2]

ML_2008_Res_count<- length(ML_2008_Res) 

ML_2008_Earth<- ML_2008[grep("^/Earth sciences",ML_2008[,1]),2]

ML_2008_Earth_count<- length(ML_2008_Earth) 

ML_2008_Comp<- ML_2008[grep("^/Computer and information sciences",ML_2008[,1]),2]

ML_2008_Comp_count<- length(ML_2008_Comp) 

ML_2008_Eng<- ML_2008[grep("^/Engineering and technology",ML_2008[,1]),2]

ML_2008_Eng_count<- length(ML_2008_Eng) 

ML_2008_Soc<- ML_2008[grep("^/Social sciences",ML_2008[,1]),2]

ML_2008_Soc_count<- length(ML_2008_Soc) 


##2009

ML_2009<- ML_search_clean[grep("^2009",ML_search_clean[,2]),]


ML_2009_Bio<- ML_2009[grep("^/Biology and life sciences",ML_2009[,1]),2]

ML_2009_Bio_count<- length(ML_2009_Bio)

ML_2009_Phys<- ML_2009[grep("^/Physical sciences",ML_2009[,1]),2]

ML_2009_Phys_count<- length(ML_2009_Phys) 

ML_2009_Med<- ML_2009[grep("^/Medicine and health sciences",ML_2009[,1]),2]

ML_2009_Med_count<- length(ML_2009_Med) 

ML_2009_Res<- ML_2009[grep("^/Research and analysis methods",ML_2009[,1]),2]

ML_2009_Res_count<- length(ML_2009_Res) 

ML_2009_Earth<- ML_2009[grep("^/Earth sciences",ML_2009[,1]),2]

ML_2009_Earth_count<- length(ML_2009_Earth) 

ML_2009_Comp<- ML_2009[grep("^/Computer and information sciences",ML_2009[,1]),2]

ML_2009_Comp_count<- length(ML_2009_Comp) 

ML_2009_Eng<- ML_2009[grep("^/Engineering and technology",ML_2009[,1]),2]

ML_2009_Eng_count<- length(ML_2009_Eng) 

ML_2009_Soc<- ML_2009[grep("^/Social sciences",ML_2009[,1]),2]

ML_2009_Soc_count<- length(ML_2009_Soc)


### ML 2010

ML_2010<- ML_search_clean[grep("^2010",ML_search_clean[,2]),]


ML_2010_Bio<- ML_2010[grep("^/Biology and life sciences",ML_2010[,1]),2]

ML_2010_Bio_count<- length(ML_2010_Bio)

ML_2010_Phys<- ML_2010[grep("^/Physical sciences",ML_2010[,1]),2]

ML_2010_Phys_count<- length(ML_2010_Phys) 

ML_2010_Med<- ML_2010[grep("^/Medicine and health sciences",ML_2010[,1]),2]

ML_2010_Med_count<- length(ML_2010_Med) 

ML_2010_Res<- ML_2010[grep("^/Research and analysis methods",ML_2010[,1]),2]

ML_2010_Res_count<- length(ML_2010_Res) 

ML_2010_Earth<- ML_2010[grep("^/Earth sciences",ML_2010[,1]),2]

ML_2010_Earth_count<- length(ML_2010_Earth) 

ML_2010_Comp<- ML_2010[grep("^/Computer and information sciences",ML_2010[,1]),2]

ML_2010_Comp_count<- length(ML_2010_Comp) 

ML_2010_Eng<- ML_2010[grep("^/Engineering and technology",ML_2010[,1]),2]

ML_2010_Eng_count<- length(ML_2010_Eng) 

ML_2010_Soc<- ML_2010[grep("^/Social sciences",ML_2010[,1]),2]

ML_2010_Soc_count<- length(ML_2010_Soc)


###2011 ML

ML_2011<- ML_search_clean[grep("^2011",ML_search_clean[,2]),]

ML_2011_Bio<- ML_2011[grep("^/Biology and life sciences",ML_2011[,1]),2]

ML_2011_Bio_count<- length(ML_2011_Bio)

ML_2011_Phys<- ML_2011[grep("^/Physical sciences",ML_2011[,1]),2]

ML_2011_Phys_count<- length(ML_2011_Phys) 

ML_2011_Med<- ML_2011[grep("^/Medicine and health sciences",ML_2011[,1]),2]

ML_2011_Med_count<- length(ML_2011_Med) 

ML_2011_Res<- ML_2011[grep("^/Research and analysis methods",ML_2011[,1]),2]

ML_2011_Res_count<- length(ML_2011_Res) 

ML_2011_Earth<- ML_2011[grep("^/Earth sciences",ML_2011[,1]),2]

ML_2011_Earth_count<- length(ML_2011_Earth) 

ML_2011_Comp<- ML_2011[grep("^/Computer and information sciences",ML_2011[,1]),2]

ML_2011_Comp_count<- length(ML_2011_Comp) 

ML_2011_Eng<- ML_2011[grep("^/Engineering and technology",ML_2011[,1]),2]

ML_2011_Eng_count<- length(ML_2011_Eng) 

ML_2011_Soc<- ML_2011[grep("^/Social sciences",ML_2011[,1]),2]

ML_2011_Soc_count<- length(ML_2011_Soc)


###ML 2012
ML_2012<- ML_search_clean[grep("^2012",ML_search_clean[,2]),]

ML_2012_Bio<- ML_2012[grep("^/Biology and life sciences",ML_2012[,1]),2]

ML_2012_Bio_count<- length(ML_2012_Bio)

ML_2012_Phys<- ML_2012[grep("^/Physical sciences",ML_2012[,1]),2]

ML_2012_Phys_count<- length(ML_2012_Phys) 

ML_2012_Med<- ML_2012[grep("^/Medicine and health sciences",ML_2012[,1]),2]

ML_2012_Med_count<- length(ML_2012_Med) 

ML_2012_Res<- ML_2012[grep("^/Research and analysis methods",ML_2012[,1]),2]

ML_2012_Res_count<- length(ML_2012_Res) 

ML_2012_Earth<- ML_2012[grep("^/Earth sciences",ML_2012[,1]),2]

ML_2012_Earth_count<- length(ML_2012_Earth) 

ML_2012_Comp<- ML_2012[grep("^/Computer and information sciences",ML_2012[,1]),2]

ML_2012_Comp_count<- length(ML_2012_Comp) 

ML_2012_Eng<- ML_2012[grep("^/Engineering and technology",ML_2012[,1]),2]

ML_2012_Eng_count<- length(ML_2012_Eng) 

ML_2012_Soc<- ML_2012[grep("^/Social sciences",ML_2012[,1]),2]

ML_2012_Soc_count<- length(ML_2012_Soc)



##ML 2013

ML_2013<- ML_search_clean[grep("^2013",ML_search_clean[,2]),]

ML_2013_Bio<- ML_2013[grep("^/Biology and life sciences",ML_2013[,1]),2]

ML_2013_Bio_count<- length(ML_2013_Bio)

ML_2013_Phys<- ML_2013[grep("^/Physical sciences",ML_2013[,1]),2]

ML_2013_Phys_count<- length(ML_2013_Phys) 

ML_2013_Med<- ML_2013[grep("^/Medicine and health sciences",ML_2013[,1]),2]

ML_2013_Med_count<- length(ML_2013_Med) 

ML_2013_Res<- ML_2013[grep("^/Research and analysis methods",ML_2013[,1]),2]

ML_2013_Res_count<- length(ML_2013_Res) 

ML_2013_Earth<- ML_2013[grep("^/Earth sciences",ML_2013[,1]),2]

ML_2013_Earth_count<- length(ML_2013_Earth) 

ML_2013_Comp<- ML_2013[grep("^/Computer and information sciences",ML_2013[,1]),2]

ML_2013_Comp_count<- length(ML_2013_Comp) 

ML_2013_Eng<- ML_2013[grep("^/Engineering and technology",ML_2013[,1]),2]

ML_2013_Eng_count<- length(ML_2013_Eng) 

ML_2013_Soc<- ML_2013[grep("^/Social sciences",ML_2013[,1]),2]

ML_2013_Soc_count<- length(ML_2013_Soc)


###ML 2014

ML_2014<- ML_search_clean[grep("^2014",ML_search_clean[,2]),]



ML_2014_Bio<- ML_2014[grep("^/Biology and life sciences",ML_2014[,1]),2]

ML_2014_Bio_count<- length(ML_2014_Bio)

ML_2014_Phys<- ML_2014[grep("^/Physical sciences",ML_2014[,1]),2]

ML_2014_Phys_count<- length(ML_2014_Phys) 

ML_2014_Med<- ML_2014[grep("^/Medicine and health sciences",ML_2014[,1]),2]

ML_2014_Med_count<- length(ML_2014_Med) 

ML_2014_Res<- ML_2014[grep("^/Research and analysis methods",ML_2014[,1]),2]

ML_2014_Res_count<- length(ML_2014_Res) 

ML_2014_Earth<- ML_2014[grep("^/Earth sciences",ML_2014[,1]),2]

ML_2014_Earth_count<- length(ML_2014_Earth) 

ML_2014_Comp<- ML_2014[grep("^/Computer and information sciences",ML_2014[,1]),2]

ML_2014_Comp_count<- length(ML_2014_Comp) 

ML_2014_Eng<- ML_2014[grep("^/Engineering and technology",ML_2014[,1]),2]

ML_2014_Eng_count<- length(ML_2014_Eng) 

ML_2014_Soc<- ML_2014[grep("^/Social sciences",ML_2014[,1]),2]

ML_2014_Soc_count<- length(ML_2014_Soc)



### ML 2015

ML_2015<- ML_search_clean[grep("^2015",ML_search_clean[,2]),]


ML_2015_Bio<- ML_2015[grep("^/Biology and life sciences",ML_2015[,1]),2]

ML_2015_Bio_count<- length(ML_2015_Bio)

ML_2015_Phys<- ML_2015[grep("^/Physical sciences",ML_2015[,1]),2]

ML_2015_Phys_count<- length(ML_2015_Phys) 

ML_2015_Med<- ML_2015[grep("^/Medicine and health sciences",ML_2015[,1]),2]

ML_2015_Med_count<- length(ML_2015_Med) 

ML_2015_Res<- ML_2015[grep("^/Research and analysis methods",ML_2015[,1]),2]

ML_2015_Res_count<- length(ML_2015_Res) 

ML_2015_Earth<- ML_2015[grep("^/Earth sciences",ML_2015[,1]),2]

ML_2015_Earth_count<- length(ML_2015_Earth) 

ML_2015_Comp<- ML_2015[grep("^/Computer and information sciences",ML_2015[,1]),2]

ML_2015_Comp_count<- length(ML_2015_Comp) 

ML_2015_Eng<- ML_2015[grep("^/Engineering and technology",ML_2015[,1]),2]

ML_2015_Eng_count<- length(ML_2015_Eng) 

ML_2015_Soc<- ML_2015[grep("^/Social sciences",ML_2015[,1]),2]

ML_2015_Soc_count<- length(ML_2015_Soc)



##ML 2016

ML_2016<- ML_search_clean[grep("^2016",ML_search_clean[,2]),]


ML_2016_Bio<- ML_2016[grep("^/Biology and life sciences",ML_2016[,1]),2]

ML_2016_Bio_count<- length(ML_2016_Bio)

ML_2016_Phys<- ML_2016[grep("^/Physical sciences",ML_2016[,1]),2]

ML_2016_Phys_count<- length(ML_2016_Phys) 

ML_2016_Med<- ML_2016[grep("^/Medicine and health sciences",ML_2016[,1]),2]

ML_2016_Med_count<- length(ML_2016_Med) 

ML_2016_Res<- ML_2016[grep("^/Research and analysis methods",ML_2016[,1]),2]

ML_2016_Res_count<- length(ML_2016_Res) 

ML_2016_Earth<- ML_2016[grep("^/Earth sciences",ML_2016[,1]),2]

ML_2016_Earth_count<- length(ML_2016_Earth) 

ML_2016_Comp<- ML_2016[grep("^/Computer and information sciences",ML_2016[,1]),2]

ML_2016_Comp_count<- length(ML_2016_Comp) 

ML_2016_Eng<- ML_2016[grep("^/Engineering and technology",ML_2016[,1]),2]

ML_2016_Eng_count<- length(ML_2016_Eng) 

ML_2016_Soc<- ML_2016[grep("^/Social sciences",ML_2016[,1]),2]

ML_2016_Soc_count<- length(ML_2016_Soc)


## ML 2017

ML_2017<- ML_search_clean[grep("^2017",ML_search_clean[,2]),]


ML_2017_Bio<- ML_2017[grep("^/Biology and life sciences",ML_2017[,1]),2]

ML_2017_Bio_count<- length(ML_2017_Bio)

ML_2017_Phys<- ML_2017[grep("^/Physical sciences",ML_2017[,1]),2]

ML_2017_Phys_count<- length(ML_2017_Phys) 

ML_2017_Med<- ML_2017[grep("^/Medicine and health sciences",ML_2017[,1]),2]

ML_2017_Med_count<- length(ML_2017_Med) 

ML_2017_Res<- ML_2017[grep("^/Research and analysis methods",ML_2017[,1]),2]

ML_2017_Res_count<- length(ML_2017_Res) 

ML_2017_Earth<- ML_2017[grep("^/Earth sciences",ML_2017[,1]),2]

ML_2017_Earth_count<- length(ML_2017_Earth) 

ML_2017_Comp<- ML_2017[grep("^/Computer and information sciences",ML_2017[,1]),2]

ML_2017_Comp_count<- length(ML_2017_Comp) 

ML_2017_Eng<- ML_2017[grep("^/Engineering and technology",ML_2017[,1]),2]

ML_2017_Eng_count<- length(ML_2017_Eng) 

ML_2017_Soc<- ML_2017[grep("^/Social sciences",ML_2017[,1]),2]

ML_2017_Soc_count<- length(ML_2017_Soc)


#### ML counts table


ML_counts_2004_bio<- c(ML_2004_Bio_count,1,rep(0,13),1,rep(0,7))
ML_counts_2004_Comp<- c(ML_2004_Comp_count,1,rep(0,13),0,1,rep(0,6))
ML_counts_2004_Earth<-c(ML_2004_Earth_count,1,rep(0,13),0,0,1,rep(0,5))
ML_counts_2004_Eng<- c(ML_2004_Eng_count,1,rep(0,13),0,0,0,1,rep(0,4))
ML_counts_2004_Med<- c(ML_2004_Med_count,1,rep(0,13),rep(0,4),1,0,0,0)
ML_counts_2004_Phys<- c(ML_2004_Phys_count,1,rep(0,13),rep(0,5),1,0,0)
ML_count_2004_Res<-c(ML_2004_Res_count,1,rep(0,13),rep(0,6),1,0)
ML_count_2004_Soc<-c(ML_2004_Soc_count,1,rep(0,13),rep(0,7),1)

ML_counts_2005_bio<- c(ML_2005_Bio_count,0,1,rep(0,12),1,rep(0,7))
ML_counts_2005_Comp<- c(ML_2005_Comp_count,0,1,rep(0,12),0,1,rep(0,6))
ML_counts_2005_Earth<-c(ML_2005_Earth_count,0,1,rep(0,12),0,0,1,rep(0,5))
ML_counts_2005_Eng<- c(ML_2005_Eng_count,0,1,rep(0,12),0,0,0,1,rep(0,4))
ML_counts_2005_Med<- c(ML_2005_Med_count,0,1,rep(0,12),rep(0,4),1,0,0,0)
ML_counts_2005_Phys<- c(ML_2005_Phys_count,0,1,rep(0,12),rep(0,5),1,0,0)
ML_count_2005_Res<-c(ML_2005_Res_count,0,1,rep(0,12),rep(0,6),1,0)
ML_count_2005_Soc<-c(ML_2005_Soc_count,0,1,rep(0,12),rep(0,7),1)

ML_counts_2006_bio<- c(ML_2006_Bio_count,0,0,1,rep(0,11),1,rep(0,7))
ML_counts_2006_Comp<- c(ML_2006_Comp_count,0,0,1,rep(0,11),0,1,rep(0,6))
ML_counts_2006_Earth<-c(ML_2006_Earth_count,0,0,1,rep(0,11),0,0,1,rep(0,5))
ML_counts_2006_Eng<- c(ML_2006_Eng_count,0,0,1,rep(0,11),0,0,0,1,rep(0,4))
ML_counts_2006_Med<- c(ML_2006_Med_count,0,0,1,rep(0,11),rep(0,4),1,0,0,0)
ML_counts_2006_Phys<- c(ML_2006_Phys_count,0,0,1,rep(0,11),rep(0,5),1,0,0)
ML_count_2006_Res<-c(ML_2006_Res_count,0,0,1,rep(0,11),rep(0,6),1,0)
ML_count_2006_Soc<-c(ML_2006_Soc_count,0,0,1,rep(0,11),rep(0,7),1)

ML_counts_2007_bio<- c(ML_2007_Bio_count,0,0,0,1,rep(0,10),1,rep(0,7))
ML_counts_2007_Comp<- c(ML_2007_Comp_count,0,0,0,1,rep(0,10),0,1,rep(0,6))
ML_counts_2007_Earth<-c(ML_2007_Earth_count,0,0,0,1,rep(0,10),0,0,1,rep(0,5))
ML_counts_2007_Eng<- c(ML_2007_Eng_count,0,0,0,1,rep(0,10),0,0,0,1,rep(0,4))
ML_counts_2007_Med<- c(ML_2007_Med_count,0,0,0,1,rep(0,10),rep(0,4),1,0,0,0)
ML_counts_2007_Phys<- c(ML_2007_Phys_count,0,0,0,1,rep(0,10),rep(0,5),1,0,0)
ML_count_2007_Res<-c(ML_2007_Res_count,0,0,0,1,rep(0,10),rep(0,6),1,0)
ML_count_2007_Soc<-c(ML_2007_Soc_count,0,0,0,1,rep(0,10),rep(0,7),1)

ML_counts_2008_bio<- c(ML_2008_Bio_count,rep(0,4),1,rep(0,9),1,rep(0,7))
ML_counts_2008_Comp<- c(ML_2008_Comp_count,rep(0,4),1,rep(0,9),0,1,rep(0,6))
ML_counts_2008_Earth<-c(ML_2008_Earth_count,rep(0,4),1,rep(0,9),0,0,1,rep(0,5))
ML_counts_2008_Eng<- c(ML_2008_Eng_count,rep(0,4),1,rep(0,9),0,0,0,1,rep(0,4))
ML_counts_2008_Med<- c(ML_2008_Med_count,rep(0,4),1,rep(0,9),rep(0,4),1,0,0,0)
ML_counts_2008_Phys<- c(ML_2008_Phys_count,rep(0,4),1,rep(0,9),rep(0,5),1,0,0)
ML_count_2008_Res<-c(ML_2008_Res_count,rep(0,4),1,rep(0,9),rep(0,6),1,0)
ML_count_2008_Soc<-c(ML_2008_Soc_count,rep(0,4),1,rep(0,9),rep(0,7),1)


ML_counts_2009_bio<- c(ML_2009_Bio_count,rep(0,5),1,rep(0,8),1,rep(0,7))
ML_counts_2009_Comp<- c(ML_2009_Comp_count,rep(0,5),1,rep(0,8),0,1,rep(0,6))
ML_counts_2009_Earth<-c(ML_2009_Earth_count,rep(0,5),1,rep(0,8),0,0,1,rep(0,5))
ML_counts_2009_Eng<- c(ML_2009_Eng_count,rep(0,5),1,rep(0,8),0,0,0,1,rep(0,4))
ML_counts_2009_Med<- c(ML_2009_Med_count,rep(0,5),1,rep(0,8),rep(0,4),1,0,0,0)
ML_counts_2009_Phys<- c(ML_2009_Phys_count,rep(0,5),1,rep(0,8),rep(0,5),1,0,0)
ML_count_2009_Res<-c(ML_2009_Res_count,rep(0,5),1,rep(0,8),rep(0,6),1,0)
ML_count_2009_Soc<-c(ML_2009_Soc_count,rep(0,5),1,rep(0,8),rep(0,7),1)

ML_counts_2010_bio<- c(ML_2010_Bio_count,rep(0,6),1,rep(0,7),1,rep(0,7))
ML_counts_2010_Comp<- c(ML_2010_Comp_count,rep(0,6),1,rep(0,7),0,1,rep(0,6))
ML_counts_2010_Earth<-c(ML_2010_Earth_count,rep(0,6),1,rep(0,7),0,0,1,rep(0,5))
ML_counts_2010_Eng<- c(ML_2010_Eng_count,rep(0,6),1,rep(0,7),0,0,0,1,rep(0,4))
ML_counts_2010_Med<- c(ML_2010_Med_count,rep(0,6),1,rep(0,7),rep(0,4),1,0,0,0)
ML_counts_2010_Phys<- c(ML_2010_Phys_count,rep(0,6),1,rep(0,7),rep(0,5),1,0,0)
ML_count_2010_Res<-c(ML_2010_Res_count,rep(0,6),1,rep(0,7),rep(0,6),1,0)
ML_count_2010_Soc<-c(ML_2010_Soc_count,rep(0,6),1,rep(0,7),rep(0,7),1)


ML_counts_2011_bio<- c(ML_2011_Bio_count,rep(0,7),1,rep(0,6),1,rep(0,7))
ML_counts_2011_Comp<- c(ML_2011_Comp_count,rep(0,7),1,rep(0,6),0,1,rep(0,6))
ML_counts_2011_Earth<-c(ML_2011_Earth_count,rep(0,7),1,rep(0,6),0,0,1,rep(0,5))
ML_counts_2011_Eng<- c(ML_2011_Eng_count,rep(0,7),1,rep(0,6),0,0,0,1,rep(0,4))
ML_counts_2011_Med<- c(ML_2011_Med_count,rep(0,7),1,rep(0,6),rep(0,4),1,0,0,0)
ML_counts_2011_Phys<- c(ML_2011_Phys_count,rep(0,7),1,rep(0,6),rep(0,5),1,0,0)
ML_count_2011_Res<-c(ML_2011_Res_count,rep(0,7),1,rep(0,6),rep(0,6),1,0)
ML_count_2011_Soc<-c(ML_2011_Soc_count,rep(0,7),1,rep(0,6),rep(0,7),1)

ML_counts_2012_bio<- c(ML_2012_Bio_count,rep(0,8),1,rep(0,5),1,rep(0,7))
ML_counts_2012_Comp<- c(ML_2012_Comp_count,rep(0,8),1,rep(0,5),0,1,rep(0,6))
ML_counts_2012_Earth<-c(ML_2012_Earth_count,rep(0,8),1,rep(0,5),0,0,1,rep(0,5))
ML_counts_2012_Eng<- c(ML_2012_Eng_count,rep(0,8),1,rep(0,5),0,0,0,1,rep(0,4))
ML_counts_2012_Med<- c(ML_2012_Med_count,rep(0,8),1,rep(0,5),rep(0,4),1,0,0,0)
ML_counts_2012_Phys<- c(ML_2012_Phys_count,rep(0,8),1,rep(0,5),rep(0,5),1,0,0)
ML_count_2012_Res<-c(ML_2012_Res_count,rep(0,8),1,rep(0,5),rep(0,6),1,0)
ML_count_2012_Soc<-c(ML_2012_Soc_count,rep(0,8),1,rep(0,5),rep(0,7),1)

ML_counts_2013_bio<- c(ML_2013_Bio_count,rep(0,9),1,rep(0,4),1,rep(0,7))
ML_counts_2013_Comp<- c(ML_2013_Comp_count,rep(0,9),1,rep(0,4),0,1,rep(0,6))
ML_counts_2013_Earth<-c(ML_2013_Earth_count,rep(0,9),1,rep(0,4),0,0,1,rep(0,5))
ML_counts_2013_Eng<- c(ML_2013_Eng_count,rep(0,9),1,rep(0,4),0,0,0,1,rep(0,4))
ML_counts_2013_Med<- c(ML_2013_Med_count,rep(0,9),1,rep(0,4),rep(0,4),1,0,0,0)
ML_counts_2013_Phys<- c(ML_2013_Phys_count,rep(0,9),1,rep(0,4),rep(0,5),1,0,0)
ML_count_2013_Res<-c(ML_2013_Res_count,rep(0,9),1,rep(0,4),rep(0,6),1,0)
ML_count_2013_Soc<-c(ML_2013_Soc_count,rep(0,9),1,rep(0,4),rep(0,7),1)

ML_counts_2014_bio<- c(ML_2014_Bio_count,rep(0,10),1,rep(0,3),1,rep(0,7))
ML_counts_2014_Comp<- c(ML_2014_Comp_count,rep(0,10),1,rep(0,3),0,1,rep(0,6))
ML_counts_2014_Earth<-c(ML_2014_Earth_count,rep(0,10),1,rep(0,3),0,0,1,rep(0,5))
ML_counts_2014_Eng<- c(ML_2014_Eng_count,rep(0,10),1,rep(0,3),0,0,0,1,rep(0,4))
ML_counts_2014_Med<- c(ML_2014_Med_count,rep(0,10),1,rep(0,3),rep(0,4),1,0,0,0)
ML_counts_2014_Phys<- c(ML_2014_Phys_count,rep(0,10),1,rep(0,3),rep(0,5),1,0,0)
ML_count_2014_Res<-c(ML_2014_Res_count,rep(0,10),1,rep(0,3),rep(0,6),1,0)
ML_count_2014_Soc<-c(ML_2014_Soc_count,rep(0,10),1,rep(0,3),rep(0,7),1)

ML_counts_2015_bio<- c(ML_2015_Bio_count,rep(0,11),1,rep(0,2),1,rep(0,7))
ML_counts_2015_Comp<- c(ML_2015_Comp_count,rep(0,11),1,rep(0,2),0,1,rep(0,6))
ML_counts_2015_Earth<-c(ML_2015_Earth_count,rep(0,11),1,rep(0,2),0,0,1,rep(0,5))
ML_counts_2015_Eng<- c(ML_2015_Eng_count,rep(0,11),1,rep(0,2),0,0,0,1,rep(0,4))
ML_counts_2015_Med<- c(ML_2015_Med_count,rep(0,11),1,rep(0,2),rep(0,4),1,0,0,0)
ML_counts_2015_Phys<- c(ML_2015_Phys_count,rep(0,11),1,rep(0,2),rep(0,5),1,0,0)
ML_count_2015_Res<-c(ML_2015_Res_count,rep(0,11),1,rep(0,2),rep(0,6),1,0)
ML_count_2015_Soc<-c(ML_2015_Soc_count,rep(0,11),1,rep(0,2),rep(0,7),1)

ML_counts_2016_bio<- c(ML_2016_Bio_count,rep(0,12),1,rep(0,1),1,rep(0,7))
ML_counts_2016_Comp<- c(ML_2016_Comp_count,rep(0,12),1,rep(0,1),0,1,rep(0,6))
ML_counts_2016_Earth<-c(ML_2016_Earth_count,rep(0,12),1,rep(0,1),0,0,1,rep(0,5))
ML_counts_2016_Eng<- c(ML_2016_Eng_count,rep(0,12),1,rep(0,1),0,0,0,1,rep(0,4))
ML_counts_2016_Med<- c(ML_2016_Med_count,rep(0,12),1,rep(0,1),rep(0,4),1,0,0,0)
ML_counts_2016_Phys<- c(ML_2016_Phys_count,rep(0,12),1,rep(0,1),rep(0,5),1,0,0)
ML_count_2016_Res<-c(ML_2016_Res_count,rep(0,12),1,rep(0,1),rep(0,6),1,0)
ML_count_2016_Soc<-c(ML_2016_Soc_count,rep(0,12),1,rep(0,1),rep(0,7),1)

ML_counts_2017_bio<- c(ML_2017_Bio_count,rep(0,13),1,1,rep(0,7))
ML_counts_2017_Comp<- c(ML_2017_Comp_count,rep(0,13),1,0,1,rep(0,6))
ML_counts_2017_Earth<-c(ML_2017_Earth_count,rep(0,13),1,0,0,1,rep(0,5))
ML_counts_2017_Eng<- c(ML_2017_Eng_count,rep(0,13),1,0,0,0,1,rep(0,4))
ML_counts_2017_Med<- c(ML_2017_Med_count,rep(0,13),1,rep(0,4),1,0,0,0)
ML_counts_2017_Phys<- c(ML_2017_Phys_count,rep(0,13),1,rep(0,5),1,0,0)
ML_count_2017_Res<-c(ML_2017_Res_count,rep(0,13),1,rep(0,6),1,0)
ML_count_2017_Soc<-c(ML_2017_Soc_count,rep(0,13),1,rep(0,7),1)

ML_table<- rbind(ML_counts_2004_bio,ML_counts_2004_Comp,ML_counts_2004_Earth,
                    ML_counts_2004_Eng,ML_counts_2004_Med,ML_counts_2004_Phys,
                    ML_count_2004_Res,ML_count_2004_Soc,ML_counts_2005_bio,
                    ML_counts_2005_Comp,ML_counts_2005_Earth,ML_counts_2005_Eng,
                    ML_counts_2005_Med,ML_counts_2005_Phys,ML_count_2005_Res,
                    ML_count_2005_Soc,ML_counts_2006_bio,
                    ML_counts_2006_Comp,ML_counts_2006_Earth,ML_counts_2006_Eng,
                    ML_counts_2006_Med,ML_counts_2006_Phys,ML_count_2006_Res,
                    ML_count_2006_Soc,ML_counts_2007_bio,
                    ML_counts_2007_Comp,ML_counts_2007_Earth,ML_counts_2007_Eng,
                    ML_counts_2007_Med,ML_counts_2007_Phys,ML_count_2007_Res,
                    ML_count_2007_Soc, ML_counts_2008_bio,
                    ML_counts_2008_Comp,ML_counts_2008_Earth,ML_counts_2008_Eng,
                    ML_counts_2008_Med,ML_counts_2008_Phys,ML_count_2008_Res,
                    ML_count_2008_Soc, ML_counts_2009_bio,
                    ML_counts_2009_Comp,ML_counts_2009_Earth,ML_counts_2009_Eng,
                    ML_counts_2009_Med,ML_counts_2009_Phys,ML_count_2009_Res,
                    ML_count_2009_Soc,ML_counts_2010_bio,
                    ML_counts_2010_Comp,ML_counts_2010_Earth,ML_counts_2010_Eng,
                    ML_counts_2010_Med,ML_counts_2010_Phys,ML_count_2010_Res,
                    ML_count_2010_Soc,ML_counts_2011_bio,
                    ML_counts_2011_Comp,ML_counts_2011_Earth,ML_counts_2011_Eng,
                    ML_counts_2011_Med,ML_counts_2011_Phys,ML_count_2011_Res,
                    ML_count_2011_Soc,ML_counts_2012_bio,
                    ML_counts_2012_Comp,ML_counts_2012_Earth,ML_counts_2012_Eng,
                    ML_counts_2012_Med,ML_counts_2012_Phys,ML_count_2012_Res,
                    ML_count_2012_Soc, ML_counts_2013_bio,
                    ML_counts_2013_Comp,ML_counts_2013_Earth,ML_counts_2013_Eng,
                    ML_counts_2013_Med,ML_counts_2013_Phys,ML_count_2013_Res,
                    ML_count_2013_Soc, ML_counts_2014_bio,
                    ML_counts_2014_Comp,ML_counts_2014_Earth,ML_counts_2014_Eng,
                    ML_counts_2014_Med,ML_counts_2014_Phys,ML_count_2014_Res,
                    ML_count_2014_Soc,ML_counts_2015_bio,
                    ML_counts_2015_Comp,ML_counts_2015_Earth,ML_counts_2015_Eng,
                    ML_counts_2015_Med,ML_counts_2015_Phys,ML_count_2015_Res,
                    ML_count_2015_Soc,ML_counts_2016_bio,
                    ML_counts_2016_Comp,ML_counts_2016_Earth,ML_counts_2016_Eng,
                    ML_counts_2016_Med,ML_counts_2016_Phys,ML_count_2016_Res,
                    ML_count_2016_Soc, ML_counts_2017_bio,
                    ML_counts_2017_Comp,ML_counts_2017_Earth,ML_counts_2017_Eng,
                    ML_counts_2017_Med,ML_counts_2017_Phys,ML_count_2017_Res,
                    ML_count_2017_Soc)

ML_table[97:112,]
as.data.frame(ML_table)

colnames(ML_table)<- c("ML_counts","2004","2005","2006","2007","2008","2009",
                          "2010","2011","2012","2013","2014","2015","2016","2017",
                          "Biology and life sciences","Computer and information sciences",
                          "Earth sciences","Engineering and tecnhology",
                          "Medicine and health sciences","Physical sciences",
                          "Research and analysis","Social Sciences")

as.numeric(ML_table[,1])

year_covs<- ML_table[,2:15]

terms_covs<- ML_table[,16:23]

################### Machine learning model fit ########################

model_ML<- glm(ML_table[,1]~year_covs*terms_covs, family="poisson")

summary(model_ML)

############### Deep Learning counts assembly #####################
DL_search<- searchplos(q="deep learning",fl=c("subject","publication_date"),limit=10000)

DL_search_clean<- matrix(unlist(DL_search[[2]]),ncol=2)



###DL 2004
DL_2004<- DL_search_clean[grep("^2004",DL_search_clean[,2]),]


DL_2004_Bio<- DL_2004[grep("^/Biology and life sciences",DL_2004[,1]),2]

DL_2004_Bio_count<- length(DL_2004_Bio)

DL_2004_Phys<- DL_2004[grep("^/Physical sciences",DL_2004[,1]),2]

DL_2004_Phys_count<- length(DL_2004_Phys) 

DL_2004_Med<- DL_2004[grep("^/Medicine and health sciences",DL_2004[,1]),2]

DL_2004_Med_count<- length(DL_2004_Med) 

DL_2004_Res<- DL_2004[grep("^/Research and analysis methods",DL_2004[,1]),2]

DL_2004_Res_count<- length(DL_2004_Res) 

DL_2004_Earth<- DL_2004[grep("^/Earth sciences",DL_2004[,1]),2]

DL_2004_Earth_count<- length(DL_2004_Earth) 

DL_2004_Comp<- DL_2004[grep("^/Computer and information sciences",DL_2004[,1]),2]

DL_2004_Comp_count<- length(DL_2004_Comp) 

DL_2004_Eng<- DL_2004[grep("^/Engineering and technology",DL_2004[,1]),2]

DL_2004_Eng_count<- length(DL_2004_Eng) 

DL_2004_Soc<- DL_2004[grep("^/Social sciences",DL_2004[,1]),2]

DL_2004_Soc_count<- length(DL_2004_Soc) 




########DL 2005

DL_2005<- DL_search_clean[grep("^2005",DL_search_clean[,2]),]

DL_2005_Bio<- DL_2005[grep("^/Biology and life sciences",DL_2005[,1]),2]

DL_2005_Bio_count<- length(DL_2005_Bio)

DL_2005_Phys<- DL_2005[grep("^/Physical sciences",DL_2005[,1]),2]

DL_2005_Phys_count<- length(DL_2005_Phys) 

DL_2005_Med<- DL_2005[grep("^/Medicine and health sciences",DL_2005[,1]),2]

DL_2005_Med_count<- length(DL_2005_Med) 

DL_2005_Res<- DL_2005[grep("^/Research and analysis methods",DL_2005[,1]),2]

DL_2005_Res_count<- length(DL_2005_Res) 

DL_2005_Earth<- DL_2005[grep("^/Earth sciences",DL_2005[,1]),2]

DL_2005_Earth_count<- length(DL_2005_Earth) 

DL_2005_Comp<- DL_2005[grep("^/Computer and information sciences",DL_2005[,1]),2]

DL_2005_Comp_count<- length(DL_2005_Comp) 

DL_2005_Eng<- DL_2005[grep("^/Engineering and technology",DL_2005[,1]),2]

DL_2005_Eng_count<- length(DL_2005_Eng) 

DL_2005_Soc<- DL_2005[grep("^/Social sciences",DL_2005[,1]),2]

DL_2005_Soc_count<- length(DL_2005_Soc) 


###### DL 2006


DL_2006<- DL_search_clean[grep("^2006",DL_search_clean[,2]),]


DL_2006_Bio<- DL_2006[grep("^/Biology and life sciences",DL_2006[,1]),2]

DL_2006_Bio_count<- length(DL_2006_Bio)

DL_2006_Phys<- DL_2006[grep("^/Physical sciences",DL_2006[,1]),2]

DL_2006_Phys_count<- length(DL_2006_Phys) 

DL_2006_Med<- DL_2006[grep("^/Medicine and health sciences",DL_2006[,1]),2]

DL_2006_Med_count<- length(DL_2006_Med) 

DL_2006_Res<- DL_2006[grep("^/Research and analysis methods",DL_2006[,1]),2]

DL_2006_Res_count<- length(DL_2006_Res) 

DL_2006_Earth<- DL_2006[grep("^/Earth sciences",DL_2006[,1]),2]

DL_2006_Earth_count<- length(DL_2006_Earth) 

DL_2006_Comp<- DL_2006[grep("^/Computer and information sciences",DL_2006[,1]),2]

DL_2006_Comp_count<- length(DL_2006_Comp) 

DL_2006_Eng<- DL_2006[grep("^/Engineering and technology",DL_2006[,1]),2]

DL_2006_Eng_count<- length(DL_2006_Eng) 

DL_2006_Soc<- DL_2006[grep("^/Social sciences",DL_2006[,1]),2]

DL_2006_Soc_count<- length(DL_2006_Soc) 



## DL 2007


DL_2007<- DL_search_clean[grep("^2007",DL_search_clean[,2]),]


DL_2007_Bio<- DL_2007[grep("^/Biology and life sciences",DL_2007[,1]),2]

DL_2007_Bio_count<- length(DL_2007_Bio)

DL_2007_Phys<- DL_2007[grep("^/Physical sciences",DL_2007[,1]),2]

DL_2007_Phys_count<- length(DL_2007_Phys) 

DL_2007_Med<- DL_2007[grep("^/Medicine and health sciences",DL_2007[,1]),2]

DL_2007_Med_count<- length(DL_2007_Med) 

DL_2007_Res<- DL_2007[grep("^/Research and analysis methods",DL_2007[,1]),2]

DL_2007_Res_count<- length(DL_2007_Res) 

DL_2007_Earth<- DL_2007[grep("^/Earth sciences",DL_2007[,1]),2]

DL_2007_Earth_count<- length(DL_2007_Earth) 

DL_2007_Comp<- DL_2007[grep("^/Computer and information sciences",DL_2007[,1]),2]

DL_2007_Comp_count<- length(DL_2007_Comp) 

DL_2007_Eng<- DL_2007[grep("^/Engineering and technology",DL_2007[,1]),2]

DL_2007_Eng_count<- length(DL_2007_Eng) 

DL_2007_Soc<- DL_2007[grep("^/Social sciences",DL_2007[,1]),2]

DL_2007_Soc_count<- length(DL_2007_Soc) 


#### DL 2008
DL_2008<- DL_search_clean[grep("^2008",DL_search_clean[,2]),]


DL_2008_Bio<- DL_2008[grep("^/Biology and life sciences",DL_2008[,1]),2]

DL_2008_Bio_count<- length(DL_2008_Bio)

DL_2008_Phys<- DL_2008[grep("^/Physical sciences",DL_2008[,1]),2]

DL_2008_Phys_count<- length(DL_2008_Phys) 

DL_2008_Med<- DL_2008[grep("^/Medicine and health sciences",DL_2008[,1]),2]

DL_2008_Med_count<- length(DL_2008_Med) 

DL_2008_Res<- DL_2008[grep("^/Research and analysis methods",DL_2008[,1]),2]

DL_2008_Res_count<- length(DL_2008_Res) 

DL_2008_Earth<- DL_2008[grep("^/Earth sciences",DL_2008[,1]),2]

DL_2008_Earth_count<- length(DL_2008_Earth) 

DL_2008_Comp<- DL_2008[grep("^/Computer and information sciences",DL_2008[,1]),2]

DL_2008_Comp_count<- length(DL_2008_Comp) 

DL_2008_Eng<- DL_2008[grep("^/Engineering and technology",DL_2008[,1]),2]

DL_2008_Eng_count<- length(DL_2008_Eng) 

DL_2008_Soc<- DL_2008[grep("^/Social sciences",DL_2008[,1]),2]

DL_2008_Soc_count<- length(DL_2008_Soc) 


##2009

DL_2009<- DL_search_clean[grep("^2009",DL_search_clean[,2]),]


DL_2009_Bio<- DL_2009[grep("^/Biology and life sciences",DL_2009[,1]),2]

DL_2009_Bio_count<- length(DL_2009_Bio)

DL_2009_Phys<- DL_2009[grep("^/Physical sciences",DL_2009[,1]),2]

DL_2009_Phys_count<- length(DL_2009_Phys) 

DL_2009_Med<- DL_2009[grep("^/Medicine and health sciences",DL_2009[,1]),2]

DL_2009_Med_count<- length(DL_2009_Med) 

DL_2009_Res<- DL_2009[grep("^/Research and analysis methods",DL_2009[,1]),2]

DL_2009_Res_count<- length(DL_2009_Res) 

DL_2009_Earth<- DL_2009[grep("^/Earth sciences",DL_2009[,1]),2]

DL_2009_Earth_count<- length(DL_2009_Earth) 

DL_2009_Comp<- DL_2009[grep("^/Computer and information sciences",DL_2009[,1]),2]

DL_2009_Comp_count<- length(DL_2009_Comp) 

DL_2009_Eng<- DL_2009[grep("^/Engineering and technology",DL_2009[,1]),2]

DL_2009_Eng_count<- length(DL_2009_Eng) 

DL_2009_Soc<- DL_2009[grep("^/Social sciences",DL_2009[,1]),2]

DL_2009_Soc_count<- length(DL_2009_Soc)


### DL 2010

DL_2010<- DL_search_clean[grep("^2010",DL_search_clean[,2]),]


DL_2010_Bio<- DL_2010[grep("^/Biology and life sciences",DL_2010[,1]),2]

DL_2010_Bio_count<- length(DL_2010_Bio)

DL_2010_Phys<- DL_2010[grep("^/Physical sciences",DL_2010[,1]),2]

DL_2010_Phys_count<- length(DL_2010_Phys) 

DL_2010_Med<- DL_2010[grep("^/Medicine and health sciences",DL_2010[,1]),2]

DL_2010_Med_count<- length(DL_2010_Med) 

DL_2010_Res<- DL_2010[grep("^/Research and analysis methods",DL_2010[,1]),2]

DL_2010_Res_count<- length(DL_2010_Res) 

DL_2010_Earth<- DL_2010[grep("^/Earth sciences",DL_2010[,1]),2]

DL_2010_Earth_count<- length(DL_2010_Earth) 

DL_2010_Comp<- DL_2010[grep("^/Computer and information sciences",DL_2010[,1]),2]

DL_2010_Comp_count<- length(DL_2010_Comp) 

DL_2010_Eng<- DL_2010[grep("^/Engineering and technology",DL_2010[,1]),2]

DL_2010_Eng_count<- length(DL_2010_Eng) 

DL_2010_Soc<- DL_2010[grep("^/Social sciences",DL_2010[,1]),2]

DL_2010_Soc_count<- length(DL_2010_Soc)



###2011 DL

DL_2011<- DL_search_clean[grep("^2011",DL_search_clean[,2]),]

DL_2011_Bio<- DL_2011[grep("^/Biology and life sciences",DL_2011[,1]),2]

DL_2011_Bio_count<- length(DL_2011_Bio)

DL_2011_Phys<- DL_2011[grep("^/Physical sciences",DL_2011[,1]),2]

DL_2011_Phys_count<- length(DL_2011_Phys) 

DL_2011_Med<- DL_2011[grep("^/Medicine and health sciences",DL_2011[,1]),2]

DL_2011_Med_count<- length(DL_2011_Med) 

DL_2011_Res<- DL_2011[grep("^/Research and analysis methods",DL_2011[,1]),2]

DL_2011_Res_count<- length(DL_2011_Res) 

DL_2011_Earth<- DL_2011[grep("^/Earth sciences",DL_2011[,1]),2]

DL_2011_Earth_count<- length(DL_2011_Earth) 

DL_2011_Comp<- DL_2011[grep("^/Computer and information sciences",DL_2011[,1]),2]

DL_2011_Comp_count<- length(DL_2011_Comp) 

DL_2011_Eng<- DL_2011[grep("^/Engineering and technology",DL_2011[,1]),2]

DL_2011_Eng_count<- length(DL_2011_Eng) 

DL_2011_Soc<- DL_2011[grep("^/Social sciences",DL_2011[,1]),2]

DL_2011_Soc_count<- length(DL_2011_Soc)



###DL 2012
DL_2012<- DL_search_clean[grep("^2012",DL_search_clean[,2]),]

DL_2012_Bio<- DL_2012[grep("^/Biology and life sciences",DL_2012[,1]),2]

DL_2012_Bio_count<- length(DL_2012_Bio)

DL_2012_Phys<- DL_2012[grep("^/Physical sciences",DL_2012[,1]),2]

DL_2012_Phys_count<- length(DL_2012_Phys) 

DL_2012_Med<- DL_2012[grep("^/Medicine and health sciences",DL_2012[,1]),2]

DL_2012_Med_count<- length(DL_2012_Med) 

DL_2012_Res<- DL_2012[grep("^/Research and analysis methods",DL_2012[,1]),2]

DL_2012_Res_count<- length(DL_2012_Res) 

DL_2012_Earth<- DL_2012[grep("^/Earth sciences",DL_2012[,1]),2]

DL_2012_Earth_count<- length(DL_2012_Earth) 

DL_2012_Comp<- DL_2012[grep("^/Computer and information sciences",DL_2012[,1]),2]

DL_2012_Comp_count<- length(DL_2012_Comp) 

DL_2012_Eng<- DL_2012[grep("^/Engineering and technology",DL_2012[,1]),2]

DL_2012_Eng_count<- length(DL_2012_Eng) 

DL_2012_Soc<- DL_2012[grep("^/Social sciences",DL_2012[,1]),2]

DL_2012_Soc_count<- length(DL_2012_Soc)



##DL 2013

DL_2013<- DL_search_clean[grep("^2013",DL_search_clean[,2]),]

DL_2013_Bio<- DL_2013[grep("^/Biology and life sciences",DL_2013[,1]),2]

DL_2013_Bio_count<- length(DL_2013_Bio)

DL_2013_Phys<- DL_2013[grep("^/Physical sciences",DL_2013[,1]),2]

DL_2013_Phys_count<- length(DL_2013_Phys) 

DL_2013_Med<- DL_2013[grep("^/Medicine and health sciences",DL_2013[,1]),2]

DL_2013_Med_count<- length(DL_2013_Med) 

DL_2013_Res<- DL_2013[grep("^/Research and analysis methods",DL_2013[,1]),2]

DL_2013_Res_count<- length(DL_2013_Res) 

DL_2013_Earth<- DL_2013[grep("^/Earth sciences",DL_2013[,1]),2]

DL_2013_Earth_count<- length(DL_2013_Earth) 

DL_2013_Comp<- DL_2013[grep("^/Computer and information sciences",DL_2013[,1]),2]

DL_2013_Comp_count<- length(DL_2013_Comp) 

DL_2013_Eng<- DL_2013[grep("^/Engineering and technology",DL_2013[,1]),2]

DL_2013_Eng_count<- length(DL_2013_Eng) 

DL_2013_Soc<- DL_2013[grep("^/Social sciences",DL_2013[,1]),2]

DL_2013_Soc_count<- length(DL_2013_Soc)


###DL 2014

DL_2014<- DL_search_clean[grep("^2014",DL_search_clean[,2]),]



DL_2014_Bio<- DL_2014[grep("^/Biology and life sciences",DL_2014[,1]),2]

DL_2014_Bio_count<- length(DL_2014_Bio)

DL_2014_Phys<- DL_2014[grep("^/Physical sciences",DL_2014[,1]),2]

DL_2014_Phys_count<- length(DL_2014_Phys) 

DL_2014_Med<- DL_2014[grep("^/Medicine and health sciences",DL_2014[,1]),2]

DL_2014_Med_count<- length(DL_2014_Med) 

DL_2014_Res<- DL_2014[grep("^/Research and analysis methods",DL_2014[,1]),2]

DL_2014_Res_count<- length(DL_2014_Res) 

DL_2014_Earth<- DL_2014[grep("^/Earth sciences",DL_2014[,1]),2]

DL_2014_Earth_count<- length(DL_2014_Earth) 

DL_2014_Comp<- DL_2014[grep("^/Computer and information sciences",DL_2014[,1]),2]

DL_2014_Comp_count<- length(DL_2014_Comp) 

DL_2014_Eng<- DL_2014[grep("^/Engineering and technology",DL_2014[,1]),2]

DL_2014_Eng_count<- length(DL_2014_Eng) 

DL_2014_Soc<- DL_2014[grep("^/Social sciences",DL_2014[,1]),2]

DL_2014_Soc_count<- length(DL_2014_Soc)



### DL 2015

DL_2015<- DL_search_clean[grep("^2015",DL_search_clean[,2]),]


DL_2015_Bio<- DL_2015[grep("^/Biology and life sciences",DL_2015[,1]),2]

DL_2015_Bio_count<- length(DL_2015_Bio)

DL_2015_Phys<- DL_2015[grep("^/Physical sciences",DL_2015[,1]),2]

DL_2015_Phys_count<- length(DL_2015_Phys) 

DL_2015_Med<- DL_2015[grep("^/Medicine and health sciences",DL_2015[,1]),2]

DL_2015_Med_count<- length(DL_2015_Med) 

DL_2015_Res<- DL_2015[grep("^/Research and analysis methods",DL_2015[,1]),2]

DL_2015_Res_count<- length(DL_2015_Res) 

DL_2015_Earth<- DL_2015[grep("^/Earth sciences",DL_2015[,1]),2]

DL_2015_Earth_count<- length(DL_2015_Earth) 

DL_2015_Comp<- DL_2015[grep("^/Computer and information sciences",DL_2015[,1]),2]

DL_2015_Comp_count<- length(DL_2015_Comp) 

DL_2015_Eng<- DL_2015[grep("^/Engineering and technology",DL_2015[,1]),2]

DL_2015_Eng_count<- length(DL_2015_Eng) 

DL_2015_Soc<- DL_2015[grep("^/Social sciences",DL_2015[,1]),2]

DL_2015_Soc_count<- length(DL_2015_Soc)




##DL 2016

DL_2016<- DL_search_clean[grep("^2016",DL_search_clean[,2]),]


DL_2016_Bio<- DL_2016[grep("^/Biology and life sciences",DL_2016[,1]),2]

DL_2016_Bio_count<- length(DL_2016_Bio)

DL_2016_Phys<- DL_2016[grep("^/Physical sciences",DL_2016[,1]),2]

DL_2016_Phys_count<- length(DL_2016_Phys) 

DL_2016_Med<- DL_2016[grep("^/Medicine and health sciences",DL_2016[,1]),2]

DL_2016_Med_count<- length(DL_2016_Med) 

DL_2016_Res<- DL_2016[grep("^/Research and analysis methods",DL_2016[,1]),2]

DL_2016_Res_count<- length(DL_2016_Res) 

DL_2016_Earth<- DL_2016[grep("^/Earth sciences",DL_2016[,1]),2]

DL_2016_Earth_count<- length(DL_2016_Earth) 

DL_2016_Comp<- DL_2016[grep("^/Computer and information sciences",DL_2016[,1]),2]

DL_2016_Comp_count<- length(DL_2016_Comp) 

DL_2016_Eng<- DL_2016[grep("^/Engineering and technology",DL_2016[,1]),2]

DL_2016_Eng_count<- length(DL_2016_Eng) 

DL_2016_Soc<- DL_2016[grep("^/Social sciences",DL_2016[,1]),2]

DL_2016_Soc_count<- length(DL_2016_Soc)



## DL 2017

DL_2017<- DL_search_clean[grep("^2017",DL_search_clean[,2]),]


DL_2017_Bio<- DL_2017[grep("^/Biology and life sciences",DL_2017[,1]),2]

DL_2017_Bio_count<- length(DL_2017_Bio)

DL_2017_Phys<- DL_2017[grep("^/Physical sciences",DL_2017[,1]),2]

DL_2017_Phys_count<- length(DL_2017_Phys) 

DL_2017_Med<- DL_2017[grep("^/Medicine and health sciences",DL_2017[,1]),2]

DL_2017_Med_count<- length(DL_2017_Med) 

DL_2017_Res<- DL_2017[grep("^/Research and analysis methods",DL_2017[,1]),2]

DL_2017_Res_count<- length(DL_2017_Res) 

DL_2017_Earth<- DL_2017[grep("^/Earth sciences",DL_2017[,1]),2]

DL_2017_Earth_count<- length(DL_2017_Earth) 

DL_2017_Comp<- DL_2017[grep("^/Computer and information sciences",DL_2017[,1]),2]

DL_2017_Comp_count<- length(DL_2017_Comp) 

DL_2017_Eng<- DL_2017[grep("^/Engineering and technology",DL_2017[,1]),2]

DL_2017_Eng_count<- length(DL_2017_Eng) 

DL_2017_Soc<- DL_2017[grep("^/Social sciences",DL_2017[,1]),2]

DL_2017_Soc_count<- length(DL_2017_Soc)

########## DL counts table

DL_counts_2004_bio<- c(DL_2004_Bio_count,1,rep(0,13),1,rep(0,7))
DL_counts_2004_Comp<- c(DL_2004_Comp_count,1,rep(0,13),0,1,rep(0,6))
DL_counts_2004_Earth<-c(DL_2004_Earth_count,1,rep(0,13),0,0,1,rep(0,5))
DL_counts_2004_Eng<- c(DL_2004_Eng_count,1,rep(0,13),0,0,0,1,rep(0,4))
DL_counts_2004_Med<- c(DL_2004_Med_count,1,rep(0,13),rep(0,4),1,0,0,0)
DL_counts_2004_Phys<- c(DL_2004_Phys_count,1,rep(0,13),rep(0,5),1,0,0)
DL_count_2004_Res<-c(DL_2004_Res_count,1,rep(0,13),rep(0,6),1,0)
DL_count_2004_Soc<-c(DL_2004_Soc_count,1,rep(0,13),rep(0,7),1)

DL_counts_2005_bio<- c(DL_2005_Bio_count,0,1,rep(0,12),1,rep(0,7))
DL_counts_2005_Comp<- c(DL_2005_Comp_count,0,1,rep(0,12),0,1,rep(0,6))
DL_counts_2005_Earth<-c(DL_2005_Earth_count,0,1,rep(0,12),0,0,1,rep(0,5))
DL_counts_2005_Eng<- c(DL_2005_Eng_count,0,1,rep(0,12),0,0,0,1,rep(0,4))
DL_counts_2005_Med<- c(DL_2005_Med_count,0,1,rep(0,12),rep(0,4),1,0,0,0)
DL_counts_2005_Phys<- c(DL_2005_Phys_count,0,1,rep(0,12),rep(0,5),1,0,0)
DL_count_2005_Res<-c(DL_2005_Res_count,0,1,rep(0,12),rep(0,6),1,0)
DL_count_2005_Soc<-c(DL_2005_Soc_count,0,1,rep(0,12),rep(0,7),1)

DL_counts_2006_bio<- c(DL_2006_Bio_count,0,0,1,rep(0,11),1,rep(0,7))
DL_counts_2006_Comp<- c(DL_2006_Comp_count,0,0,1,rep(0,11),0,1,rep(0,6))
DL_counts_2006_Earth<-c(DL_2006_Earth_count,0,0,1,rep(0,11),0,0,1,rep(0,5))
DL_counts_2006_Eng<- c(DL_2006_Eng_count,0,0,1,rep(0,11),0,0,0,1,rep(0,4))
DL_counts_2006_Med<- c(DL_2006_Med_count,0,0,1,rep(0,11),rep(0,4),1,0,0,0)
DL_counts_2006_Phys<- c(DL_2006_Phys_count,0,0,1,rep(0,11),rep(0,5),1,0,0)
DL_count_2006_Res<-c(DL_2006_Res_count,0,0,1,rep(0,11),rep(0,6),1,0)
DL_count_2006_Soc<-c(DL_2006_Soc_count,0,0,1,rep(0,11),rep(0,7),1)

DL_counts_2007_bio<- c(DL_2007_Bio_count,0,0,0,1,rep(0,10),1,rep(0,7))
DL_counts_2007_Comp<- c(DL_2007_Comp_count,0,0,0,1,rep(0,10),0,1,rep(0,6))
DL_counts_2007_Earth<-c(DL_2007_Earth_count,0,0,0,1,rep(0,10),0,0,1,rep(0,5))
DL_counts_2007_Eng<- c(DL_2007_Eng_count,0,0,0,1,rep(0,10),0,0,0,1,rep(0,4))
DL_counts_2007_Med<- c(DL_2007_Med_count,0,0,0,1,rep(0,10),rep(0,4),1,0,0,0)
DL_counts_2007_Phys<- c(DL_2007_Phys_count,0,0,0,1,rep(0,10),rep(0,5),1,0,0)
DL_count_2007_Res<-c(DL_2007_Res_count,0,0,0,1,rep(0,10),rep(0,6),1,0)
DL_count_2007_Soc<-c(DL_2007_Soc_count,0,0,0,1,rep(0,10),rep(0,7),1)

DL_counts_2008_bio<- c(DL_2008_Bio_count,rep(0,4),1,rep(0,9),1,rep(0,7))
DL_counts_2008_Comp<- c(DL_2008_Comp_count,rep(0,4),1,rep(0,9),0,1,rep(0,6))
DL_counts_2008_Earth<-c(DL_2008_Earth_count,rep(0,4),1,rep(0,9),0,0,1,rep(0,5))
DL_counts_2008_Eng<- c(DL_2008_Eng_count,rep(0,4),1,rep(0,9),0,0,0,1,rep(0,4))
DL_counts_2008_Med<- c(DL_2008_Med_count,rep(0,4),1,rep(0,9),rep(0,4),1,0,0,0)
DL_counts_2008_Phys<- c(DL_2008_Phys_count,rep(0,4),1,rep(0,9),rep(0,5),1,0,0)
DL_count_2008_Res<-c(DL_2008_Res_count,rep(0,4),1,rep(0,9),rep(0,6),1,0)
DL_count_2008_Soc<-c(DL_2008_Soc_count,rep(0,4),1,rep(0,9),rep(0,7),1)


DL_counts_2009_bio<- c(DL_2009_Bio_count,rep(0,5),1,rep(0,8),1,rep(0,7))
DL_counts_2009_Comp<- c(DL_2009_Comp_count,rep(0,5),1,rep(0,8),0,1,rep(0,6))
DL_counts_2009_Earth<-c(DL_2009_Earth_count,rep(0,5),1,rep(0,8),0,0,1,rep(0,5))
DL_counts_2009_Eng<- c(DL_2009_Eng_count,rep(0,5),1,rep(0,8),0,0,0,1,rep(0,4))
DL_counts_2009_Med<- c(DL_2009_Med_count,rep(0,5),1,rep(0,8),rep(0,4),1,0,0,0)
DL_counts_2009_Phys<- c(DL_2009_Phys_count,rep(0,5),1,rep(0,8),rep(0,5),1,0,0)
DL_count_2009_Res<-c(DL_2009_Res_count,rep(0,5),1,rep(0,8),rep(0,6),1,0)
DL_count_2009_Soc<-c(DL_2009_Soc_count,rep(0,5),1,rep(0,8),rep(0,7),1)

DL_counts_2010_bio<- c(DL_2010_Bio_count,rep(0,6),1,rep(0,7),1,rep(0,7))
DL_counts_2010_Comp<- c(DL_2010_Comp_count,rep(0,6),1,rep(0,7),0,1,rep(0,6))
DL_counts_2010_Earth<-c(DL_2010_Earth_count,rep(0,6),1,rep(0,7),0,0,1,rep(0,5))
DL_counts_2010_Eng<- c(DL_2010_Eng_count,rep(0,6),1,rep(0,7),0,0,0,1,rep(0,4))
DL_counts_2010_Med<- c(DL_2010_Med_count,rep(0,6),1,rep(0,7),rep(0,4),1,0,0,0)
DL_counts_2010_Phys<- c(DL_2010_Phys_count,rep(0,6),1,rep(0,7),rep(0,5),1,0,0)
DL_count_2010_Res<-c(DL_2010_Res_count,rep(0,6),1,rep(0,7),rep(0,6),1,0)
DL_count_2010_Soc<-c(DL_2010_Soc_count,rep(0,6),1,rep(0,7),rep(0,7),1)


DL_counts_2011_bio<- c(DL_2011_Bio_count,rep(0,7),1,rep(0,6),1,rep(0,7))
DL_counts_2011_Comp<- c(DL_2011_Comp_count,rep(0,7),1,rep(0,6),0,1,rep(0,6))
DL_counts_2011_Earth<-c(DL_2011_Earth_count,rep(0,7),1,rep(0,6),0,0,1,rep(0,5))
DL_counts_2011_Eng<- c(DL_2011_Eng_count,rep(0,7),1,rep(0,6),0,0,0,1,rep(0,4))
DL_counts_2011_Med<- c(DL_2011_Med_count,rep(0,7),1,rep(0,6),rep(0,4),1,0,0,0)
DL_counts_2011_Phys<- c(DL_2011_Phys_count,rep(0,7),1,rep(0,6),rep(0,5),1,0,0)
DL_count_2011_Res<-c(DL_2011_Res_count,rep(0,7),1,rep(0,6),rep(0,6),1,0)
DL_count_2011_Soc<-c(DL_2011_Soc_count,rep(0,7),1,rep(0,6),rep(0,7),1)

DL_counts_2012_bio<- c(DL_2012_Bio_count,rep(0,8),1,rep(0,5),1,rep(0,7))
DL_counts_2012_Comp<- c(DL_2012_Comp_count,rep(0,8),1,rep(0,5),0,1,rep(0,6))
DL_counts_2012_Earth<-c(DL_2012_Earth_count,rep(0,8),1,rep(0,5),0,0,1,rep(0,5))
DL_counts_2012_Eng<- c(DL_2012_Eng_count,rep(0,8),1,rep(0,5),0,0,0,1,rep(0,4))
DL_counts_2012_Med<- c(DL_2012_Med_count,rep(0,8),1,rep(0,5),rep(0,4),1,0,0,0)
DL_counts_2012_Phys<- c(DL_2012_Phys_count,rep(0,8),1,rep(0,5),rep(0,5),1,0,0)
DL_count_2012_Res<-c(DL_2012_Res_count,rep(0,8),1,rep(0,5),rep(0,6),1,0)
DL_count_2012_Soc<-c(DL_2012_Soc_count,rep(0,8),1,rep(0,5),rep(0,7),1)

DL_counts_2013_bio<- c(DL_2013_Bio_count,rep(0,9),1,rep(0,4),1,rep(0,7))
DL_counts_2013_Comp<- c(DL_2013_Comp_count,rep(0,9),1,rep(0,4),0,1,rep(0,6))
DL_counts_2013_Earth<-c(DL_2013_Earth_count,rep(0,9),1,rep(0,4),0,0,1,rep(0,5))
DL_counts_2013_Eng<- c(DL_2013_Eng_count,rep(0,9),1,rep(0,4),0,0,0,1,rep(0,4))
DL_counts_2013_Med<- c(DL_2013_Med_count,rep(0,9),1,rep(0,4),rep(0,4),1,0,0,0)
DL_counts_2013_Phys<- c(DL_2013_Phys_count,rep(0,9),1,rep(0,4),rep(0,5),1,0,0)
DL_count_2013_Res<-c(DL_2013_Res_count,rep(0,9),1,rep(0,4),rep(0,6),1,0)
DL_count_2013_Soc<-c(DL_2013_Soc_count,rep(0,9),1,rep(0,4),rep(0,7),1)

DL_counts_2014_bio<- c(DL_2014_Bio_count,rep(0,10),1,rep(0,3),1,rep(0,7))
DL_counts_2014_Comp<- c(DL_2014_Comp_count,rep(0,10),1,rep(0,3),0,1,rep(0,6))
DL_counts_2014_Earth<-c(DL_2014_Earth_count,rep(0,10),1,rep(0,3),0,0,1,rep(0,5))
DL_counts_2014_Eng<- c(DL_2014_Eng_count,rep(0,10),1,rep(0,3),0,0,0,1,rep(0,4))
DL_counts_2014_Med<- c(DL_2014_Med_count,rep(0,10),1,rep(0,3),rep(0,4),1,0,0,0)
DL_counts_2014_Phys<- c(DL_2014_Phys_count,rep(0,10),1,rep(0,3),rep(0,5),1,0,0)
DL_count_2014_Res<-c(DL_2014_Res_count,rep(0,10),1,rep(0,3),rep(0,6),1,0)
DL_count_2014_Soc<-c(DL_2014_Soc_count,rep(0,10),1,rep(0,3),rep(0,7),1)

DL_counts_2015_bio<- c(DL_2015_Bio_count,rep(0,11),1,rep(0,2),1,rep(0,7))
DL_counts_2015_Comp<- c(DL_2015_Comp_count,rep(0,11),1,rep(0,2),0,1,rep(0,6))
DL_counts_2015_Earth<-c(DL_2015_Earth_count,rep(0,11),1,rep(0,2),0,0,1,rep(0,5))
DL_counts_2015_Eng<- c(DL_2015_Eng_count,rep(0,11),1,rep(0,2),0,0,0,1,rep(0,4))
DL_counts_2015_Med<- c(DL_2015_Med_count,rep(0,11),1,rep(0,2),rep(0,4),1,0,0,0)
DL_counts_2015_Phys<- c(DL_2015_Phys_count,rep(0,11),1,rep(0,2),rep(0,5),1,0,0)
DL_count_2015_Res<-c(DL_2015_Res_count,rep(0,11),1,rep(0,2),rep(0,6),1,0)
DL_count_2015_Soc<-c(DL_2015_Soc_count,rep(0,11),1,rep(0,2),rep(0,7),1)

DL_counts_2016_bio<- c(DL_2016_Bio_count,rep(0,12),1,rep(0,1),1,rep(0,7))
DL_counts_2016_Comp<- c(DL_2016_Comp_count,rep(0,12),1,rep(0,1),0,1,rep(0,6))
DL_counts_2016_Earth<-c(DL_2016_Earth_count,rep(0,12),1,rep(0,1),0,0,1,rep(0,5))
DL_counts_2016_Eng<- c(DL_2016_Eng_count,rep(0,12),1,rep(0,1),0,0,0,1,rep(0,4))
DL_counts_2016_Med<- c(DL_2016_Med_count,rep(0,12),1,rep(0,1),rep(0,4),1,0,0,0)
DL_counts_2016_Phys<- c(DL_2016_Phys_count,rep(0,12),1,rep(0,1),rep(0,5),1,0,0)
DL_count_2016_Res<-c(DL_2016_Res_count,rep(0,12),1,rep(0,1),rep(0,6),1,0)
DL_count_2016_Soc<-c(DL_2016_Soc_count,rep(0,12),1,rep(0,1),rep(0,7),1)

DL_counts_2017_bio<- c(DL_2017_Bio_count,rep(0,13),1,1,rep(0,7))
DL_counts_2017_Comp<- c(DL_2017_Comp_count,rep(0,13),1,0,1,rep(0,6))
DL_counts_2017_Earth<-c(DL_2017_Earth_count,rep(0,13),1,0,0,1,rep(0,5))
DL_counts_2017_Eng<- c(DL_2017_Eng_count,rep(0,13),1,0,0,0,1,rep(0,4))
DL_counts_2017_Med<- c(DL_2017_Med_count,rep(0,13),1,rep(0,4),1,0,0,0)
DL_counts_2017_Phys<- c(DL_2017_Phys_count,rep(0,13),1,rep(0,5),1,0,0)
DL_count_2017_Res<-c(DL_2017_Res_count,rep(0,13),1,rep(0,6),1,0)
DL_count_2017_Soc<-c(DL_2017_Soc_count,rep(0,13),1,rep(0,7),1)

DL_table<- rbind(DL_counts_2004_bio,DL_counts_2004_Comp,DL_counts_2004_Earth,
                    DL_counts_2004_Eng,DL_counts_2004_Med,DL_counts_2004_Phys,
                    DL_count_2004_Res,DL_count_2004_Soc,DL_counts_2005_bio,
                    DL_counts_2005_Comp,DL_counts_2005_Earth,DL_counts_2005_Eng,
                    DL_counts_2005_Med,DL_counts_2005_Phys,DL_count_2005_Res,
                    DL_count_2005_Soc,DL_counts_2006_bio,
                    DL_counts_2006_Comp,DL_counts_2006_Earth,DL_counts_2006_Eng,
                    DL_counts_2006_Med,DL_counts_2006_Phys,DL_count_2006_Res,
                    DL_count_2006_Soc,DL_counts_2007_bio,
                    DL_counts_2007_Comp,DL_counts_2007_Earth,DL_counts_2007_Eng,
                    DL_counts_2007_Med,DL_counts_2007_Phys,DL_count_2007_Res,
                    DL_count_2007_Soc, DL_counts_2008_bio,
                    DL_counts_2008_Comp,DL_counts_2008_Earth,DL_counts_2008_Eng,
                    DL_counts_2008_Med,DL_counts_2008_Phys,DL_count_2008_Res,
                    DL_count_2008_Soc, DL_counts_2009_bio,
                    DL_counts_2009_Comp,DL_counts_2009_Earth,DL_counts_2009_Eng,
                    DL_counts_2009_Med,DL_counts_2009_Phys,DL_count_2009_Res,
                    DL_count_2009_Soc,DL_counts_2010_bio,
                    DL_counts_2010_Comp,DL_counts_2010_Earth,DL_counts_2010_Eng,
                    DL_counts_2010_Med,DL_counts_2010_Phys,DL_count_2010_Res,
                    DL_count_2010_Soc,DL_counts_2011_bio,
                    DL_counts_2011_Comp,DL_counts_2011_Earth,DL_counts_2011_Eng,
                    DL_counts_2011_Med,DL_counts_2011_Phys,DL_count_2011_Res,
                    DL_count_2011_Soc,DL_counts_2012_bio,
                    DL_counts_2012_Comp,DL_counts_2012_Earth,DL_counts_2012_Eng,
                    DL_counts_2012_Med,DL_counts_2012_Phys,DL_count_2012_Res,
                    DL_count_2012_Soc, DL_counts_2013_bio,
                    DL_counts_2013_Comp,DL_counts_2013_Earth,DL_counts_2013_Eng,
                    DL_counts_2013_Med,DL_counts_2013_Phys,DL_count_2013_Res,
                    DL_count_2013_Soc, DL_counts_2014_bio,
                    DL_counts_2014_Comp,DL_counts_2014_Earth,DL_counts_2014_Eng,
                    DL_counts_2014_Med,DL_counts_2014_Phys,DL_count_2014_Res,
                    DL_count_2014_Soc,DL_counts_2015_bio,
                    DL_counts_2015_Comp,DL_counts_2015_Earth,DL_counts_2015_Eng,
                    DL_counts_2015_Med,DL_counts_2015_Phys,DL_count_2015_Res,
                    DL_count_2015_Soc,DL_counts_2016_bio,
                    DL_counts_2016_Comp,DL_counts_2016_Earth,DL_counts_2016_Eng,
                    DL_counts_2016_Med,DL_counts_2016_Phys,DL_count_2016_Res,
                    DL_count_2016_Soc, DL_counts_2017_bio,
                    DL_counts_2017_Comp,DL_counts_2017_Earth,DL_counts_2017_Eng,
                    DL_counts_2017_Med,DL_counts_2017_Phys,DL_count_2017_Res,
                    DL_count_2017_Soc)

DL_table[97:112,]
as.data.frame(DL_table)

colnames(DL_table)<- c("DL_counts","2004","2005","2006","2007","2008","2009",
                          "2010","2011","2012","2013","2014","2015","2016","2017",
                          "Biology and life sciences","Computer and information sciences",
                          "Earth sciences","Engineering and tecnhology",
                          "Medicine and health sciences","Physical sciences",
                          "Research and analysis","Social Sciences")

as.numeric(DL_table[,1])

year_covs<- DL_table[,2:15]

terms_covs<- DL_table[,16:23]

#################### Deep Learning Model Fit #####################
model_DL<- glm(DL_table[,1]~year_covs*terms_covs, family="poisson")

summary(model_DL)

###################### Neural Networks  Counts Assembly #############
NN_search<- searchplos(q="artificial neural networks",fl=c("subject","publication_date"),limit=10000)

NN_search_clean<- matrix(unlist(NN_search[[2]]),ncol=2)



###NN 2004
NN_2004<- NN_search_clean[grep("^2004",NN_search_clean[,2]),]


NN_2004_Bio<- NN_2004[grep("^/Biology and life sciences",NN_2004[,1]),2]

NN_2004_Bio_count<- length(NN_2004_Bio)

NN_2004_Phys<- NN_2004[grep("^/Physical sciences",NN_2004[,1]),2]

NN_2004_Phys_count<- length(NN_2004_Phys) 

NN_2004_Med<- NN_2004[grep("^/Medicine and health sciences",NN_2004[,1]),2]

NN_2004_Med_count<- length(NN_2004_Med) 

NN_2004_Res<- NN_2004[grep("^/Research and analysis methods",NN_2004[,1]),2]

NN_2004_Res_count<- length(NN_2004_Res) 

NN_2004_Earth<- NN_2004[grep("^/Earth sciences",NN_2004[,1]),2]

NN_2004_Earth_count<- length(NN_2004_Earth) 

NN_2004_Comp<- NN_2004[grep("^/Computer and information sciences",NN_2004[,1]),2]

NN_2004_Comp_count<- length(NN_2004_Comp) 

NN_2004_Eng<- NN_2004[grep("^/Engineering and technology",NN_2004[,1]),2]

NN_2004_Eng_count<- length(NN_2004_Eng) 

NN_2004_Soc<- NN_2004[grep("^/Social sciences",NN_2004[,1]),2]

NN_2004_Soc_count<- length(NN_2004_Soc) 




########NN 2005

NN_2005<- NN_search_clean[grep("^2005",NN_search_clean[,2]),]

NN_2005_Bio<- NN_2005[grep("^/Biology and life sciences",NN_2005[,1]),2]

NN_2005_Bio_count<- length(NN_2005_Bio)

NN_2005_Phys<- NN_2005[grep("^/Physical sciences",NN_2005[,1]),2]

NN_2005_Phys_count<- length(NN_2005_Phys) 

NN_2005_Med<- NN_2005[grep("^/Medicine and health sciences",NN_2005[,1]),2]

NN_2005_Med_count<- length(NN_2005_Med) 

NN_2005_Res<- NN_2005[grep("^/Research and analysis methods",NN_2005[,1]),2]

NN_2005_Res_count<- length(NN_2005_Res) 

NN_2005_Earth<- NN_2005[grep("^/Earth sciences",NN_2005[,1]),2]

NN_2005_Earth_count<- length(NN_2005_Earth) 

NN_2005_Comp<- NN_2005[grep("^/Computer and information sciences",NN_2005[,1]),2]

NN_2005_Comp_count<- length(NN_2005_Comp) 

NN_2005_Eng<- NN_2005[grep("^/Engineering and technology",NN_2005[,1]),2]

NN_2005_Eng_count<- length(NN_2005_Eng) 

NN_2005_Soc<- NN_2005[grep("^/Social sciences",NN_2005[,1]),2]

NN_2005_Soc_count<- length(NN_2005_Soc) 



###### NN 2006


NN_2006<- NN_search_clean[grep("^2006",NN_search_clean[,2]),]


NN_2006_Bio<- NN_2006[grep("^/Biology and life sciences",NN_2006[,1]),2]

NN_2006_Bio_count<- length(NN_2006_Bio)

NN_2006_Phys<- NN_2006[grep("^/Physical sciences",NN_2006[,1]),2]

NN_2006_Phys_count<- length(NN_2006_Phys) 

NN_2006_Med<- NN_2006[grep("^/Medicine and health sciences",NN_2006[,1]),2]

NN_2006_Med_count<- length(NN_2006_Med) 

NN_2006_Res<- NN_2006[grep("^/Research and analysis methods",NN_2006[,1]),2]

NN_2006_Res_count<- length(NN_2006_Res) 

NN_2006_Earth<- NN_2006[grep("^/Earth sciences",NN_2006[,1]),2]

NN_2006_Earth_count<- length(NN_2006_Earth) 

NN_2006_Comp<- NN_2006[grep("^/Computer and information sciences",NN_2006[,1]),2]

NN_2006_Comp_count<- length(NN_2006_Comp) 

NN_2006_Eng<- NN_2006[grep("^/Engineering and technology",NN_2006[,1]),2]

NN_2006_Eng_count<- length(NN_2006_Eng) 

NN_2006_Soc<- NN_2006[grep("^/Social sciences",NN_2006[,1]),2]

NN_2006_Soc_count<- length(NN_2006_Soc) 



## NN 2007


NN_2007<- NN_search_clean[grep("^2007",NN_search_clean[,2]),]


NN_2007_Bio<- NN_2007[grep("^/Biology and life sciences",NN_2007[,1]),2]

NN_2007_Bio_count<- length(NN_2007_Bio)

NN_2007_Phys<- NN_2007[grep("^/Physical sciences",NN_2007[,1]),2]

NN_2007_Phys_count<- length(NN_2007_Phys) 

NN_2007_Med<- NN_2007[grep("^/Medicine and health sciences",NN_2007[,1]),2]

NN_2007_Med_count<- length(NN_2007_Med) 

NN_2007_Res<- NN_2007[grep("^/Research and analysis methods",NN_2007[,1]),2]

NN_2007_Res_count<- length(NN_2007_Res) 

NN_2007_Earth<- NN_2007[grep("^/Earth sciences",NN_2007[,1]),2]

NN_2007_Earth_count<- length(NN_2007_Earth) 

NN_2007_Comp<- NN_2007[grep("^/Computer and information sciences",NN_2007[,1]),2]

NN_2007_Comp_count<- length(NN_2007_Comp) 

NN_2007_Eng<- NN_2007[grep("^/Engineering and technology",NN_2007[,1]),2]

NN_2007_Eng_count<- length(NN_2007_Eng) 

NN_2007_Soc<- NN_2007[grep("^/Social sciences",NN_2007[,1]),2]

NN_2007_Soc_count<- length(NN_2007_Soc) 


#### NN 2008
NN_2008<- NN_search_clean[grep("^2008",NN_search_clean[,2]),]


NN_2008_Bio<- NN_2008[grep("^/Biology and life sciences",NN_2008[,1]),2]

NN_2008_Bio_count<- length(NN_2008_Bio)

NN_2008_Phys<- NN_2008[grep("^/Physical sciences",NN_2008[,1]),2]

NN_2008_Phys_count<- length(NN_2008_Phys) 

NN_2008_Med<- NN_2008[grep("^/Medicine and health sciences",NN_2008[,1]),2]

NN_2008_Med_count<- length(NN_2008_Med) 

NN_2008_Res<- NN_2008[grep("^/Research and analysis methods",NN_2008[,1]),2]

NN_2008_Res_count<- length(NN_2008_Res) 

NN_2008_Earth<- NN_2008[grep("^/Earth sciences",NN_2008[,1]),2]

NN_2008_Earth_count<- length(NN_2008_Earth) 

NN_2008_Comp<- NN_2008[grep("^/Computer and information sciences",NN_2008[,1]),2]

NN_2008_Comp_count<- length(NN_2008_Comp) 

NN_2008_Eng<- NN_2008[grep("^/Engineering and technology",NN_2008[,1]),2]

NN_2008_Eng_count<- length(NN_2008_Eng) 

NN_2008_Soc<- NN_2008[grep("^/Social sciences",NN_2008[,1]),2]

NN_2008_Soc_count<- length(NN_2008_Soc) 


##2009

NN_2009<- NN_search_clean[grep("^2009",NN_search_clean[,2]),]


NN_2009_Bio<- NN_2009[grep("^/Biology and life sciences",NN_2009[,1]),2]

NN_2009_Bio_count<- length(NN_2009_Bio)

NN_2009_Phys<- NN_2009[grep("^/Physical sciences",NN_2009[,1]),2]

NN_2009_Phys_count<- length(NN_2009_Phys) 

NN_2009_Med<- NN_2009[grep("^/Medicine and health sciences",NN_2009[,1]),2]

NN_2009_Med_count<- length(NN_2009_Med) 

NN_2009_Res<- NN_2009[grep("^/Research and analysis methods",NN_2009[,1]),2]

NN_2009_Res_count<- length(NN_2009_Res) 

NN_2009_Earth<- NN_2009[grep("^/Earth sciences",NN_2009[,1]),2]

NN_2009_Earth_count<- length(NN_2009_Earth) 

NN_2009_Comp<- NN_2009[grep("^/Computer and information sciences",NN_2009[,1]),2]

NN_2009_Comp_count<- length(NN_2009_Comp) 

NN_2009_Eng<- NN_2009[grep("^/Engineering and technology",NN_2009[,1]),2]

NN_2009_Eng_count<- length(NN_2009_Eng) 

NN_2009_Soc<- NN_2009[grep("^/Social sciences",NN_2009[,1]),2]

NN_2009_Soc_count<- length(NN_2009_Soc)


### NN 2010

NN_2010<- NN_search_clean[grep("^2010",NN_search_clean[,2]),]


NN_2010_Bio<- NN_2010[grep("^/Biology and life sciences",NN_2010[,1]),2]

NN_2010_Bio_count<- length(NN_2010_Bio)

NN_2010_Phys<- NN_2010[grep("^/Physical sciences",NN_2010[,1]),2]

NN_2010_Phys_count<- length(NN_2010_Phys) 

NN_2010_Med<- NN_2010[grep("^/Medicine and health sciences",NN_2010[,1]),2]

NN_2010_Med_count<- length(NN_2010_Med) 

NN_2010_Res<- NN_2010[grep("^/Research and analysis methods",NN_2010[,1]),2]

NN_2010_Res_count<- length(NN_2010_Res) 

NN_2010_Earth<- NN_2010[grep("^/Earth sciences",NN_2010[,1]),2]

NN_2010_Earth_count<- length(NN_2010_Earth) 

NN_2010_Comp<- NN_2010[grep("^/Computer and information sciences",NN_2010[,1]),2]

NN_2010_Comp_count<- length(NN_2010_Comp) 

NN_2010_Eng<- NN_2010[grep("^/Engineering and technology",NN_2010[,1]),2]

NN_2010_Eng_count<- length(NN_2010_Eng) 

NN_2010_Soc<- NN_2010[grep("^/Social sciences",NN_2010[,1]),2]

NN_2010_Soc_count<- length(NN_2010_Soc)



###2011 NN

NN_2011<- NN_search_clean[grep("^2011",NN_search_clean[,2]),]

NN_2011_Bio<- NN_2011[grep("^/Biology and life sciences",NN_2011[,1]),2]

NN_2011_Bio_count<- length(NN_2011_Bio)

NN_2011_Phys<- NN_2011[grep("^/Physical sciences",NN_2011[,1]),2]

NN_2011_Phys_count<- length(NN_2011_Phys) 

NN_2011_Med<- NN_2011[grep("^/Medicine and health sciences",NN_2011[,1]),2]

NN_2011_Med_count<- length(NN_2011_Med) 

NN_2011_Res<- NN_2011[grep("^/Research and analysis methods",NN_2011[,1]),2]

NN_2011_Res_count<- length(NN_2011_Res) 

NN_2011_Earth<- NN_2011[grep("^/Earth sciences",NN_2011[,1]),2]

NN_2011_Earth_count<- length(NN_2011_Earth) 

NN_2011_Comp<- NN_2011[grep("^/Computer and information sciences",NN_2011[,1]),2]

NN_2011_Comp_count<- length(NN_2011_Comp) 

NN_2011_Eng<- NN_2011[grep("^/Engineering and technology",NN_2011[,1]),2]

NN_2011_Eng_count<- length(NN_2011_Eng) 

NN_2011_Soc<- NN_2011[grep("^/Social sciences",NN_2011[,1]),2]

NN_2011_Soc_count<- length(NN_2011_Soc)



###NN 2012
NN_2012<- NN_search_clean[grep("^2012",NN_search_clean[,2]),]

NN_2012_Bio<- NN_2012[grep("^/Biology and life sciences",NN_2012[,1]),2]

NN_2012_Bio_count<- length(NN_2012_Bio)

NN_2012_Phys<- NN_2012[grep("^/Physical sciences",NN_2012[,1]),2]

NN_2012_Phys_count<- length(NN_2012_Phys) 

NN_2012_Med<- NN_2012[grep("^/Medicine and health sciences",NN_2012[,1]),2]

NN_2012_Med_count<- length(NN_2012_Med) 

NN_2012_Res<- NN_2012[grep("^/Research and analysis methods",NN_2012[,1]),2]

NN_2012_Res_count<- length(NN_2012_Res) 

NN_2012_Earth<- NN_2012[grep("^/Earth sciences",NN_2012[,1]),2]

NN_2012_Earth_count<- length(NN_2012_Earth) 

NN_2012_Comp<- NN_2012[grep("^/Computer and information sciences",NN_2012[,1]),2]

NN_2012_Comp_count<- length(NN_2012_Comp) 

NN_2012_Eng<- NN_2012[grep("^/Engineering and technology",NN_2012[,1]),2]

NN_2012_Eng_count<- length(NN_2012_Eng) 

NN_2012_Soc<- NN_2012[grep("^/Social sciences",NN_2012[,1]),2]

NN_2012_Soc_count<- length(NN_2012_Soc)



##NN 2013

NN_2013<- NN_search_clean[grep("^2013",NN_search_clean[,2]),]

NN_2013_Bio<- NN_2013[grep("^/Biology and life sciences",NN_2013[,1]),2]

NN_2013_Bio_count<- length(NN_2013_Bio)

NN_2013_Phys<- NN_2013[grep("^/Physical sciences",NN_2013[,1]),2]

NN_2013_Phys_count<- length(NN_2013_Phys) 

NN_2013_Med<- NN_2013[grep("^/Medicine and health sciences",NN_2013[,1]),2]

NN_2013_Med_count<- length(NN_2013_Med) 

NN_2013_Res<- NN_2013[grep("^/Research and analysis methods",NN_2013[,1]),2]

NN_2013_Res_count<- length(NN_2013_Res) 

NN_2013_Earth<- NN_2013[grep("^/Earth sciences",NN_2013[,1]),2]

NN_2013_Earth_count<- length(NN_2013_Earth) 

NN_2013_Comp<- NN_2013[grep("^/Computer and information sciences",NN_2013[,1]),2]

NN_2013_Comp_count<- length(NN_2013_Comp) 

NN_2013_Eng<- NN_2013[grep("^/Engineering and technology",NN_2013[,1]),2]

NN_2013_Eng_count<- length(NN_2013_Eng) 

NN_2013_Soc<- NN_2013[grep("^/Social sciences",NN_2013[,1]),2]

NN_2013_Soc_count<- length(NN_2013_Soc)



###NN 2014

NN_2014<- NN_search_clean[grep("^2014",NN_search_clean[,2]),]



NN_2014_Bio<- NN_2014[grep("^/Biology and life sciences",NN_2014[,1]),2]

NN_2014_Bio_count<- length(NN_2014_Bio)

NN_2014_Phys<- NN_2014[grep("^/Physical sciences",NN_2014[,1]),2]

NN_2014_Phys_count<- length(NN_2014_Phys) 

NN_2014_Med<- NN_2014[grep("^/Medicine and health sciences",NN_2014[,1]),2]

NN_2014_Med_count<- length(NN_2014_Med) 

NN_2014_Res<- NN_2014[grep("^/Research and analysis methods",NN_2014[,1]),2]

NN_2014_Res_count<- length(NN_2014_Res) 

NN_2014_Earth<- NN_2014[grep("^/Earth sciences",NN_2014[,1]),2]

NN_2014_Earth_count<- length(NN_2014_Earth) 

NN_2014_Comp<- NN_2014[grep("^/Computer and information sciences",NN_2014[,1]),2]

NN_2014_Comp_count<- length(NN_2014_Comp) 

NN_2014_Eng<- NN_2014[grep("^/Engineering and technology",NN_2014[,1]),2]

NN_2014_Eng_count<- length(NN_2014_Eng) 

NN_2014_Soc<- NN_2014[grep("^/Social sciences",NN_2014[,1]),2]

NN_2014_Soc_count<- length(NN_2014_Soc)



### NN 2015

NN_2015<- NN_search_clean[grep("^2015",NN_search_clean[,2]),]


NN_2015_Bio<- NN_2015[grep("^/Biology and life sciences",NN_2015[,1]),2]

NN_2015_Bio_count<- length(NN_2015_Bio)

NN_2015_Phys<- NN_2015[grep("^/Physical sciences",NN_2015[,1]),2]

NN_2015_Phys_count<- length(NN_2015_Phys) 

NN_2015_Med<- NN_2015[grep("^/Medicine and health sciences",NN_2015[,1]),2]

NN_2015_Med_count<- length(NN_2015_Med) 

NN_2015_Res<- NN_2015[grep("^/Research and analysis methods",NN_2015[,1]),2]

NN_2015_Res_count<- length(NN_2015_Res) 

NN_2015_Earth<- NN_2015[grep("^/Earth sciences",NN_2015[,1]),2]

NN_2015_Earth_count<- length(NN_2015_Earth) 

NN_2015_Comp<- NN_2015[grep("^/Computer and information sciences",NN_2015[,1]),2]

NN_2015_Comp_count<- length(NN_2015_Comp) 

NN_2015_Eng<- NN_2015[grep("^/Engineering and technology",NN_2015[,1]),2]

NN_2015_Eng_count<- length(NN_2015_Eng) 

NN_2015_Soc<- NN_2015[grep("^/Social sciences",NN_2015[,1]),2]

NN_2015_Soc_count<- length(NN_2015_Soc)




##NN 2016

NN_2016<- NN_search_clean[grep("^2016",NN_search_clean[,2]),]


NN_2016_Bio<- NN_2016[grep("^/Biology and life sciences",NN_2016[,1]),2]

NN_2016_Bio_count<- length(NN_2016_Bio)

NN_2016_Phys<- NN_2016[grep("^/Physical sciences",NN_2016[,1]),2]

NN_2016_Phys_count<- length(NN_2016_Phys) 

NN_2016_Med<- NN_2016[grep("^/Medicine and health sciences",NN_2016[,1]),2]

NN_2016_Med_count<- length(NN_2016_Med) 

NN_2016_Res<- NN_2016[grep("^/Research and analysis methods",NN_2016[,1]),2]

NN_2016_Res_count<- length(NN_2016_Res) 

NN_2016_Earth<- NN_2016[grep("^/Earth sciences",NN_2016[,1]),2]

NN_2016_Earth_count<- length(NN_2016_Earth) 

NN_2016_Comp<- NN_2016[grep("^/Computer and information sciences",NN_2016[,1]),2]

NN_2016_Comp_count<- length(NN_2016_Comp) 

NN_2016_Eng<- NN_2016[grep("^/Engineering and technology",NN_2016[,1]),2]

NN_2016_Eng_count<- length(NN_2016_Eng) 

NN_2016_Soc<- NN_2016[grep("^/Social sciences",NN_2016[,1]),2]

NN_2016_Soc_count<- length(NN_2016_Soc)




## NN 2017

NN_2017<- NN_search_clean[grep("^2017",NN_search_clean[,2]),]


NN_2017_Bio<- NN_2017[grep("^/Biology and life sciences",NN_2017[,1]),2]

NN_2017_Bio_count<- length(NN_2017_Bio)

NN_2017_Phys<- NN_2017[grep("^/Physical sciences",NN_2017[,1]),2]

NN_2017_Phys_count<- length(NN_2017_Phys) 

NN_2017_Med<- NN_2017[grep("^/Medicine and health sciences",NN_2017[,1]),2]

NN_2017_Med_count<- length(NN_2017_Med) 

NN_2017_Res<- NN_2017[grep("^/Research and analysis methods",NN_2017[,1]),2]

NN_2017_Res_count<- length(NN_2017_Res) 

NN_2017_Earth<- NN_2017[grep("^/Earth sciences",NN_2017[,1]),2]

NN_2017_Earth_count<- length(NN_2017_Earth) 

NN_2017_Comp<- NN_2017[grep("^/Computer and information sciences",NN_2017[,1]),2]

NN_2017_Comp_count<- length(NN_2017_Comp) 

NN_2017_Eng<- NN_2017[grep("^/Engineering and technology",NN_2017[,1]),2]

NN_2017_Eng_count<- length(NN_2017_Eng) 

NN_2017_Soc<- NN_2017[grep("^/Social sciences",NN_2017[,1]),2]

NN_2017_Soc_count<- length(NN_2017_Soc)

########## NN counts table

NN_counts_2004_bio<- c(NN_2004_Bio_count,1,rep(0,13),1,rep(0,7))
NN_counts_2004_Comp<- c(NN_2004_Comp_count,1,rep(0,13),0,1,rep(0,6))
NN_counts_2004_Earth<-c(NN_2004_Earth_count,1,rep(0,13),0,0,1,rep(0,5))
NN_counts_2004_Eng<- c(NN_2004_Eng_count,1,rep(0,13),0,0,0,1,rep(0,4))
NN_counts_2004_Med<- c(NN_2004_Med_count,1,rep(0,13),rep(0,4),1,0,0,0)
NN_counts_2004_Phys<- c(NN_2004_Phys_count,1,rep(0,13),rep(0,5),1,0,0)
NN_count_2004_Res<-c(NN_2004_Res_count,1,rep(0,13),rep(0,6),1,0)
NN_count_2004_Soc<-c(NN_2004_Soc_count,1,rep(0,13),rep(0,7),1)

NN_counts_2005_bio<- c(NN_2005_Bio_count,0,1,rep(0,12),1,rep(0,7))
NN_counts_2005_Comp<- c(NN_2005_Comp_count,0,1,rep(0,12),0,1,rep(0,6))
NN_counts_2005_Earth<-c(NN_2005_Earth_count,0,1,rep(0,12),0,0,1,rep(0,5))
NN_counts_2005_Eng<- c(NN_2005_Eng_count,0,1,rep(0,12),0,0,0,1,rep(0,4))
NN_counts_2005_Med<- c(NN_2005_Med_count,0,1,rep(0,12),rep(0,4),1,0,0,0)
NN_counts_2005_Phys<- c(NN_2005_Phys_count,0,1,rep(0,12),rep(0,5),1,0,0)
NN_count_2005_Res<-c(NN_2005_Res_count,0,1,rep(0,12),rep(0,6),1,0)
NN_count_2005_Soc<-c(NN_2005_Soc_count,0,1,rep(0,12),rep(0,7),1)

NN_counts_2006_bio<- c(NN_2006_Bio_count,0,0,1,rep(0,11),1,rep(0,7))
NN_counts_2006_Comp<- c(NN_2006_Comp_count,0,0,1,rep(0,11),0,1,rep(0,6))
NN_counts_2006_Earth<-c(NN_2006_Earth_count,0,0,1,rep(0,11),0,0,1,rep(0,5))
NN_counts_2006_Eng<- c(NN_2006_Eng_count,0,0,1,rep(0,11),0,0,0,1,rep(0,4))
NN_counts_2006_Med<- c(NN_2006_Med_count,0,0,1,rep(0,11),rep(0,4),1,0,0,0)
NN_counts_2006_Phys<- c(NN_2006_Phys_count,0,0,1,rep(0,11),rep(0,5),1,0,0)
NN_count_2006_Res<-c(NN_2006_Res_count,0,0,1,rep(0,11),rep(0,6),1,0)
NN_count_2006_Soc<-c(NN_2006_Soc_count,0,0,1,rep(0,11),rep(0,7),1)

NN_counts_2007_bio<- c(NN_2007_Bio_count,0,0,0,1,rep(0,10),1,rep(0,7))
NN_counts_2007_Comp<- c(NN_2007_Comp_count,0,0,0,1,rep(0,10),0,1,rep(0,6))
NN_counts_2007_Earth<-c(NN_2007_Earth_count,0,0,0,1,rep(0,10),0,0,1,rep(0,5))
NN_counts_2007_Eng<- c(NN_2007_Eng_count,0,0,0,1,rep(0,10),0,0,0,1,rep(0,4))
NN_counts_2007_Med<- c(NN_2007_Med_count,0,0,0,1,rep(0,10),rep(0,4),1,0,0,0)
NN_counts_2007_Phys<- c(NN_2007_Phys_count,0,0,0,1,rep(0,10),rep(0,5),1,0,0)
NN_count_2007_Res<-c(NN_2007_Res_count,0,0,0,1,rep(0,10),rep(0,6),1,0)
NN_count_2007_Soc<-c(NN_2007_Soc_count,0,0,0,1,rep(0,10),rep(0,7),1)

NN_counts_2008_bio<- c(NN_2008_Bio_count,rep(0,4),1,rep(0,9),1,rep(0,7))
NN_counts_2008_Comp<- c(NN_2008_Comp_count,rep(0,4),1,rep(0,9),0,1,rep(0,6))
NN_counts_2008_Earth<-c(NN_2008_Earth_count,rep(0,4),1,rep(0,9),0,0,1,rep(0,5))
NN_counts_2008_Eng<- c(NN_2008_Eng_count,rep(0,4),1,rep(0,9),0,0,0,1,rep(0,4))
NN_counts_2008_Med<- c(NN_2008_Med_count,rep(0,4),1,rep(0,9),rep(0,4),1,0,0,0)
NN_counts_2008_Phys<- c(NN_2008_Phys_count,rep(0,4),1,rep(0,9),rep(0,5),1,0,0)
NN_count_2008_Res<-c(NN_2008_Res_count,rep(0,4),1,rep(0,9),rep(0,6),1,0)
NN_count_2008_Soc<-c(NN_2008_Soc_count,rep(0,4),1,rep(0,9),rep(0,7),1)


NN_counts_2009_bio<- c(NN_2009_Bio_count,rep(0,5),1,rep(0,8),1,rep(0,7))
NN_counts_2009_Comp<- c(NN_2009_Comp_count,rep(0,5),1,rep(0,8),0,1,rep(0,6))
NN_counts_2009_Earth<-c(NN_2009_Earth_count,rep(0,5),1,rep(0,8),0,0,1,rep(0,5))
NN_counts_2009_Eng<- c(NN_2009_Eng_count,rep(0,5),1,rep(0,8),0,0,0,1,rep(0,4))
NN_counts_2009_Med<- c(NN_2009_Med_count,rep(0,5),1,rep(0,8),rep(0,4),1,0,0,0)
NN_counts_2009_Phys<- c(NN_2009_Phys_count,rep(0,5),1,rep(0,8),rep(0,5),1,0,0)
NN_count_2009_Res<-c(NN_2009_Res_count,rep(0,5),1,rep(0,8),rep(0,6),1,0)
NN_count_2009_Soc<-c(NN_2009_Soc_count,rep(0,5),1,rep(0,8),rep(0,7),1)

NN_counts_2010_bio<- c(NN_2010_Bio_count,rep(0,6),1,rep(0,7),1,rep(0,7))
NN_counts_2010_Comp<- c(NN_2010_Comp_count,rep(0,6),1,rep(0,7),0,1,rep(0,6))
NN_counts_2010_Earth<-c(NN_2010_Earth_count,rep(0,6),1,rep(0,7),0,0,1,rep(0,5))
NN_counts_2010_Eng<- c(NN_2010_Eng_count,rep(0,6),1,rep(0,7),0,0,0,1,rep(0,4))
NN_counts_2010_Med<- c(NN_2010_Med_count,rep(0,6),1,rep(0,7),rep(0,4),1,0,0,0)
NN_counts_2010_Phys<- c(NN_2010_Phys_count,rep(0,6),1,rep(0,7),rep(0,5),1,0,0)
NN_count_2010_Res<-c(NN_2010_Res_count,rep(0,6),1,rep(0,7),rep(0,6),1,0)
NN_count_2010_Soc<-c(NN_2010_Soc_count,rep(0,6),1,rep(0,7),rep(0,7),1)


NN_counts_2011_bio<- c(NN_2011_Bio_count,rep(0,7),1,rep(0,6),1,rep(0,7))
NN_counts_2011_Comp<- c(NN_2011_Comp_count,rep(0,7),1,rep(0,6),0,1,rep(0,6))
NN_counts_2011_Earth<-c(NN_2011_Earth_count,rep(0,7),1,rep(0,6),0,0,1,rep(0,5))
NN_counts_2011_Eng<- c(NN_2011_Eng_count,rep(0,7),1,rep(0,6),0,0,0,1,rep(0,4))
NN_counts_2011_Med<- c(NN_2011_Med_count,rep(0,7),1,rep(0,6),rep(0,4),1,0,0,0)
NN_counts_2011_Phys<- c(NN_2011_Phys_count,rep(0,7),1,rep(0,6),rep(0,5),1,0,0)
NN_count_2011_Res<-c(NN_2011_Res_count,rep(0,7),1,rep(0,6),rep(0,6),1,0)
NN_count_2011_Soc<-c(NN_2011_Soc_count,rep(0,7),1,rep(0,6),rep(0,7),1)

NN_counts_2012_bio<- c(NN_2012_Bio_count,rep(0,8),1,rep(0,5),1,rep(0,7))
NN_counts_2012_Comp<- c(NN_2012_Comp_count,rep(0,8),1,rep(0,5),0,1,rep(0,6))
NN_counts_2012_Earth<-c(NN_2012_Earth_count,rep(0,8),1,rep(0,5),0,0,1,rep(0,5))
NN_counts_2012_Eng<- c(NN_2012_Eng_count,rep(0,8),1,rep(0,5),0,0,0,1,rep(0,4))
NN_counts_2012_Med<- c(NN_2012_Med_count,rep(0,8),1,rep(0,5),rep(0,4),1,0,0,0)
NN_counts_2012_Phys<- c(NN_2012_Phys_count,rep(0,8),1,rep(0,5),rep(0,5),1,0,0)
NN_count_2012_Res<-c(NN_2012_Res_count,rep(0,8),1,rep(0,5),rep(0,6),1,0)
NN_count_2012_Soc<-c(NN_2012_Soc_count,rep(0,8),1,rep(0,5),rep(0,7),1)

NN_counts_2013_bio<- c(NN_2013_Bio_count,rep(0,9),1,rep(0,4),1,rep(0,7))
NN_counts_2013_Comp<- c(NN_2013_Comp_count,rep(0,9),1,rep(0,4),0,1,rep(0,6))
NN_counts_2013_Earth<-c(NN_2013_Earth_count,rep(0,9),1,rep(0,4),0,0,1,rep(0,5))
NN_counts_2013_Eng<- c(NN_2013_Eng_count,rep(0,9),1,rep(0,4),0,0,0,1,rep(0,4))
NN_counts_2013_Med<- c(NN_2013_Med_count,rep(0,9),1,rep(0,4),rep(0,4),1,0,0,0)
NN_counts_2013_Phys<- c(NN_2013_Phys_count,rep(0,9),1,rep(0,4),rep(0,5),1,0,0)
NN_count_2013_Res<-c(NN_2013_Res_count,rep(0,9),1,rep(0,4),rep(0,6),1,0)
NN_count_2013_Soc<-c(NN_2013_Soc_count,rep(0,9),1,rep(0,4),rep(0,7),1)

NN_counts_2014_bio<- c(NN_2014_Bio_count,rep(0,10),1,rep(0,3),1,rep(0,7))
NN_counts_2014_Comp<- c(NN_2014_Comp_count,rep(0,10),1,rep(0,3),0,1,rep(0,6))
NN_counts_2014_Earth<-c(NN_2014_Earth_count,rep(0,10),1,rep(0,3),0,0,1,rep(0,5))
NN_counts_2014_Eng<- c(NN_2014_Eng_count,rep(0,10),1,rep(0,3),0,0,0,1,rep(0,4))
NN_counts_2014_Med<- c(NN_2014_Med_count,rep(0,10),1,rep(0,3),rep(0,4),1,0,0,0)
NN_counts_2014_Phys<- c(NN_2014_Phys_count,rep(0,10),1,rep(0,3),rep(0,5),1,0,0)
NN_count_2014_Res<-c(NN_2014_Res_count,rep(0,10),1,rep(0,3),rep(0,6),1,0)
NN_count_2014_Soc<-c(NN_2014_Soc_count,rep(0,10),1,rep(0,3),rep(0,7),1)

NN_counts_2015_bio<- c(NN_2015_Bio_count,rep(0,11),1,rep(0,2),1,rep(0,7))
NN_counts_2015_Comp<- c(NN_2015_Comp_count,rep(0,11),1,rep(0,2),0,1,rep(0,6))
NN_counts_2015_Earth<-c(NN_2015_Earth_count,rep(0,11),1,rep(0,2),0,0,1,rep(0,5))
NN_counts_2015_Eng<- c(NN_2015_Eng_count,rep(0,11),1,rep(0,2),0,0,0,1,rep(0,4))
NN_counts_2015_Med<- c(NN_2015_Med_count,rep(0,11),1,rep(0,2),rep(0,4),1,0,0,0)
NN_counts_2015_Phys<- c(NN_2015_Phys_count,rep(0,11),1,rep(0,2),rep(0,5),1,0,0)
NN_count_2015_Res<-c(NN_2015_Res_count,rep(0,11),1,rep(0,2),rep(0,6),1,0)
NN_count_2015_Soc<-c(NN_2015_Soc_count,rep(0,11),1,rep(0,2),rep(0,7),1)

NN_counts_2016_bio<- c(NN_2016_Bio_count,rep(0,12),1,rep(0,1),1,rep(0,7))
NN_counts_2016_Comp<- c(NN_2016_Comp_count,rep(0,12),1,rep(0,1),0,1,rep(0,6))
NN_counts_2016_Earth<-c(NN_2016_Earth_count,rep(0,12),1,rep(0,1),0,0,1,rep(0,5))
NN_counts_2016_Eng<- c(NN_2016_Eng_count,rep(0,12),1,rep(0,1),0,0,0,1,rep(0,4))
NN_counts_2016_Med<- c(NN_2016_Med_count,rep(0,12),1,rep(0,1),rep(0,4),1,0,0,0)
NN_counts_2016_Phys<- c(NN_2016_Phys_count,rep(0,12),1,rep(0,1),rep(0,5),1,0,0)
NN_count_2016_Res<-c(NN_2016_Res_count,rep(0,12),1,rep(0,1),rep(0,6),1,0)
NN_count_2016_Soc<-c(NN_2016_Soc_count,rep(0,12),1,rep(0,1),rep(0,7),1)

NN_counts_2017_bio<- c(NN_2017_Bio_count,rep(0,13),1,1,rep(0,7))
NN_counts_2017_Comp<- c(NN_2017_Comp_count,rep(0,13),1,0,1,rep(0,6))
NN_counts_2017_Earth<-c(NN_2017_Earth_count,rep(0,13),1,0,0,1,rep(0,5))
NN_counts_2017_Eng<- c(NN_2017_Eng_count,rep(0,13),1,0,0,0,1,rep(0,4))
NN_counts_2017_Med<- c(NN_2017_Med_count,rep(0,13),1,rep(0,4),1,0,0,0)
NN_counts_2017_Phys<- c(NN_2017_Phys_count,rep(0,13),1,rep(0,5),1,0,0)
NN_count_2017_Res<-c(NN_2017_Res_count,rep(0,13),1,rep(0,6),1,0)
NN_count_2017_Soc<-c(NN_2017_Soc_count,rep(0,13),1,rep(0,7),1)

NN_table<- rbind(NN_counts_2004_bio,NN_counts_2004_Comp,NN_counts_2004_Earth,
                    NN_counts_2004_Eng,NN_counts_2004_Med,NN_counts_2004_Phys,
                    NN_count_2004_Res,NN_count_2004_Soc,NN_counts_2005_bio,
                    NN_counts_2005_Comp,NN_counts_2005_Earth,NN_counts_2005_Eng,
                    NN_counts_2005_Med,NN_counts_2005_Phys,NN_count_2005_Res,
                    NN_count_2005_Soc,NN_counts_2006_bio,
                    NN_counts_2006_Comp,NN_counts_2006_Earth,NN_counts_2006_Eng,
                    NN_counts_2006_Med,NN_counts_2006_Phys,NN_count_2006_Res,
                    NN_count_2006_Soc,NN_counts_2007_bio,
                    NN_counts_2007_Comp,NN_counts_2007_Earth,NN_counts_2007_Eng,
                    NN_counts_2007_Med,NN_counts_2007_Phys,NN_count_2007_Res,
                    NN_count_2007_Soc, NN_counts_2008_bio,
                    NN_counts_2008_Comp,NN_counts_2008_Earth,NN_counts_2008_Eng,
                    NN_counts_2008_Med,NN_counts_2008_Phys,NN_count_2008_Res,
                    NN_count_2008_Soc, NN_counts_2009_bio,
                    NN_counts_2009_Comp,NN_counts_2009_Earth,NN_counts_2009_Eng,
                    NN_counts_2009_Med,NN_counts_2009_Phys,NN_count_2009_Res,
                    NN_count_2009_Soc,NN_counts_2010_bio,
                    NN_counts_2010_Comp,NN_counts_2010_Earth,NN_counts_2010_Eng,
                    NN_counts_2010_Med,NN_counts_2010_Phys,NN_count_2010_Res,
                    NN_count_2010_Soc,NN_counts_2011_bio,
                    NN_counts_2011_Comp,NN_counts_2011_Earth,NN_counts_2011_Eng,
                    NN_counts_2011_Med,NN_counts_2011_Phys,NN_count_2011_Res,
                    NN_count_2011_Soc,NN_counts_2012_bio,
                    NN_counts_2012_Comp,NN_counts_2012_Earth,NN_counts_2012_Eng,
                    NN_counts_2012_Med,NN_counts_2012_Phys,NN_count_2012_Res,
                    NN_count_2012_Soc, NN_counts_2013_bio,
                    NN_counts_2013_Comp,NN_counts_2013_Earth,NN_counts_2013_Eng,
                    NN_counts_2013_Med,NN_counts_2013_Phys,NN_count_2013_Res,
                    NN_count_2013_Soc, NN_counts_2014_bio,
                    NN_counts_2014_Comp,NN_counts_2014_Earth,NN_counts_2014_Eng,
                    NN_counts_2014_Med,NN_counts_2014_Phys,NN_count_2014_Res,
                    NN_count_2014_Soc,NN_counts_2015_bio,
                    NN_counts_2015_Comp,NN_counts_2015_Earth,NN_counts_2015_Eng,
                    NN_counts_2015_Med,NN_counts_2015_Phys,NN_count_2015_Res,
                    NN_count_2015_Soc,NN_counts_2016_bio,
                    NN_counts_2016_Comp,NN_counts_2016_Earth,NN_counts_2016_Eng,
                    NN_counts_2016_Med,NN_counts_2016_Phys,NN_count_2016_Res,
                    NN_count_2016_Soc, NN_counts_2017_bio,
                    NN_counts_2017_Comp,NN_counts_2017_Earth,NN_counts_2017_Eng,
                    NN_counts_2017_Med,NN_counts_2017_Phys,NN_count_2017_Res,
                    NN_count_2017_Soc)

NN_table[97:112,]
as.data.frame(NN_table)

colnames(NN_table)<- c("NN_counts","2004","2005","2006","2007","2008","2009",
                          "2010","2011","2012","2013","2014","2015","2016","2017",
                          "Biology and life sciences","Computer and information sciences",
                          "Earth sciences","Engineering and tecnhology",
                          "Medicine and health sciences","Physical sciences",
                          "Research and analysis","Social Sciences")

as.numeric(NN_table[,1])

year_covs<- NN_table[,2:15]

terms_covs<- NN_table[,16:23]

######################## Neural Networks Model Fit################

model_NN<- glm(NN_table[,1]~year_covs*terms_covs, family="poisson")

summary(model_NN)

```


```{r}

###################### Section 3#################
 
################ Random sample of articles to compute FDR ###########
output_A<- highplos(q='ANOVA',hl.fl='body',rows=10)
output_A

output_B<-highplos(q='bayesian',hl.fl='body',rows=10)
output_B

output_LR<- highplos(q='linear regression',hl.fl='body',rows=10)
output_LR

output_MM<-highplos(q='mixed effect models',hl.fl='body',rows=10)
output_MM

output_MM<- highplos(q='mixed models',hl.fl='materials_and_methods',rows=10)
output_MM

output_GEE<-highplos(q='generalized estimating equations',hl.fl='body',rows=10)
output_GEE

output_ML<- highplos(q='machine learning',hl.fl='body',rows=10)
output_ML

output_SVM<-highplos(q='support vector machine',hl.fl='body',rows=10)
output_SVM

output_BT<- highplos(q='bootstrap',hl.fl='body',rows=10)
output_BT

output_DL<-highplos(q='deep learning',hl.fl='body',rows=10)
output_DL

output_NN<- highplos(q='neural network', hl.fl='body', rows=10)
output_NN

```